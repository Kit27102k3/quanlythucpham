"use strict";Object.defineProperty(exports, "__esModule", { value: true });exports.default = void 0;
var _express = _interopRequireDefault(require("express"));
var _database = require("../config/database.js");function _interopRequireDefault(e) {return e && e.__esModule ? e : { default: e };} /* eslint-disable no-undef */


const router = _express.default.Router();

/**
 * API trung gian để truy cập MongoDB từ thiết bị di động
 * Thay vì kết nối trực tiếp từ client, client sẽ gọi các API endpoints này
 */

// Middleware kiểm tra kết nối MongoDB
const checkMongoConnection = (req, res, next) => {
  if (!_database.isMongoConnected) {
    return res.status(503).json({
      success: false,
      message: 'Database connection unavailable',
      status: 'disconnected'
    });
  }
  next();
};

// API endpoint kiểm tra trạng thái kết nối
router.get('/status', (req, res) => {
  const status = _database.isMongoConnected ? 'connected' : 'disconnected';
  const readyState = _database.mongoose.connection.readyState;

  res.json({
    success: true,
    status,
    readyState,
    timestamp: new Date().toISOString()
  });
});

// API endpoint tổng quát để truy vấn collection
router.post('/query/:collection', checkMongoConnection, async (req, res) => {
  try {
    const { collection } = req.params;
    const { query = {}, projection = {}, options = {}, limit = 100, skip = 0 } = req.body;

    // Giới hạn số lượng kết quả trả về để tránh quá tải
    options.limit = Math.min(limit, 100);
    options.skip = skip;

    // Thực hiện truy vấn
    const db = _database.mongoose.connection.db;
    const results = await db.collection(collection).
    find(query, projection).
    limit(options.limit).
    skip(options.skip).
    toArray();

    res.json({
      success: true,
      count: results.length,
      data: results
    });
  } catch (error) {
    console.error(`Error querying collection ${req.params.collection}:`, error);
    res.status(500).json({
      success: false,
      message: error.message
    });
  }
});

// API endpoint để lấy document theo ID
router.get('/document/:collection/:id', checkMongoConnection, async (req, res) => {
  try {
    const { collection, id } = req.params;

    // Validate ObjectId
    if (!_database.mongoose.Types.ObjectId.isValid(id)) {
      return res.status(400).json({
        success: false,
        message: 'Invalid ObjectId format'
      });
    }

    // Thực hiện truy vấn
    const db = _database.mongoose.connection.db;
    const result = await db.collection(collection).findOne({
      _id: new _database.mongoose.Types.ObjectId(id)
    });

    if (!result) {
      return res.status(404).json({
        success: false,
        message: 'Document not found'
      });
    }

    res.json({
      success: true,
      data: result
    });
  } catch (error) {
    console.error(`Error getting document from ${req.params.collection}:`, error);
    res.status(500).json({
      success: false,
      message: error.message
    });
  }
});

// API endpoint để tạo document mới
router.post('/document/:collection', checkMongoConnection, async (req, res) => {
  try {
    const { collection } = req.params;
    const document = req.body;

    // Validate document
    if (!document || Object.keys(document).length === 0) {
      return res.status(400).json({
        success: false,
        message: 'Empty document'
      });
    }

    // Thực hiện thêm mới
    const db = _database.mongoose.connection.db;
    const result = await db.collection(collection).insertOne(document);

    res.status(201).json({
      success: true,
      insertedId: result.insertedId,
      data: document
    });
  } catch (error) {
    console.error(`Error creating document in ${req.params.collection}:`, error);
    res.status(500).json({
      success: false,
      message: error.message
    });
  }
});

// API endpoint để cập nhật document
router.put('/document/:collection/:id', checkMongoConnection, async (req, res) => {
  try {
    const { collection, id } = req.params;
    const updates = req.body;

    // Validate ObjectId
    if (!_database.mongoose.Types.ObjectId.isValid(id)) {
      return res.status(400).json({
        success: false,
        message: 'Invalid ObjectId format'
      });
    }

    // Validate updates
    if (!updates || Object.keys(updates).length === 0) {
      return res.status(400).json({
        success: false,
        message: 'No updates provided'
      });
    }

    // Thực hiện cập nhật
    const db = _database.mongoose.connection.db;
    const result = await db.collection(collection).updateOne(
      { _id: new _database.mongoose.Types.ObjectId(id) },
      { $set: updates }
    );

    if (result.matchedCount === 0) {
      return res.status(404).json({
        success: false,
        message: 'Document not found'
      });
    }

    res.json({
      success: true,
      modifiedCount: result.modifiedCount,
      matchedCount: result.matchedCount
    });
  } catch (error) {
    console.error(`Error updating document in ${req.params.collection}:`, error);
    res.status(500).json({
      success: false,
      message: error.message
    });
  }
});

// API endpoint để xóa document
router.delete('/document/:collection/:id', checkMongoConnection, async (req, res) => {
  try {
    const { collection, id } = req.params;

    // Validate ObjectId
    if (!_database.mongoose.Types.ObjectId.isValid(id)) {
      return res.status(400).json({
        success: false,
        message: 'Invalid ObjectId format'
      });
    }

    // Thực hiện xóa
    const db = _database.mongoose.connection.db;
    const result = await db.collection(collection).deleteOne({
      _id: new _database.mongoose.Types.ObjectId(id)
    });

    if (result.deletedCount === 0) {
      return res.status(404).json({
        success: false,
        message: 'Document not found'
      });
    }

    res.json({
      success: true,
      deletedCount: result.deletedCount
    });
  } catch (error) {
    console.error(`Error deleting document from ${req.params.collection}:`, error);
    res.status(500).json({
      success: false,
      message: error.message
    });
  }
});

// API endpoint để đếm số lượng documents trong collection
router.post('/count/:collection', checkMongoConnection, async (req, res) => {
  try {
    const { collection } = req.params;
    const { query = {} } = req.body;

    // Thực hiện đếm
    const db = _database.mongoose.connection.db;
    const count = await db.collection(collection).countDocuments(query);

    res.json({
      success: true,
      count
    });
  } catch (error) {
    console.error(`Error counting documents in ${req.params.collection}:`, error);
    res.status(500).json({
      success: false,
      message: error.message
    });
  }
});

// API endpoint để lấy danh sách collections
router.get('/collections', checkMongoConnection, async (req, res) => {
  try {
    const db = _database.mongoose.connection.db;
    const collections = await db.listCollections().toArray();

    res.json({
      success: true,
      collections: collections.map((col) => col.name)
    });
  } catch (error) {
    console.error('Error listing collections:', error);
    res.status(500).json({
      success: false,
      message: error.message
    });
  }
});var _default = exports.default =

router;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfZXhwcmVzcyIsIl9pbnRlcm9wUmVxdWlyZURlZmF1bHQiLCJyZXF1aXJlIiwiX2RhdGFiYXNlIiwiZSIsIl9fZXNNb2R1bGUiLCJkZWZhdWx0Iiwicm91dGVyIiwiZXhwcmVzcyIsIlJvdXRlciIsImNoZWNrTW9uZ29Db25uZWN0aW9uIiwicmVxIiwicmVzIiwibmV4dCIsImlzTW9uZ29Db25uZWN0ZWQiLCJzdGF0dXMiLCJqc29uIiwic3VjY2VzcyIsIm1lc3NhZ2UiLCJnZXQiLCJyZWFkeVN0YXRlIiwibW9uZ29vc2UiLCJjb25uZWN0aW9uIiwidGltZXN0YW1wIiwiRGF0ZSIsInRvSVNPU3RyaW5nIiwicG9zdCIsImNvbGxlY3Rpb24iLCJwYXJhbXMiLCJxdWVyeSIsInByb2plY3Rpb24iLCJvcHRpb25zIiwibGltaXQiLCJza2lwIiwiYm9keSIsIk1hdGgiLCJtaW4iLCJkYiIsInJlc3VsdHMiLCJmaW5kIiwidG9BcnJheSIsImNvdW50IiwibGVuZ3RoIiwiZGF0YSIsImVycm9yIiwiY29uc29sZSIsImlkIiwiVHlwZXMiLCJPYmplY3RJZCIsImlzVmFsaWQiLCJyZXN1bHQiLCJmaW5kT25lIiwiX2lkIiwiZG9jdW1lbnQiLCJPYmplY3QiLCJrZXlzIiwiaW5zZXJ0T25lIiwiaW5zZXJ0ZWRJZCIsInB1dCIsInVwZGF0ZXMiLCJ1cGRhdGVPbmUiLCIkc2V0IiwibWF0Y2hlZENvdW50IiwibW9kaWZpZWRDb3VudCIsImRlbGV0ZSIsImRlbGV0ZU9uZSIsImRlbGV0ZWRDb3VudCIsImNvdW50RG9jdW1lbnRzIiwiY29sbGVjdGlvbnMiLCJsaXN0Q29sbGVjdGlvbnMiLCJtYXAiLCJjb2wiLCJuYW1lIiwiX2RlZmF1bHQiLCJleHBvcnRzIl0sInNvdXJjZXMiOlsiLi4vLi4vLi4vc3JjL3JvdXRlcy9hcGlSb3V0ZXMuanMiXSwic291cmNlc0NvbnRlbnQiOlsiLyogZXNsaW50LWRpc2FibGUgbm8tdW5kZWYgKi9cclxuaW1wb3J0IGV4cHJlc3MgZnJvbSAnZXhwcmVzcyc7XHJcbmltcG9ydCB7IG1vbmdvb3NlIH0gZnJvbSAnLi4vY29uZmlnL2RhdGFiYXNlLmpzJztcclxuaW1wb3J0IHsgaXNNb25nb0Nvbm5lY3RlZCB9IGZyb20gJy4uL2NvbmZpZy9kYXRhYmFzZS5qcyc7XHJcblxyXG5jb25zdCByb3V0ZXIgPSBleHByZXNzLlJvdXRlcigpO1xyXG5cclxuLyoqXHJcbiAqIEFQSSB0cnVuZyBnaWFuIMSR4buDIHRydXkgY+G6rXAgTW9uZ29EQiB04burIHRoaeG6v3QgYuG7iyBkaSDEkeG7mW5nXHJcbiAqIFRoYXkgdsOsIGvhur90IG7hu5FpIHRy4buxYyB0aeG6v3AgdOG7qyBjbGllbnQsIGNsaWVudCBz4bq9IGfhu41pIGPDoWMgQVBJIGVuZHBvaW50cyBuw6B5XHJcbiAqL1xyXG5cclxuLy8gTWlkZGxld2FyZSBraeG7g20gdHJhIGvhur90IG7hu5FpIE1vbmdvREJcclxuY29uc3QgY2hlY2tNb25nb0Nvbm5lY3Rpb24gPSAocmVxLCByZXMsIG5leHQpID0+IHtcclxuICBpZiAoIWlzTW9uZ29Db25uZWN0ZWQpIHtcclxuICAgIHJldHVybiByZXMuc3RhdHVzKDUwMykuanNvbih7IFxyXG4gICAgICBzdWNjZXNzOiBmYWxzZSwgXHJcbiAgICAgIG1lc3NhZ2U6ICdEYXRhYmFzZSBjb25uZWN0aW9uIHVuYXZhaWxhYmxlJyxcclxuICAgICAgc3RhdHVzOiAnZGlzY29ubmVjdGVkJ1xyXG4gICAgfSk7XHJcbiAgfVxyXG4gIG5leHQoKTtcclxufTtcclxuXHJcbi8vIEFQSSBlbmRwb2ludCBraeG7g20gdHJhIHRy4bqhbmcgdGjDoWkga+G6v3QgbuG7kWlcclxucm91dGVyLmdldCgnL3N0YXR1cycsIChyZXEsIHJlcykgPT4ge1xyXG4gIGNvbnN0IHN0YXR1cyA9IGlzTW9uZ29Db25uZWN0ZWQgPyAnY29ubmVjdGVkJyA6ICdkaXNjb25uZWN0ZWQnO1xyXG4gIGNvbnN0IHJlYWR5U3RhdGUgPSBtb25nb29zZS5jb25uZWN0aW9uLnJlYWR5U3RhdGU7XHJcbiAgXHJcbiAgcmVzLmpzb24oe1xyXG4gICAgc3VjY2VzczogdHJ1ZSxcclxuICAgIHN0YXR1cyxcclxuICAgIHJlYWR5U3RhdGUsXHJcbiAgICB0aW1lc3RhbXA6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKVxyXG4gIH0pO1xyXG59KTtcclxuXHJcbi8vIEFQSSBlbmRwb2ludCB04buVbmcgcXXDoXQgxJHhu4MgdHJ1eSB24bqlbiBjb2xsZWN0aW9uXHJcbnJvdXRlci5wb3N0KCcvcXVlcnkvOmNvbGxlY3Rpb24nLCBjaGVja01vbmdvQ29ubmVjdGlvbiwgYXN5bmMgKHJlcSwgcmVzKSA9PiB7XHJcbiAgdHJ5IHtcclxuICAgIGNvbnN0IHsgY29sbGVjdGlvbiB9ID0gcmVxLnBhcmFtcztcclxuICAgIGNvbnN0IHsgcXVlcnkgPSB7fSwgcHJvamVjdGlvbiA9IHt9LCBvcHRpb25zID0ge30sIGxpbWl0ID0gMTAwLCBza2lwID0gMCB9ID0gcmVxLmJvZHk7XHJcbiAgICBcclxuICAgIC8vIEdp4bubaSBo4bqhbiBz4buRIGzGsOG7o25nIGvhur90IHF14bqjIHRy4bqjIHbhu4EgxJHhu4MgdHLDoW5oIHF1w6EgdOG6o2lcclxuICAgIG9wdGlvbnMubGltaXQgPSBNYXRoLm1pbihsaW1pdCwgMTAwKTtcclxuICAgIG9wdGlvbnMuc2tpcCA9IHNraXA7XHJcbiAgICBcclxuICAgIC8vIFRo4buxYyBoaeG7h24gdHJ1eSB24bqlblxyXG4gICAgY29uc3QgZGIgPSBtb25nb29zZS5jb25uZWN0aW9uLmRiO1xyXG4gICAgY29uc3QgcmVzdWx0cyA9IGF3YWl0IGRiLmNvbGxlY3Rpb24oY29sbGVjdGlvbilcclxuICAgICAgLmZpbmQocXVlcnksIHByb2plY3Rpb24pXHJcbiAgICAgIC5saW1pdChvcHRpb25zLmxpbWl0KVxyXG4gICAgICAuc2tpcChvcHRpb25zLnNraXApXHJcbiAgICAgIC50b0FycmF5KCk7XHJcbiAgICBcclxuICAgIHJlcy5qc29uKHtcclxuICAgICAgc3VjY2VzczogdHJ1ZSxcclxuICAgICAgY291bnQ6IHJlc3VsdHMubGVuZ3RoLFxyXG4gICAgICBkYXRhOiByZXN1bHRzXHJcbiAgICB9KTtcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcihgRXJyb3IgcXVlcnlpbmcgY29sbGVjdGlvbiAke3JlcS5wYXJhbXMuY29sbGVjdGlvbn06YCwgZXJyb3IpO1xyXG4gICAgcmVzLnN0YXR1cyg1MDApLmpzb24oe1xyXG4gICAgICBzdWNjZXNzOiBmYWxzZSxcclxuICAgICAgbWVzc2FnZTogZXJyb3IubWVzc2FnZVxyXG4gICAgfSk7XHJcbiAgfVxyXG59KTtcclxuXHJcbi8vIEFQSSBlbmRwb2ludCDEkeG7gyBs4bqleSBkb2N1bWVudCB0aGVvIElEXHJcbnJvdXRlci5nZXQoJy9kb2N1bWVudC86Y29sbGVjdGlvbi86aWQnLCBjaGVja01vbmdvQ29ubmVjdGlvbiwgYXN5bmMgKHJlcSwgcmVzKSA9PiB7XHJcbiAgdHJ5IHtcclxuICAgIGNvbnN0IHsgY29sbGVjdGlvbiwgaWQgfSA9IHJlcS5wYXJhbXM7XHJcbiAgICBcclxuICAgIC8vIFZhbGlkYXRlIE9iamVjdElkXHJcbiAgICBpZiAoIW1vbmdvb3NlLlR5cGVzLk9iamVjdElkLmlzVmFsaWQoaWQpKSB7XHJcbiAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwMCkuanNvbih7XHJcbiAgICAgICAgc3VjY2VzczogZmFsc2UsXHJcbiAgICAgICAgbWVzc2FnZTogJ0ludmFsaWQgT2JqZWN0SWQgZm9ybWF0J1xyXG4gICAgICB9KTtcclxuICAgIH1cclxuICAgIFxyXG4gICAgLy8gVGjhu7FjIGhp4buHbiB0cnV5IHbhuqVuXHJcbiAgICBjb25zdCBkYiA9IG1vbmdvb3NlLmNvbm5lY3Rpb24uZGI7XHJcbiAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBkYi5jb2xsZWN0aW9uKGNvbGxlY3Rpb24pLmZpbmRPbmUoe1xyXG4gICAgICBfaWQ6IG5ldyBtb25nb29zZS5UeXBlcy5PYmplY3RJZChpZClcclxuICAgIH0pO1xyXG4gICAgXHJcbiAgICBpZiAoIXJlc3VsdCkge1xyXG4gICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDQpLmpzb24oe1xyXG4gICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxyXG4gICAgICAgIG1lc3NhZ2U6ICdEb2N1bWVudCBub3QgZm91bmQnXHJcbiAgICAgIH0pO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICByZXMuanNvbih7XHJcbiAgICAgIHN1Y2Nlc3M6IHRydWUsXHJcbiAgICAgIGRhdGE6IHJlc3VsdFxyXG4gICAgfSk7XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoYEVycm9yIGdldHRpbmcgZG9jdW1lbnQgZnJvbSAke3JlcS5wYXJhbXMuY29sbGVjdGlvbn06YCwgZXJyb3IpO1xyXG4gICAgcmVzLnN0YXR1cyg1MDApLmpzb24oe1xyXG4gICAgICBzdWNjZXNzOiBmYWxzZSxcclxuICAgICAgbWVzc2FnZTogZXJyb3IubWVzc2FnZVxyXG4gICAgfSk7XHJcbiAgfVxyXG59KTtcclxuXHJcbi8vIEFQSSBlbmRwb2ludCDEkeG7gyB04bqhbyBkb2N1bWVudCBt4bubaVxyXG5yb3V0ZXIucG9zdCgnL2RvY3VtZW50Lzpjb2xsZWN0aW9uJywgY2hlY2tNb25nb0Nvbm5lY3Rpb24sIGFzeW5jIChyZXEsIHJlcykgPT4ge1xyXG4gIHRyeSB7XHJcbiAgICBjb25zdCB7IGNvbGxlY3Rpb24gfSA9IHJlcS5wYXJhbXM7XHJcbiAgICBjb25zdCBkb2N1bWVudCA9IHJlcS5ib2R5O1xyXG4gICAgXHJcbiAgICAvLyBWYWxpZGF0ZSBkb2N1bWVudFxyXG4gICAgaWYgKCFkb2N1bWVudCB8fCBPYmplY3Qua2V5cyhkb2N1bWVudCkubGVuZ3RoID09PSAwKSB7XHJcbiAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwMCkuanNvbih7XHJcbiAgICAgICAgc3VjY2VzczogZmFsc2UsXHJcbiAgICAgICAgbWVzc2FnZTogJ0VtcHR5IGRvY3VtZW50J1xyXG4gICAgICB9KTtcclxuICAgIH1cclxuICAgIFxyXG4gICAgLy8gVGjhu7FjIGhp4buHbiB0aMOqbSBt4bubaVxyXG4gICAgY29uc3QgZGIgPSBtb25nb29zZS5jb25uZWN0aW9uLmRiO1xyXG4gICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgZGIuY29sbGVjdGlvbihjb2xsZWN0aW9uKS5pbnNlcnRPbmUoZG9jdW1lbnQpO1xyXG4gICAgXHJcbiAgICByZXMuc3RhdHVzKDIwMSkuanNvbih7XHJcbiAgICAgIHN1Y2Nlc3M6IHRydWUsXHJcbiAgICAgIGluc2VydGVkSWQ6IHJlc3VsdC5pbnNlcnRlZElkLFxyXG4gICAgICBkYXRhOiBkb2N1bWVudFxyXG4gICAgfSk7XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoYEVycm9yIGNyZWF0aW5nIGRvY3VtZW50IGluICR7cmVxLnBhcmFtcy5jb2xsZWN0aW9ufTpgLCBlcnJvcik7XHJcbiAgICByZXMuc3RhdHVzKDUwMCkuanNvbih7XHJcbiAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxyXG4gICAgICBtZXNzYWdlOiBlcnJvci5tZXNzYWdlXHJcbiAgICB9KTtcclxuICB9XHJcbn0pO1xyXG5cclxuLy8gQVBJIGVuZHBvaW50IMSR4buDIGPhuq1wIG5o4bqtdCBkb2N1bWVudFxyXG5yb3V0ZXIucHV0KCcvZG9jdW1lbnQvOmNvbGxlY3Rpb24vOmlkJywgY2hlY2tNb25nb0Nvbm5lY3Rpb24sIGFzeW5jIChyZXEsIHJlcykgPT4ge1xyXG4gIHRyeSB7XHJcbiAgICBjb25zdCB7IGNvbGxlY3Rpb24sIGlkIH0gPSByZXEucGFyYW1zO1xyXG4gICAgY29uc3QgdXBkYXRlcyA9IHJlcS5ib2R5O1xyXG4gICAgXHJcbiAgICAvLyBWYWxpZGF0ZSBPYmplY3RJZFxyXG4gICAgaWYgKCFtb25nb29zZS5UeXBlcy5PYmplY3RJZC5pc1ZhbGlkKGlkKSkge1xyXG4gICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDApLmpzb24oe1xyXG4gICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxyXG4gICAgICAgIG1lc3NhZ2U6ICdJbnZhbGlkIE9iamVjdElkIGZvcm1hdCdcclxuICAgICAgfSk7XHJcbiAgICB9XHJcbiAgICBcclxuICAgIC8vIFZhbGlkYXRlIHVwZGF0ZXNcclxuICAgIGlmICghdXBkYXRlcyB8fCBPYmplY3Qua2V5cyh1cGRhdGVzKS5sZW5ndGggPT09IDApIHtcclxuICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAwKS5qc29uKHtcclxuICAgICAgICBzdWNjZXNzOiBmYWxzZSxcclxuICAgICAgICBtZXNzYWdlOiAnTm8gdXBkYXRlcyBwcm92aWRlZCdcclxuICAgICAgfSk7XHJcbiAgICB9XHJcbiAgICBcclxuICAgIC8vIFRo4buxYyBoaeG7h24gY+G6rXAgbmjhuq10XHJcbiAgICBjb25zdCBkYiA9IG1vbmdvb3NlLmNvbm5lY3Rpb24uZGI7XHJcbiAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBkYi5jb2xsZWN0aW9uKGNvbGxlY3Rpb24pLnVwZGF0ZU9uZShcclxuICAgICAgeyBfaWQ6IG5ldyBtb25nb29zZS5UeXBlcy5PYmplY3RJZChpZCkgfSxcclxuICAgICAgeyAkc2V0OiB1cGRhdGVzIH1cclxuICAgICk7XHJcbiAgICBcclxuICAgIGlmIChyZXN1bHQubWF0Y2hlZENvdW50ID09PSAwKSB7XHJcbiAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwNCkuanNvbih7XHJcbiAgICAgICAgc3VjY2VzczogZmFsc2UsXHJcbiAgICAgICAgbWVzc2FnZTogJ0RvY3VtZW50IG5vdCBmb3VuZCdcclxuICAgICAgfSk7XHJcbiAgICB9XHJcbiAgICBcclxuICAgIHJlcy5qc29uKHtcclxuICAgICAgc3VjY2VzczogdHJ1ZSxcclxuICAgICAgbW9kaWZpZWRDb3VudDogcmVzdWx0Lm1vZGlmaWVkQ291bnQsXHJcbiAgICAgIG1hdGNoZWRDb3VudDogcmVzdWx0Lm1hdGNoZWRDb3VudFxyXG4gICAgfSk7XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoYEVycm9yIHVwZGF0aW5nIGRvY3VtZW50IGluICR7cmVxLnBhcmFtcy5jb2xsZWN0aW9ufTpgLCBlcnJvcik7XHJcbiAgICByZXMuc3RhdHVzKDUwMCkuanNvbih7XHJcbiAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxyXG4gICAgICBtZXNzYWdlOiBlcnJvci5tZXNzYWdlXHJcbiAgICB9KTtcclxuICB9XHJcbn0pO1xyXG5cclxuLy8gQVBJIGVuZHBvaW50IMSR4buDIHjDs2EgZG9jdW1lbnRcclxucm91dGVyLmRlbGV0ZSgnL2RvY3VtZW50Lzpjb2xsZWN0aW9uLzppZCcsIGNoZWNrTW9uZ29Db25uZWN0aW9uLCBhc3luYyAocmVxLCByZXMpID0+IHtcclxuICB0cnkge1xyXG4gICAgY29uc3QgeyBjb2xsZWN0aW9uLCBpZCB9ID0gcmVxLnBhcmFtcztcclxuICAgIFxyXG4gICAgLy8gVmFsaWRhdGUgT2JqZWN0SWRcclxuICAgIGlmICghbW9uZ29vc2UuVHlwZXMuT2JqZWN0SWQuaXNWYWxpZChpZCkpIHtcclxuICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAwKS5qc29uKHtcclxuICAgICAgICBzdWNjZXNzOiBmYWxzZSxcclxuICAgICAgICBtZXNzYWdlOiAnSW52YWxpZCBPYmplY3RJZCBmb3JtYXQnXHJcbiAgICAgIH0pO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICAvLyBUaOG7sWMgaGnhu4duIHjDs2FcclxuICAgIGNvbnN0IGRiID0gbW9uZ29vc2UuY29ubmVjdGlvbi5kYjtcclxuICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGRiLmNvbGxlY3Rpb24oY29sbGVjdGlvbikuZGVsZXRlT25lKHtcclxuICAgICAgX2lkOiBuZXcgbW9uZ29vc2UuVHlwZXMuT2JqZWN0SWQoaWQpXHJcbiAgICB9KTtcclxuICAgIFxyXG4gICAgaWYgKHJlc3VsdC5kZWxldGVkQ291bnQgPT09IDApIHtcclxuICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDA0KS5qc29uKHtcclxuICAgICAgICBzdWNjZXNzOiBmYWxzZSxcclxuICAgICAgICBtZXNzYWdlOiAnRG9jdW1lbnQgbm90IGZvdW5kJ1xyXG4gICAgICB9KTtcclxuICAgIH1cclxuICAgIFxyXG4gICAgcmVzLmpzb24oe1xyXG4gICAgICBzdWNjZXNzOiB0cnVlLFxyXG4gICAgICBkZWxldGVkQ291bnQ6IHJlc3VsdC5kZWxldGVkQ291bnRcclxuICAgIH0pO1xyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKGBFcnJvciBkZWxldGluZyBkb2N1bWVudCBmcm9tICR7cmVxLnBhcmFtcy5jb2xsZWN0aW9ufTpgLCBlcnJvcik7XHJcbiAgICByZXMuc3RhdHVzKDUwMCkuanNvbih7XHJcbiAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxyXG4gICAgICBtZXNzYWdlOiBlcnJvci5tZXNzYWdlXHJcbiAgICB9KTtcclxuICB9XHJcbn0pO1xyXG5cclxuLy8gQVBJIGVuZHBvaW50IMSR4buDIMSR4bq/bSBz4buRIGzGsOG7o25nIGRvY3VtZW50cyB0cm9uZyBjb2xsZWN0aW9uXHJcbnJvdXRlci5wb3N0KCcvY291bnQvOmNvbGxlY3Rpb24nLCBjaGVja01vbmdvQ29ubmVjdGlvbiwgYXN5bmMgKHJlcSwgcmVzKSA9PiB7XHJcbiAgdHJ5IHtcclxuICAgIGNvbnN0IHsgY29sbGVjdGlvbiB9ID0gcmVxLnBhcmFtcztcclxuICAgIGNvbnN0IHsgcXVlcnkgPSB7fSB9ID0gcmVxLmJvZHk7XHJcbiAgICBcclxuICAgIC8vIFRo4buxYyBoaeG7h24gxJHhur9tXHJcbiAgICBjb25zdCBkYiA9IG1vbmdvb3NlLmNvbm5lY3Rpb24uZGI7XHJcbiAgICBjb25zdCBjb3VudCA9IGF3YWl0IGRiLmNvbGxlY3Rpb24oY29sbGVjdGlvbikuY291bnREb2N1bWVudHMocXVlcnkpO1xyXG4gICAgXHJcbiAgICByZXMuanNvbih7XHJcbiAgICAgIHN1Y2Nlc3M6IHRydWUsXHJcbiAgICAgIGNvdW50XHJcbiAgICB9KTtcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcihgRXJyb3IgY291bnRpbmcgZG9jdW1lbnRzIGluICR7cmVxLnBhcmFtcy5jb2xsZWN0aW9ufTpgLCBlcnJvcik7XHJcbiAgICByZXMuc3RhdHVzKDUwMCkuanNvbih7XHJcbiAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxyXG4gICAgICBtZXNzYWdlOiBlcnJvci5tZXNzYWdlXHJcbiAgICB9KTtcclxuICB9XHJcbn0pO1xyXG5cclxuLy8gQVBJIGVuZHBvaW50IMSR4buDIGzhuqV5IGRhbmggc8OhY2ggY29sbGVjdGlvbnNcclxucm91dGVyLmdldCgnL2NvbGxlY3Rpb25zJywgY2hlY2tNb25nb0Nvbm5lY3Rpb24sIGFzeW5jIChyZXEsIHJlcykgPT4ge1xyXG4gIHRyeSB7XHJcbiAgICBjb25zdCBkYiA9IG1vbmdvb3NlLmNvbm5lY3Rpb24uZGI7XHJcbiAgICBjb25zdCBjb2xsZWN0aW9ucyA9IGF3YWl0IGRiLmxpc3RDb2xsZWN0aW9ucygpLnRvQXJyYXkoKTtcclxuICAgIFxyXG4gICAgcmVzLmpzb24oe1xyXG4gICAgICBzdWNjZXNzOiB0cnVlLFxyXG4gICAgICBjb2xsZWN0aW9uczogY29sbGVjdGlvbnMubWFwKGNvbCA9PiBjb2wubmFtZSlcclxuICAgIH0pO1xyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciBsaXN0aW5nIGNvbGxlY3Rpb25zOicsIGVycm9yKTtcclxuICAgIHJlcy5zdGF0dXMoNTAwKS5qc29uKHtcclxuICAgICAgc3VjY2VzczogZmFsc2UsXHJcbiAgICAgIG1lc3NhZ2U6IGVycm9yLm1lc3NhZ2VcclxuICAgIH0pO1xyXG4gIH1cclxufSk7XHJcblxyXG5leHBvcnQgZGVmYXVsdCByb3V0ZXI7ICJdLCJtYXBwaW5ncyI6IjtBQUNBLElBQUFBLFFBQUEsR0FBQUMsc0JBQUEsQ0FBQUMsT0FBQTtBQUNBLElBQUFDLFNBQUEsR0FBQUQsT0FBQSwwQkFBaUQsU0FBQUQs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