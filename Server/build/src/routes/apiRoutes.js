"use strict";Object.defineProperty(exports, "__esModule", { value: true });exports.default = void 0;var _express = _interopRequireDefault(require("express"));
var _database = require("../config/database.js");

var _apiAuth = _interopRequireDefault(require("../middleware/apiAuth.js"));function _interopRequireDefault(e) {return e && e.__esModule ? e : { default: e };}

const router = _express.default.Router();

/**
 * API trung gian để truy cập MongoDB từ thiết bị di động
 * Thay vì kết nối trực tiếp từ client, client sẽ gọi các API endpoints này
 */

// Middleware kiểm tra kết nối MongoDB
const checkMongoConnection = (req, res, next) => {
  if (!_database.isMongoConnected) {
    return res.status(503).json({
      success: false,
      message: 'Database connection unavailable',
      status: 'disconnected'
    });
  }
  next();
};

// API endpoint kiểm tra trạng thái kết nối - Không yêu cầu xác thực
router.get('/status', (req, res) => {
  const status = _database.isMongoConnected ? 'connected' : 'disconnected';
  const readyState = _database.mongoose.connection.readyState;

  res.json({
    success: true,
    status,
    readyState,
    timestamp: new Date().toISOString()
  });
});

// Áp dụng middleware xác thực cho tất cả các routes bên dưới
router.use(_apiAuth.default);

// API endpoint tổng quát để truy vấn collection
router.post('/query/:collection', checkMongoConnection, async (req, res) => {
  try {
    const { collection } = req.params;
    const { query = {}, projection = {}, options = {}, limit = 100, skip = 0 } = req.body;

    // Giới hạn số lượng kết quả trả về để tránh quá tải
    options.limit = Math.min(limit, 100);
    options.skip = skip;

    // Thực hiện truy vấn
    const db = _database.mongoose.connection.db;
    const results = await db.collection(collection).
    find(query, projection).
    limit(options.limit).
    skip(options.skip).
    toArray();

    res.json({
      success: true,
      count: results.length,
      data: results
    });
  } catch (error) {
    console.error(`Error querying collection ${req.params.collection}:`, error);
    res.status(500).json({
      success: false,
      message: error.message
    });
  }
});

// API endpoint để lấy document theo ID
router.get('/document/:collection/:id', checkMongoConnection, async (req, res) => {
  try {
    const { collection, id } = req.params;

    // Validate ObjectId
    if (!_database.mongoose.Types.ObjectId.isValid(id)) {
      return res.status(400).json({
        success: false,
        message: 'Invalid ObjectId format'
      });
    }

    // Thực hiện truy vấn
    const db = _database.mongoose.connection.db;
    const result = await db.collection(collection).findOne({
      _id: new _database.mongoose.Types.ObjectId(id)
    });

    if (!result) {
      return res.status(404).json({
        success: false,
        message: 'Document not found'
      });
    }

    res.json({
      success: true,
      data: result
    });
  } catch (error) {
    console.error(`Error getting document from ${req.params.collection}:`, error);
    res.status(500).json({
      success: false,
      message: error.message
    });
  }
});

// API endpoint để tạo document mới
router.post('/document/:collection', checkMongoConnection, async (req, res) => {
  try {
    const { collection } = req.params;
    const document = req.body;

    // Validate document
    if (!document || Object.keys(document).length === 0) {
      return res.status(400).json({
        success: false,
        message: 'Empty document'
      });
    }

    // Thực hiện thêm mới
    const db = _database.mongoose.connection.db;
    const result = await db.collection(collection).insertOne(document);

    res.status(201).json({
      success: true,
      insertedId: result.insertedId,
      data: document
    });
  } catch (error) {
    console.error(`Error creating document in ${req.params.collection}:`, error);
    res.status(500).json({
      success: false,
      message: error.message
    });
  }
});

// API endpoint để cập nhật document
router.put('/document/:collection/:id', checkMongoConnection, async (req, res) => {
  try {
    const { collection, id } = req.params;
    const updates = req.body;

    // Validate ObjectId
    if (!_database.mongoose.Types.ObjectId.isValid(id)) {
      return res.status(400).json({
        success: false,
        message: 'Invalid ObjectId format'
      });
    }

    // Validate updates
    if (!updates || Object.keys(updates).length === 0) {
      return res.status(400).json({
        success: false,
        message: 'No updates provided'
      });
    }

    // Thực hiện cập nhật
    const db = _database.mongoose.connection.db;
    const result = await db.collection(collection).updateOne(
      { _id: new _database.mongoose.Types.ObjectId(id) },
      { $set: updates }
    );

    if (result.matchedCount === 0) {
      return res.status(404).json({
        success: false,
        message: 'Document not found'
      });
    }

    res.json({
      success: true,
      modifiedCount: result.modifiedCount,
      matchedCount: result.matchedCount
    });
  } catch (error) {
    console.error(`Error updating document in ${req.params.collection}:`, error);
    res.status(500).json({
      success: false,
      message: error.message
    });
  }
});

// API endpoint để xóa document
router.delete('/document/:collection/:id', checkMongoConnection, async (req, res) => {
  try {
    const { collection, id } = req.params;

    // Validate ObjectId
    if (!_database.mongoose.Types.ObjectId.isValid(id)) {
      return res.status(400).json({
        success: false,
        message: 'Invalid ObjectId format'
      });
    }

    // Thực hiện xóa
    const db = _database.mongoose.connection.db;
    const result = await db.collection(collection).deleteOne({
      _id: new _database.mongoose.Types.ObjectId(id)
    });

    if (result.deletedCount === 0) {
      return res.status(404).json({
        success: false,
        message: 'Document not found'
      });
    }

    res.json({
      success: true,
      deletedCount: result.deletedCount
    });
  } catch (error) {
    console.error(`Error deleting document from ${req.params.collection}:`, error);
    res.status(500).json({
      success: false,
      message: error.message
    });
  }
});

// API endpoint để đếm số lượng documents trong collection
router.post('/count/:collection', checkMongoConnection, async (req, res) => {
  try {
    const { collection } = req.params;
    const { query = {} } = req.body;

    // Thực hiện đếm
    const db = _database.mongoose.connection.db;
    const count = await db.collection(collection).countDocuments(query);

    res.json({
      success: true,
      count
    });
  } catch (error) {
    console.error(`Error counting documents in ${req.params.collection}:`, error);
    res.status(500).json({
      success: false,
      message: error.message
    });
  }
});

// API endpoint để lấy danh sách collections
router.get('/collections', checkMongoConnection, async (req, res) => {
  try {
    const db = _database.mongoose.connection.db;
    const collections = await db.listCollections().toArray();

    res.json({
      success: true,
      collections: collections.map((col) => col.name)
    });
  } catch (error) {
    console.error('Error listing collections:', error);
    res.status(500).json({
      success: false,
      message: error.message
    });
  }
});var _default = exports.default =

router;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfZXhwcmVzcyIsIl9pbnRlcm9wUmVxdWlyZURlZmF1bHQiLCJyZXF1aXJlIiwiX2RhdGFiYXNlIiwiX2FwaUF1dGgiLCJlIiwiX19lc01vZHVsZSIsImRlZmF1bHQiLCJyb3V0ZXIiLCJleHByZXNzIiwiUm91dGVyIiwiY2hlY2tNb25nb0Nvbm5lY3Rpb24iLCJyZXEiLCJyZXMiLCJuZXh0IiwiaXNNb25nb0Nvbm5lY3RlZCIsInN0YXR1cyIsImpzb24iLCJzdWNjZXNzIiwibWVzc2FnZSIsImdldCIsInJlYWR5U3RhdGUiLCJtb25nb29zZSIsImNvbm5lY3Rpb24iLCJ0aW1lc3RhbXAiLCJEYXRlIiwidG9JU09TdHJpbmciLCJ1c2UiLCJhcGlBdXRoIiwicG9zdCIsImNvbGxlY3Rpb24iLCJwYXJhbXMiLCJxdWVyeSIsInByb2plY3Rpb24iLCJvcHRpb25zIiwibGltaXQiLCJza2lwIiwiYm9keSIsIk1hdGgiLCJtaW4iLCJkYiIsInJlc3VsdHMiLCJmaW5kIiwidG9BcnJheSIsImNvdW50IiwibGVuZ3RoIiwiZGF0YSIsImVycm9yIiwiY29uc29sZSIsImlkIiwiVHlwZXMiLCJPYmplY3RJZCIsImlzVmFsaWQiLCJyZXN1bHQiLCJmaW5kT25lIiwiX2lkIiwiZG9jdW1lbnQiLCJPYmplY3QiLCJrZXlzIiwiaW5zZXJ0T25lIiwiaW5zZXJ0ZWRJZCIsInB1dCIsInVwZGF0ZXMiLCJ1cGRhdGVPbmUiLCIkc2V0IiwibWF0Y2hlZENvdW50IiwibW9kaWZpZWRDb3VudCIsImRlbGV0ZSIsImRlbGV0ZU9uZSIsImRlbGV0ZWRDb3VudCIsImNvdW50RG9jdW1lbnRzIiwiY29sbGVjdGlvbnMiLCJsaXN0Q29sbGVjdGlvbnMiLCJtYXAiLCJjb2wiLCJuYW1lIiwiX2RlZmF1bHQiLCJleHBvcnRzIl0sInNvdXJjZXMiOlsiLi4vLi4vLi4vc3JjL3JvdXRlcy9hcGlSb3V0ZXMuanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IGV4cHJlc3MgZnJvbSAnZXhwcmVzcyc7XHJcbmltcG9ydCB7IG1vbmdvb3NlIH0gZnJvbSAnLi4vY29uZmlnL2RhdGFiYXNlLmpzJztcclxuaW1wb3J0IHsgaXNNb25nb0Nvbm5lY3RlZCB9IGZyb20gJy4uL2NvbmZpZy9kYXRhYmFzZS5qcyc7XHJcbmltcG9ydCBhcGlBdXRoIGZyb20gJy4uL21pZGRsZXdhcmUvYXBpQXV0aC5qcyc7XHJcblxyXG5jb25zdCByb3V0ZXIgPSBleHByZXNzLlJvdXRlcigpO1xyXG5cclxuLyoqXHJcbiAqIEFQSSB0cnVuZyBnaWFuIMSR4buDIHRydXkgY+G6rXAgTW9uZ29EQiB04burIHRoaeG6v3QgYuG7iyBkaSDEkeG7mW5nXHJcbiAqIFRoYXkgdsOsIGvhur90IG7hu5FpIHRy4buxYyB0aeG6v3AgdOG7qyBjbGllbnQsIGNsaWVudCBz4bq9IGfhu41pIGPDoWMgQVBJIGVuZHBvaW50cyBuw6B5XHJcbiAqL1xyXG5cclxuLy8gTWlkZGxld2FyZSBraeG7g20gdHJhIGvhur90IG7hu5FpIE1vbmdvREJcclxuY29uc3QgY2hlY2tNb25nb0Nvbm5lY3Rpb24gPSAocmVxLCByZXMsIG5leHQpID0+IHtcclxuICBpZiAoIWlzTW9uZ29Db25uZWN0ZWQpIHtcclxuICAgIHJldHVybiByZXMuc3RhdHVzKDUwMykuanNvbih7IFxyXG4gICAgICBzdWNjZXNzOiBmYWxzZSwgXHJcbiAgICAgIG1lc3NhZ2U6ICdEYXRhYmFzZSBjb25uZWN0aW9uIHVuYXZhaWxhYmxlJyxcclxuICAgICAgc3RhdHVzOiAnZGlzY29ubmVjdGVkJ1xyXG4gICAgfSk7XHJcbiAgfVxyXG4gIG5leHQoKTtcclxufTtcclxuXHJcbi8vIEFQSSBlbmRwb2ludCBraeG7g20gdHJhIHRy4bqhbmcgdGjDoWkga+G6v3QgbuG7kWkgLSBLaMO0bmcgecOqdSBj4bqndSB4w6FjIHRo4buxY1xyXG5yb3V0ZXIuZ2V0KCcvc3RhdHVzJywgKHJlcSwgcmVzKSA9PiB7XHJcbiAgY29uc3Qgc3RhdHVzID0gaXNNb25nb0Nvbm5lY3RlZCA/ICdjb25uZWN0ZWQnIDogJ2Rpc2Nvbm5lY3RlZCc7XHJcbiAgY29uc3QgcmVhZHlTdGF0ZSA9IG1vbmdvb3NlLmNvbm5lY3Rpb24ucmVhZHlTdGF0ZTtcclxuICBcclxuICByZXMuanNvbih7XHJcbiAgICBzdWNjZXNzOiB0cnVlLFxyXG4gICAgc3RhdHVzLFxyXG4gICAgcmVhZHlTdGF0ZSxcclxuICAgIHRpbWVzdGFtcDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpXHJcbiAgfSk7XHJcbn0pO1xyXG5cclxuLy8gw4FwIGThu6VuZyBtaWRkbGV3YXJlIHjDoWMgdGjhu7FjIGNobyB04bqldCBj4bqjIGPDoWMgcm91dGVzIGLDqm4gZMaw4bubaVxyXG5yb3V0ZXIudXNlKGFwaUF1dGgpO1xyXG5cclxuLy8gQVBJIGVuZHBvaW50IHThu5VuZyBxdcOhdCDEkeG7gyB0cnV5IHbhuqVuIGNvbGxlY3Rpb25cclxucm91dGVyLnBvc3QoJy9xdWVyeS86Y29sbGVjdGlvbicsIGNoZWNrTW9uZ29Db25uZWN0aW9uLCBhc3luYyAocmVxLCByZXMpID0+IHtcclxuICB0cnkge1xyXG4gICAgY29uc3QgeyBjb2xsZWN0aW9uIH0gPSByZXEucGFyYW1zO1xyXG4gICAgY29uc3QgeyBxdWVyeSA9IHt9LCBwcm9qZWN0aW9uID0ge30sIG9wdGlvbnMgPSB7fSwgbGltaXQgPSAxMDAsIHNraXAgPSAwIH0gPSByZXEuYm9keTtcclxuICAgIFxyXG4gICAgLy8gR2nhu5tpIGjhuqFuIHPhu5EgbMaw4bujbmcga+G6v3QgcXXhuqMgdHLhuqMgduG7gSDEkeG7gyB0csOhbmggcXXDoSB04bqjaVxyXG4gICAgb3B0aW9ucy5saW1pdCA9IE1hdGgubWluKGxpbWl0LCAxMDApO1xyXG4gICAgb3B0aW9ucy5za2lwID0gc2tpcDtcclxuICAgIFxyXG4gICAgLy8gVGjhu7FjIGhp4buHbiB0cnV5IHbhuqVuXHJcbiAgICBjb25zdCBkYiA9IG1vbmdvb3NlLmNvbm5lY3Rpb24uZGI7XHJcbiAgICBjb25zdCByZXN1bHRzID0gYXdhaXQgZGIuY29sbGVjdGlvbihjb2xsZWN0aW9uKVxyXG4gICAgICAuZmluZChxdWVyeSwgcHJvamVjdGlvbilcclxuICAgICAgLmxpbWl0KG9wdGlvbnMubGltaXQpXHJcbiAgICAgIC5za2lwKG9wdGlvbnMuc2tpcClcclxuICAgICAgLnRvQXJyYXkoKTtcclxuICAgIFxyXG4gICAgcmVzLmpzb24oe1xyXG4gICAgICBzdWNjZXNzOiB0cnVlLFxyXG4gICAgICBjb3VudDogcmVzdWx0cy5sZW5ndGgsXHJcbiAgICAgIGRhdGE6IHJlc3VsdHNcclxuICAgIH0pO1xyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKGBFcnJvciBxdWVyeWluZyBjb2xsZWN0aW9uICR7cmVxLnBhcmFtcy5jb2xsZWN0aW9ufTpgLCBlcnJvcik7XHJcbiAgICByZXMuc3RhdHVzKDUwMCkuanNvbih7XHJcbiAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxyXG4gICAgICBtZXNzYWdlOiBlcnJvci5tZXNzYWdlXHJcbiAgICB9KTtcclxuICB9XHJcbn0pO1xyXG5cclxuLy8gQVBJIGVuZHBvaW50IMSR4buDIGzhuqV5IGRvY3VtZW50IHRoZW8gSURcclxucm91dGVyLmdldCgnL2RvY3VtZW50Lzpjb2xsZWN0aW9uLzppZCcsIGNoZWNrTW9uZ29Db25uZWN0aW9uLCBhc3luYyAocmVxLCByZXMpID0+IHtcclxuICB0cnkge1xyXG4gICAgY29uc3QgeyBjb2xsZWN0aW9uLCBpZCB9ID0gcmVxLnBhcmFtcztcclxuICAgIFxyXG4gICAgLy8gVmFsaWRhdGUgT2JqZWN0SWRcclxuICAgIGlmICghbW9uZ29vc2UuVHlwZXMuT2JqZWN0SWQuaXNWYWxpZChpZCkpIHtcclxuICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAwKS5qc29uKHtcclxuICAgICAgICBzdWNjZXNzOiBmYWxzZSxcclxuICAgICAgICBtZXNzYWdlOiAnSW52YWxpZCBPYmplY3RJZCBmb3JtYXQnXHJcbiAgICAgIH0pO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICAvLyBUaOG7sWMgaGnhu4duIHRydXkgduG6pW5cclxuICAgIGNvbnN0IGRiID0gbW9uZ29vc2UuY29ubmVjdGlvbi5kYjtcclxuICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGRiLmNvbGxlY3Rpb24oY29sbGVjdGlvbikuZmluZE9uZSh7XHJcbiAgICAgIF9pZDogbmV3IG1vbmdvb3NlLlR5cGVzLk9iamVjdElkKGlkKVxyXG4gICAgfSk7XHJcbiAgICBcclxuICAgIGlmICghcmVzdWx0KSB7XHJcbiAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwNCkuanNvbih7XHJcbiAgICAgICAgc3VjY2VzczogZmFsc2UsXHJcbiAgICAgICAgbWVzc2FnZTogJ0RvY3VtZW50IG5vdCBmb3VuZCdcclxuICAgICAgfSk7XHJcbiAgICB9XHJcbiAgICBcclxuICAgIHJlcy5qc29uKHtcclxuICAgICAgc3VjY2VzczogdHJ1ZSxcclxuICAgICAgZGF0YTogcmVzdWx0XHJcbiAgICB9KTtcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcihgRXJyb3IgZ2V0dGluZyBkb2N1bWVudCBmcm9tICR7cmVxLnBhcmFtcy5jb2xsZWN0aW9ufTpgLCBlcnJvcik7XHJcbiAgICByZXMuc3RhdHVzKDUwMCkuanNvbih7XHJcbiAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxyXG4gICAgICBtZXNzYWdlOiBlcnJvci5tZXNzYWdlXHJcbiAgICB9KTtcclxuICB9XHJcbn0pO1xyXG5cclxuLy8gQVBJIGVuZHBvaW50IMSR4buDIHThuqFvIGRvY3VtZW50IG3hu5tpXHJcbnJvdXRlci5wb3N0KCcvZG9jdW1lbnQvOmNvbGxlY3Rpb24nLCBjaGVja01vbmdvQ29ubmVjdGlvbiwgYXN5bmMgKHJlcSwgcmVzKSA9PiB7XHJcbiAgdHJ5IHtcclxuICAgIGNvbnN0IHsgY29sbGVjdGlvbiB9ID0gcmVxLnBhcmFtcztcclxuICAgIGNvbnN0IGRvY3VtZW50ID0gcmVxLmJvZHk7XHJcbiAgICBcclxuICAgIC8vIFZhbGlkYXRlIGRvY3VtZW50XHJcbiAgICBpZiAoIWRvY3VtZW50IHx8IE9iamVjdC5rZXlzKGRvY3VtZW50KS5sZW5ndGggPT09IDApIHtcclxuICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAwKS5qc29uKHtcclxuICAgICAgICBzdWNjZXNzOiBmYWxzZSxcclxuICAgICAgICBtZXNzYWdlOiAnRW1wdHkgZG9jdW1lbnQnXHJcbiAgICAgIH0pO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICAvLyBUaOG7sWMgaGnhu4duIHRow6ptIG3hu5tpXHJcbiAgICBjb25zdCBkYiA9IG1vbmdvb3NlLmNvbm5lY3Rpb24uZGI7XHJcbiAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBkYi5jb2xsZWN0aW9uKGNvbGxlY3Rpb24pLmluc2VydE9uZShkb2N1bWVudCk7XHJcbiAgICBcclxuICAgIHJlcy5zdGF0dXMoMjAxKS5qc29uKHtcclxuICAgICAgc3VjY2VzczogdHJ1ZSxcclxuICAgICAgaW5zZXJ0ZWRJZDogcmVzdWx0Lmluc2VydGVkSWQsXHJcbiAgICAgIGRhdGE6IGRvY3VtZW50XHJcbiAgICB9KTtcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcihgRXJyb3IgY3JlYXRpbmcgZG9jdW1lbnQgaW4gJHtyZXEucGFyYW1zLmNvbGxlY3Rpb259OmAsIGVycm9yKTtcclxuICAgIHJlcy5zdGF0dXMoNTAwKS5qc29uKHtcclxuICAgICAgc3VjY2VzczogZmFsc2UsXHJcbiAgICAgIG1lc3NhZ2U6IGVycm9yLm1lc3NhZ2VcclxuICAgIH0pO1xyXG4gIH1cclxufSk7XHJcblxyXG4vLyBBUEkgZW5kcG9pbnQgxJHhu4MgY+G6rXAgbmjhuq10IGRvY3VtZW50XHJcbnJvdXRlci5wdXQoJy9kb2N1bWVudC86Y29sbGVjdGlvbi86aWQnLCBjaGVja01vbmdvQ29ubmVjdGlvbiwgYXN5bmMgKHJlcSwgcmVzKSA9PiB7XHJcbiAgdHJ5IHtcclxuICAgIGNvbnN0IHsgY29sbGVjdGlvbiwgaWQgfSA9IHJlcS5wYXJhbXM7XHJcbiAgICBjb25zdCB1cGRhdGVzID0gcmVxLmJvZHk7XHJcbiAgICBcclxuICAgIC8vIFZhbGlkYXRlIE9iamVjdElkXHJcbiAgICBpZiAoIW1vbmdvb3NlLlR5cGVzLk9iamVjdElkLmlzVmFsaWQoaWQpKSB7XHJcbiAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwMCkuanNvbih7XHJcbiAgICAgICAgc3VjY2VzczogZmFsc2UsXHJcbiAgICAgICAgbWVzc2FnZTogJ0ludmFsaWQgT2JqZWN0SWQgZm9ybWF0J1xyXG4gICAgICB9KTtcclxuICAgIH1cclxuICAgIFxyXG4gICAgLy8gVmFsaWRhdGUgdXBkYXRlc1xyXG4gICAgaWYgKCF1cGRhdGVzIHx8IE9iamVjdC5rZXlzKHVwZGF0ZXMpLmxlbmd0aCA9PT0gMCkge1xyXG4gICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDApLmpzb24oe1xyXG4gICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxyXG4gICAgICAgIG1lc3NhZ2U6ICdObyB1cGRhdGVzIHByb3ZpZGVkJ1xyXG4gICAgICB9KTtcclxuICAgIH1cclxuICAgIFxyXG4gICAgLy8gVGjhu7FjIGhp4buHbiBj4bqtcCBuaOG6rXRcclxuICAgIGNvbnN0IGRiID0gbW9uZ29vc2UuY29ubmVjdGlvbi5kYjtcclxuICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGRiLmNvbGxlY3Rpb24oY29sbGVjdGlvbikudXBkYXRlT25lKFxyXG4gICAgICB7IF9pZDogbmV3IG1vbmdvb3NlLlR5cGVzLk9iamVjdElkKGlkKSB9LFxyXG4gICAgICB7ICRzZXQ6IHVwZGF0ZXMgfVxyXG4gICAgKTtcclxuICAgIFxyXG4gICAgaWYgKHJlc3VsdC5tYXRjaGVkQ291bnQgPT09IDApIHtcclxuICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDA0KS5qc29uKHtcclxuICAgICAgICBzdWNjZXNzOiBmYWxzZSxcclxuICAgICAgICBtZXNzYWdlOiAnRG9jdW1lbnQgbm90IGZvdW5kJ1xyXG4gICAgICB9KTtcclxuICAgIH1cclxuICAgIFxyXG4gICAgcmVzLmpzb24oe1xyXG4gICAgICBzdWNjZXNzOiB0cnVlLFxyXG4gICAgICBtb2RpZmllZENvdW50OiByZXN1bHQubW9kaWZpZWRDb3VudCxcclxuICAgICAgbWF0Y2hlZENvdW50OiByZXN1bHQubWF0Y2hlZENvdW50XHJcbiAgICB9KTtcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcihgRXJyb3IgdXBkYXRpbmcgZG9jdW1lbnQgaW4gJHtyZXEucGFyYW1zLmNvbGxlY3Rpb259OmAsIGVycm9yKTtcclxuICAgIHJlcy5zdGF0dXMoNTAwKS5qc29uKHtcclxuICAgICAgc3VjY2VzczogZmFsc2UsXHJcbiAgICAgIG1lc3NhZ2U6IGVycm9yLm1lc3NhZ2VcclxuICAgIH0pO1xyXG4gIH1cclxufSk7XHJcblxyXG4vLyBBUEkgZW5kcG9pbnQgxJHhu4MgeMOzYSBkb2N1bWVudFxyXG5yb3V0ZXIuZGVsZXRlKCcvZG9jdW1lbnQvOmNvbGxlY3Rpb24vOmlkJywgY2hlY2tNb25nb0Nvbm5lY3Rpb24sIGFzeW5jIChyZXEsIHJlcykgPT4ge1xyXG4gIHRyeSB7XHJcbiAgICBjb25zdCB7IGNvbGxlY3Rpb24sIGlkIH0gPSByZXEucGFyYW1zO1xyXG4gICAgXHJcbiAgICAvLyBWYWxpZGF0ZSBPYmplY3RJZFxyXG4gICAgaWYgKCFtb25nb29zZS5UeXBlcy5PYmplY3RJZC5pc1ZhbGlkKGlkKSkge1xyXG4gICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDApLmpzb24oe1xyXG4gICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxyXG4gICAgICAgIG1lc3NhZ2U6ICdJbnZhbGlkIE9iamVjdElkIGZvcm1hdCdcclxuICAgICAgfSk7XHJcbiAgICB9XHJcbiAgICBcclxuICAgIC8vIFRo4buxYyBoaeG7h24geMOzYVxyXG4gICAgY29uc3QgZGIgPSBtb25nb29zZS5jb25uZWN0aW9uLmRiO1xyXG4gICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgZGIuY29sbGVjdGlvbihjb2xsZWN0aW9uKS5kZWxldGVPbmUoe1xyXG4gICAgICBfaWQ6IG5ldyBtb25nb29zZS5UeXBlcy5PYmplY3RJZChpZClcclxuICAgIH0pO1xyXG4gICAgXHJcbiAgICBpZiAocmVzdWx0LmRlbGV0ZWRDb3VudCA9PT0gMCkge1xyXG4gICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDQpLmpzb24oe1xyXG4gICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxyXG4gICAgICAgIG1lc3NhZ2U6ICdEb2N1bWVudCBub3QgZm91bmQnXHJcbiAgICAgIH0pO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICByZXMuanNvbih7XHJcbiAgICAgIHN1Y2Nlc3M6IHRydWUsXHJcbiAgICAgIGRlbGV0ZWRDb3VudDogcmVzdWx0LmRlbGV0ZWRDb3VudFxyXG4gICAgfSk7XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoYEVycm9yIGRlbGV0aW5nIGRvY3VtZW50IGZyb20gJHtyZXEucGFyYW1zLmNvbGxlY3Rpb259OmAsIGVycm9yKTtcclxuICAgIHJlcy5zdGF0dXMoNTAwKS5qc29uKHtcclxuICAgICAgc3VjY2VzczogZmFsc2UsXHJcbiAgICAgIG1lc3NhZ2U6IGVycm9yLm1lc3NhZ2VcclxuICAgIH0pO1xyXG4gIH1cclxufSk7XHJcblxyXG4vLyBBUEkgZW5kcG9pbnQgxJHhu4MgxJHhur9tIHPhu5EgbMaw4bujbmcgZG9jdW1lbnRzIHRyb25nIGNvbGxlY3Rpb25cclxucm91dGVyLnBvc3QoJy9jb3VudC86Y29sbGVjdGlvbicsIGNoZWNrTW9uZ29Db25uZWN0aW9uLCBhc3luYyAocmVxLCByZXMpID0+IHtcclxuICB0cnkge1xyXG4gICAgY29uc3QgeyBjb2xsZWN0aW9uIH0gPSByZXEucGFyYW1zO1xyXG4gICAgY29uc3QgeyBxdWVyeSA9IHt9IH0gPSByZXEuYm9keTtcclxuICAgIFxyXG4gICAgLy8gVGjhu7FjIGhp4buHbiDEkeG6v21cclxuICAgIGNvbnN0IGRiID0gbW9uZ29vc2UuY29ubmVjdGlvbi5kYjtcclxuICAgIGNvbnN0IGNvdW50ID0gYXdhaXQgZGIuY29sbGVjdGlvbihjb2xsZWN0aW9uKS5jb3VudERvY3VtZW50cyhxdWVyeSk7XHJcbiAgICBcclxuICAgIHJlcy5qc29uKHtcclxuICAgICAgc3VjY2VzczogdHJ1ZSxcclxuICAgICAgY291bnRcclxuICAgIH0pO1xyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKGBFcnJvciBjb3VudGluZyBkb2N1bWVudHMgaW4gJHtyZXEucGFyYW1zLmNvbGxlY3Rpb259OmAsIGVycm9yKTtcclxuICAgIHJlcy5zdGF0dXMoNTAwKS5qc29uKHtcclxuICAgICAgc3VjY2VzczogZmFsc2UsXHJcbiAgICAgIG1lc3NhZ2U6IGVycm9yLm1lc3NhZ2VcclxuICAgIH0pO1xyXG4gIH1cclxufSk7XHJcblxyXG4vLyBBUEkgZW5kcG9pbnQgxJHhu4MgbOG6pXkgZGFuaCBzw6FjaCBjb2xsZWN0aW9uc1xyXG5yb3V0ZXIuZ2V0KCcvY29sbGVjdGlvbnMnLCBjaGVja01vbmdvQ29ubmVjdGlvbiwgYXN5bmMgKHJlcSwgcmVzKSA9PiB7XHJcbiAgdHJ5IHtcclxuICAgIGNvbnN0IGRiID0gbW9uZ29vc2UuY29ubmVjdGlvbi5kYjtcclxuICAgIGNvbnN0IGNvbGxlY3Rpb25zID0gYXdhaXQgZGIubGlzdENvbGxlY3Rpb25zKCkudG9BcnJheSgpO1xyXG4gICAgXHJcbiAgICByZXMuanNvbih7XHJcbiAgICAgIHN1Y2Nlc3M6IHRydWUsXHJcbiAgICAgIGNvbGxlY3Rpb25zOiBjb2xsZWN0aW9ucy5tYXAoY29sID0+IGNvbC5uYW1lKVxyXG4gICAgfSk7XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGxpc3RpbmcgY29sbGVjdGlvbnM6JywgZXJyb3IpO1xyXG4gICAgcmVzLnN0YXR1cyg1MDApLmpzb24oe1xyXG4gICAgICBzdWNjZXNzOiBmYWxzZSxcclxuICAgICAgbWVzc2FnZTogZXJyb3IubWVzc2FnZVxyXG4gICAgfSk7XHJcbiAgfVxyXG59KTtcclxuXHJcbmV4cG9ydCBkZWZhdWx0IHJvdXRlcjsgIl0sIm1hcHBpbmdzIjoib0dBQUEsSUFBQUEsUUFBQSxHQUFBQyxzQkFBQSxDQUFBQyxPQUFBO0FBQ0EsSUFBQUMsU0FBQSxHQUFBRCxPQUFBOztBQUVBLElBQUFFLFFBQUEsR0FBQUgsc0JBQUEsQ0FBQUMsT0FBQSw4QkFBK0MsU0FBQUQsdUJBQUFJLENBQUEsVUFBQUEsQ0FBQSxJQUFBQSxDQUFBLENBQUFDLFVBQUEsR0FBQUQsQ0FBQSxLQUFBRSxPQUFBLEVBQUFGLENBQUE7O0FBRS9DLE1BQU1HLE1BQU0sR0FBR0MsZ0JBQU8sQ0FBQ0MsTUFBTSxDQUFDLENBQUM7O0FBRS9CO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0EsTUFBTUMsb0JBQW9CLEdBQUdBLENBQUNDLEdBQUcsRUFBRUMsR0FBRyxFQUFFQyxJQUFJLEtBQUs7RUFDL0MsSUFBSSxDQUFDQywwQkFBZ0IsRUFBRTtJQUNyQixPQUFPRixHQUFHLENBQUNHLE1BQU0sQ0FBQyxHQUFHLENBQUMsQ0FBQ0MsSUFBSSxDQUFDO01BQzFCQyxPQUFPLEVBQUUsS0FBSztNQUNkQyxPQUFPLEVBQUUsaUNBQWlDO01BQzFDSCxNQUFNLEVBQUU7SUFDVixDQUFDLENBQUM7RUFDSjtFQUNBRixJQUFJLENBQUMsQ0FBQztBQUNSLENBQUM7O0FBRUQ7QUFDQU4sTUFBTSxDQUFDWSxHQUFHLENBQUMsU0FBUyxFQUFFLENBQUNSLEdBQUcsRUFBRUMsR0FBRyxLQUFLO0VBQ2xDLE1BQU1HLE1BQU0sR0FBR0QsMEJBQWdCLEdBQUcsV0FBVyxHQUFHLGNBQWM7RUFDOUQsTUFBTU0sVUFBVSxHQUFHQyxrQkFBUSxDQUFDQyxVQUFVLENBQUNGLFVBQVU7O0VBRWpEUixHQUFHLENBQUNJLElBQUksQ0FBQztJQUNQQyxPQUFPLEVBQUUsSUFBSTtJQUNiRixNQUFNO0lBQ05LLFVBQVU7SUFDVkcsU0FBUyxF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