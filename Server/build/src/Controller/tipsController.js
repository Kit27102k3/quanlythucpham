"use strict";var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(exports, "__esModule", { value: true });exports.updateTip = exports.likeTip = exports.getTipsByCategory = exports.getTipById = exports.getFeaturedTips = exports.getAllTips = exports.deleteTip = exports.createTip = void 0;var _Tips = _interopRequireDefault(require("../Model/Tips.js"));
var _cloudinary = _interopRequireDefault(require("../config/cloudinary.js"));
var _fs = _interopRequireDefault(require("fs"));

// Lấy tất cả mẹo hay
const getAllTips = async (req, res) => {
  try {
    const tips = await _Tips.default.find().sort({ createdAt: -1 });
    res.status(200).json(tips);
  } catch (error) {
    console.error("Lỗi khi lấy danh sách mẹo:", error);
    res.status(500).json({ message: "Lỗi khi lấy danh sách mẹo", error: error.message });
  }
};

// Lấy mẹo hay theo ID
exports.getAllTips = getAllTips;const getTipById = async (req, res) => {
  try {
    const { id } = req.params;
    const tip = await _Tips.default.findById(id);

    if (!tip) {
      return res.status(404).json({ message: "Không tìm thấy mẹo" });
    }

    res.status(200).json(tip);
  } catch (error) {
    console.error("Lỗi khi lấy chi tiết mẹo:", error);
    res.status(500).json({ message: "Lỗi khi lấy chi tiết mẹo", error: error.message });
  }
};

// Lấy mẹo hay theo danh mục
exports.getTipById = getTipById;const getTipsByCategory = async (req, res) => {
  try {
    const { category } = req.params;
    const tips = await _Tips.default.find({ category }).sort({ createdAt: -1 });

    res.status(200).json(tips);
  } catch (error) {
    console.error("Lỗi khi lấy mẹo theo danh mục:", error);
    res.status(500).json({ message: "Lỗi khi lấy mẹo theo danh mục", error: error.message });
  }
};

// Tạo mẹo hay mới
exports.getTipsByCategory = getTipsByCategory;const createTip = async (req, res) => {
  try {
    let imageUrl = "";

    // Xử lý upload ảnh nếu có
    if (req.file) {
      try {
        const result = await _cloudinary.default.uploader.upload(req.file.path, {
          folder: "tips",
          resource_type: "auto"
        });
        imageUrl = result.secure_url;
        // Xóa file tạm sau khi đã upload
        _fs.default.unlinkSync(req.file.path);
      } catch (uploadError) {
        console.error("Lỗi khi upload ảnh:", uploadError);
        if (_fs.default.existsSync(req.file.path)) {
          _fs.default.unlinkSync(req.file.path);
        }
        return res.status(500).json({ message: "Lỗi khi upload ảnh", error: uploadError.message });
      }
    }

    // Xử lý tags
    let tags = [];
    if (req.body.tags) {
      try {
        tags = Array.isArray(req.body.tags) ? req.body.tags : JSON.parse(req.body.tags);
      } catch (error) {
        tags = req.body.tags.split(",").map((tag) => tag.trim());
      }
    }

    // Format ngày xuất bản
    let datePublished = req.body.datePublished ? new Date(req.body.datePublished) : new Date();

    const newTip = new _Tips.default({
      title: req.body.title,
      category: req.body.category,
      image: imageUrl || req.body.image,
      content: req.body.content,
      author: req.body.author,
      authorTitle: req.body.authorTitle,
      tags: tags,
      likes: req.body.likes || 0,
      datePublished: datePublished,
      isFeatured: req.body.isFeatured === "true"
    });

    const savedTip = await newTip.save();
    res.status(201).json(savedTip);
  } catch (error) {
    console.error("Lỗi khi tạo mẹo mới:", error);
    // Xóa file tạm nếu có lỗi xảy ra
    if (req.file && _fs.default.existsSync(req.file.path)) {
      _fs.default.unlinkSync(req.file.path);
    }
    res.status(500).json({ message: "Lỗi khi tạo mẹo mới", error: error.message });
  }
};

// Cập nhật mẹo hay
exports.createTip = createTip;const updateTip = async (req, res) => {
  try {
    const { id } = req.params;

    // Kiểm tra mẹo có tồn tại không
    const existingTip = await _Tips.default.findById(id);
    if (!existingTip) {
      return res.status(404).json({ message: "Không tìm thấy mẹo" });
    }

    // Xử lý upload ảnh mới nếu có
    let imageUrl = existingTip.image;
    if (req.file) {
      try {
        const result = await _cloudinary.default.uploader.upload(req.file.path, {
          folder: "tips",
          resource_type: "auto"
        });
        imageUrl = result.secure_url;
        // Xóa file tạm sau khi đã upload
        _fs.default.unlinkSync(req.file.path);
      } catch (uploadError) {
        console.error("Lỗi khi upload ảnh:", uploadError);
        if (_fs.default.existsSync(req.file.path)) {
          _fs.default.unlinkSync(req.file.path);
        }
        return res.status(500).json({ message: "Lỗi khi upload ảnh", error: uploadError.message });
      }
    } else if (req.body.image) {
      // Nếu có image URL trong request body
      imageUrl = req.body.image;
    }

    // Xử lý tags
    let tags = existingTip.tags;
    if (req.body.tags) {
      try {
        tags = Array.isArray(req.body.tags) ? req.body.tags : JSON.parse(req.body.tags);
      } catch (error) {
        tags = req.body.tags.split(",").map((tag) => tag.trim());
      }
    }

    // Format ngày xuất bản
    let datePublished = existingTip.datePublished;
    if (req.body.datePublished) {
      datePublished = new Date(req.body.datePublished);
    }

    const updatedTip = await _Tips.default.findByIdAndUpdate(
      id,
      {
        title: req.body.title || existingTip.title,
        category: req.body.category || existingTip.category,
        image: imageUrl,
        content: req.body.content || existingTip.content,
        author: req.body.author || existingTip.author,
        authorTitle: req.body.authorTitle || existingTip.authorTitle,
        tags: tags,
        likes: req.body.likes !== undefined ? req.body.likes : existingTip.likes,
        datePublished: datePublished,
        isFeatured: req.body.isFeatured !== undefined ?
        req.body.isFeatured === "true" || req.body.isFeatured === true :
        existingTip.isFeatured
      },
      { new: true }
    );

    res.status(200).json(updatedTip);
  } catch (error) {
    console.error("Lỗi khi cập nhật mẹo:", error);
    // Xóa file tạm nếu có lỗi xảy ra
    if (req.file && _fs.default.existsSync(req.file.path)) {
      _fs.default.unlinkSync(req.file.path);
    }
    res.status(500).json({ message: "Lỗi khi cập nhật mẹo", error: error.message });
  }
};

// Xóa mẹo hay
exports.updateTip = updateTip;const deleteTip = async (req, res) => {
  try {
    const { id } = req.params;

    const tip = await _Tips.default.findByIdAndDelete(id);

    if (!tip) {
      return res.status(404).json({ message: "Không tìm thấy mẹo" });
    }

    res.status(200).json({ message: "Xóa mẹo thành công" });
  } catch (error) {
    console.error("Lỗi khi xóa mẹo:", error);
    res.status(500).json({ message: "Lỗi khi xóa mẹo", error: error.message });
  }
};

// Tăng likes cho mẹo hay
exports.deleteTip = deleteTip;const likeTip = async (req, res) => {
  try {
    const { id } = req.params;

    const tip = await _Tips.default.findById(id);

    if (!tip) {
      return res.status(404).json({ message: "Không tìm thấy mẹo" });
    }

    tip.likes += 1;
    await tip.save();

    res.status(200).json({ likes: tip.likes });
  } catch (error) {
    console.error("Lỗi khi tăng like:", error);
    res.status(500).json({ message: "Lỗi khi tăng like", error: error.message });
  }
};

// Lấy các mẹo nổi bật
exports.likeTip = likeTip;const getFeaturedTips = async (req, res) => {
  try {
    const featuredTips = await _Tips.default.find({ isFeatured: true }).sort({ datePublished: -1 });

    res.status(200).json(featuredTips);
  } catch (error) {
    console.error("Lỗi khi lấy mẹo nổi bật:", error);
    res.status(500).json({ message: "Lỗi khi lấy mẹo nổi bật", error: error.message });
  }
};exports.getFeaturedTips = getFeaturedTips;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfVGlwcyIsIl9pbnRlcm9wUmVxdWlyZURlZmF1bHQiLCJyZXF1aXJlIiwiX2Nsb3VkaW5hcnkiLCJfZnMiLCJnZXRBbGxUaXBzIiwicmVxIiwicmVzIiwidGlwcyIsIlRpcCIsImZpbmQiLCJzb3J0IiwiY3JlYXRlZEF0Iiwic3RhdHVzIiwianNvbiIsImVycm9yIiwiY29uc29sZSIsIm1lc3NhZ2UiLCJleHBvcnRzIiwiZ2V0VGlwQnlJZCIsImlkIiwicGFyYW1zIiwidGlwIiwiZmluZEJ5SWQiLCJnZXRUaXBzQnlDYXRlZ29yeSIsImNhdGVnb3J5IiwiY3JlYXRlVGlwIiwiaW1hZ2VVcmwiLCJmaWxlIiwicmVzdWx0IiwiY2xvdWRpbmFyeSIsInVwbG9hZGVyIiwidXBsb2FkIiwicGF0aCIsImZvbGRlciIsInJlc291cmNlX3R5cGUiLCJzZWN1cmVfdXJsIiwiZnMiLCJ1bmxpbmtTeW5jIiwidXBsb2FkRXJyb3IiLCJleGlzdHNTeW5jIiwidGFncyIsImJvZHkiLCJBcnJheSIsImlzQXJyYXkiLCJKU09OIiwicGFyc2UiLCJzcGxpdCIsIm1hcCIsInRhZyIsInRyaW0iLCJkYXRlUHVibGlzaGVkIiwiRGF0ZSIsIm5ld1RpcCIsInRpdGxlIiwiaW1hZ2UiLCJjb250ZW50IiwiYXV0aG9yIiwiYXV0aG9yVGl0bGUiLCJsaWtlcyIsImlzRmVhdHVyZWQiLCJzYXZlZFRpcCIsInNhdmUiLCJ1cGRhdGVUaXAiLCJleGlzdGluZ1RpcCIsInVwZGF0ZWRUaXAiLCJmaW5kQnlJZEFuZFVwZGF0ZSIsInVuZGVmaW5lZCIsIm5ldyIsImRlbGV0ZVRpcCIsImZpbmRCeUlkQW5kRGVsZXRlIiwibGlrZVRpcCIsImdldEZlYXR1cmVkVGlwcyIsImZlYXR1cmVkVGlwcyJdLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NyYy9Db250cm9sbGVyL3RpcHNDb250cm9sbGVyLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBUaXAgZnJvbSBcIi4uL01vZGVsL1RpcHMuanNcIjtcclxuaW1wb3J0IGNsb3VkaW5hcnkgZnJvbSBcIi4uL2NvbmZpZy9jbG91ZGluYXJ5LmpzXCI7XHJcbmltcG9ydCBmcyBmcm9tIFwiZnNcIjtcclxuXHJcbi8vIEzhuqV5IHThuqV0IGPhuqMgbeG6uW8gaGF5XHJcbmV4cG9ydCBjb25zdCBnZXRBbGxUaXBzID0gYXN5bmMgKHJlcSwgcmVzKSA9PiB7XHJcbiAgdHJ5IHtcclxuICAgIGNvbnN0IHRpcHMgPSBhd2FpdCBUaXAuZmluZCgpLnNvcnQoeyBjcmVhdGVkQXQ6IC0xIH0pO1xyXG4gICAgcmVzLnN0YXR1cygyMDApLmpzb24odGlwcyk7XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoXCJM4buXaSBraGkgbOG6pXkgZGFuaCBzw6FjaCBt4bq5bzpcIiwgZXJyb3IpO1xyXG4gICAgcmVzLnN0YXR1cyg1MDApLmpzb24oeyBtZXNzYWdlOiBcIkzhu5dpIGtoaSBs4bqleSBkYW5oIHPDoWNoIG3hurlvXCIsIGVycm9yOiBlcnJvci5tZXNzYWdlIH0pO1xyXG4gIH1cclxufTtcclxuXHJcbi8vIEzhuqV5IG3hurlvIGhheSB0aGVvIElEXHJcbmV4cG9ydCBjb25zdCBnZXRUaXBCeUlkID0gYXN5bmMgKHJlcSwgcmVzKSA9PiB7XHJcbiAgdHJ5IHtcclxuICAgIGNvbnN0IHsgaWQgfSA9IHJlcS5wYXJhbXM7XHJcbiAgICBjb25zdCB0aXAgPSBhd2FpdCBUaXAuZmluZEJ5SWQoaWQpO1xyXG4gICAgXHJcbiAgICBpZiAoIXRpcCkge1xyXG4gICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDQpLmpzb24oeyBtZXNzYWdlOiBcIktow7RuZyB0w6xtIHRo4bqleSBt4bq5b1wiIH0pO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICByZXMuc3RhdHVzKDIwMCkuanNvbih0aXApO1xyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKFwiTOG7l2kga2hpIGzhuqV5IGNoaSB0aeG6v3QgbeG6uW86XCIsIGVycm9yKTtcclxuICAgIHJlcy5zdGF0dXMoNTAwKS5qc29uKHsgbWVzc2FnZTogXCJM4buXaSBraGkgbOG6pXkgY2hpIHRp4bq/dCBt4bq5b1wiLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9KTtcclxuICB9XHJcbn07XHJcblxyXG4vLyBM4bqleSBt4bq5byBoYXkgdGhlbyBkYW5oIG3hu6VjXHJcbmV4cG9ydCBjb25zdCBnZXRUaXBzQnlDYXRlZ29yeSA9IGFzeW5jIChyZXEsIHJlcykgPT4ge1xyXG4gIHRyeSB7XHJcbiAgICBjb25zdCB7IGNhdGVnb3J5IH0gPSByZXEucGFyYW1zO1xyXG4gICAgY29uc3QgdGlwcyA9IGF3YWl0IFRpcC5maW5kKHsgY2F0ZWdvcnkgfSkuc29ydCh7IGNyZWF0ZWRBdDogLTEgfSk7XHJcbiAgICBcclxuICAgIHJlcy5zdGF0dXMoMjAwKS5qc29uKHRpcHMpO1xyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKFwiTOG7l2kga2hpIGzhuqV5IG3hurlvIHRoZW8gZGFuaCBt4bulYzpcIiwgZXJyb3IpO1xyXG4gICAgcmVzLnN0YXR1cyg1MDApLmpzb24oeyBtZXNzYWdlOiBcIkzhu5dpIGtoaSBs4bqleSBt4bq5byB0aGVvIGRhbmggbeG7pWNcIiwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfSk7XHJcbiAgfVxyXG59O1xyXG5cclxuLy8gVOG6oW8gbeG6uW8gaGF5IG3hu5tpXHJcbmV4cG9ydCBjb25zdCBjcmVhdGVUaXAgPSBhc3luYyAocmVxLCByZXMpID0+IHtcclxuICB0cnkge1xyXG4gICAgbGV0IGltYWdlVXJsID0gXCJcIjtcclxuICAgIFxyXG4gICAgLy8gWOG7rSBsw70gdXBsb2FkIOG6o25oIG7hur91IGPDs1xyXG4gICAgaWYgKHJlcS5maWxlKSB7XHJcbiAgICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgY2xvdWRpbmFyeS51cGxvYWRlci51cGxvYWQocmVxLmZpbGUucGF0aCwge1xyXG4gICAgICAgICAgZm9sZGVyOiBcInRpcHNcIixcclxuICAgICAgICAgIHJlc291cmNlX3R5cGU6IFwiYXV0b1wiLFxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIGltYWdlVXJsID0gcmVzdWx0LnNlY3VyZV91cmw7XHJcbiAgICAgICAgLy8gWMOzYSBmaWxlIHThuqFtIHNhdSBraGkgxJHDoyB1cGxvYWRcclxuICAgICAgICBmcy51bmxpbmtTeW5jKHJlcS5maWxlLnBhdGgpO1xyXG4gICAgICB9IGNhdGNoICh1cGxvYWRFcnJvcikge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoXCJM4buXaSBraGkgdXBsb2FkIOG6o25oOlwiLCB1cGxvYWRFcnJvcik7XHJcbiAgICAgICAgaWYgKGZzLmV4aXN0c1N5bmMocmVxLmZpbGUucGF0aCkpIHtcclxuICAgICAgICAgIGZzLnVubGlua1N5bmMocmVxLmZpbGUucGF0aCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiByZXMuc3RhdHVzKDUwMCkuanNvbih7IG1lc3NhZ2U6IFwiTOG7l2kga2hpIHVwbG9hZCDhuqNuaFwiLCBlcnJvcjogdXBsb2FkRXJyb3IubWVzc2FnZSB9KTtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gICAgXHJcbiAgICAvLyBY4butIGzDvSB0YWdzXHJcbiAgICBsZXQgdGFncyA9IFtdO1xyXG4gICAgaWYgKHJlcS5ib2R5LnRhZ3MpIHtcclxuICAgICAgdHJ5IHtcclxuICAgICAgICB0YWdzID0gQXJyYXkuaXNBcnJheShyZXEuYm9keS50YWdzKSA/IHJlcS5ib2R5LnRhZ3MgOiBKU09OLnBhcnNlKHJlcS5ib2R5LnRhZ3MpO1xyXG4gICAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICAgIHRhZ3MgPSByZXEuYm9keS50YWdzLnNwbGl0KFwiLFwiKS5tYXAodGFnID0+IHRhZy50cmltKCkpO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgICBcclxuICAgIC8vIEZvcm1hdCBuZ8OgeSB4deG6pXQgYuG6o25cclxuICAgIGxldCBkYXRlUHVibGlzaGVkID0gcmVxLmJvZHkuZGF0ZVB1Ymxpc2hlZCA/IG5ldyBEYXRlKHJlcS5ib2R5LmRhdGVQdWJsaXNoZWQpIDogbmV3IERhdGUoKTtcclxuICAgIFxyXG4gICAgY29uc3QgbmV3VGlwID0gbmV3IFRpcCh7XHJcbiAgICAgIHRpdGxlOiByZXEuYm9keS50aXRsZSxcclxuICAgICAgY2F0ZWdvcnk6IHJlcS5ib2R5LmNhdGVnb3J5LFxyXG4gICAgICBpbWFnZTogaW1hZ2VVcmwgfHwgcmVxLmJvZHkuaW1hZ2UsXHJcbiAgICAgIGNvbnRlbnQ6IHJlcS5ib2R5LmNvbnRlbnQsXHJcbiAgICAgIGF1dGhvcjogcmVxLmJvZHkuYXV0aG9yLFxyXG4gICAgICBhdXRob3JUaXRsZTogcmVxLmJvZHkuYXV0aG9yVGl0bGUsXHJcbiAgICAgIHRhZ3M6IHRhZ3MsXHJcbiAgICAgIGxpa2VzOiByZXEuYm9keS5saWtlcyB8fCAwLFxyXG4gICAgICBkYXRlUHVibGlzaGVkOiBkYXRlUHVibGlzaGVkLFxyXG4gICAgICBpc0ZlYXR1cmVkOiByZXEuYm9keS5pc0ZlYXR1cmVkID09PSBcInRydWVcIlxyXG4gICAgfSk7XHJcbiAgICBcclxuICAgIGNvbnN0IHNhdmVkVGlwID0gYXdhaXQgbmV3VGlwLnNhdmUoKTtcclxuICAgIHJlcy5zdGF0dXMoMjAxKS5qc29uKHNhdmVkVGlwKTtcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcihcIkzhu5dpIGtoaSB04bqhbyBt4bq5byBt4bubaTpcIiwgZXJyb3IpO1xyXG4gICAgLy8gWMOzYSBmaWxlIHThuqFtIG7hur91IGPDsyBs4buXaSB44bqjeSByYVxyXG4gICAgaWYgKHJlcS5maWxlICYmIGZzLmV4aXN0c1N5bmMocmVxLmZpbGUucGF0aCkpIHtcclxuICAgICAgZnMudW5saW5rU3luYyhyZXEuZmlsZS5wYXRoKTtcclxuICAgIH1cclxuICAgIHJlcy5zdGF0dXMoNTAwKS5qc29uKHsgbWVzc2FnZTogXCJM4buXaSBraGkgdOG6oW8gbeG6uW8gbeG7m2lcIiwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfSk7XHJcbiAgfVxyXG59O1xyXG5cclxuLy8gQ+G6rXAgbmjhuq10IG3hurlvIGhheVxyXG5leHBvcnQgY29uc3QgdXBkYXRlVGlwID0gYXN5bmMgKHJlcSwgcmVzKSA9PiB7XHJcbiAgdHJ5IHtcclxuICAgIGNvbnN0IHsgaWQgfSA9IHJlcS5wYXJhbXM7XHJcbiAgICBcclxuICAgIC8vIEtp4buDbSB0cmEgbeG6uW8gY8OzIHThu5NuIHThuqFpIGtow7RuZ1xyXG4gICAgY29uc3QgZXhpc3RpbmdUaXAgPSBhd2FpdCBUaXAuZmluZEJ5SWQoaWQpO1xyXG4gICAgaWYgKCFleGlzdGluZ1RpcCkge1xyXG4gICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDQpLmpzb24oeyBtZXNzYWdlOiBcIktow7RuZyB0w6xtIHRo4bqleSBt4bq5b1wiIH0pO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICAvLyBY4butIGzDvSB1cGxvYWQg4bqjbmggbeG7m2kgbuG6v3UgY8OzXHJcbiAgICBsZXQgaW1hZ2VVcmwgPSBleGlzdGluZ1RpcC5pbWFnZTtcclxuICAgIGlmIChyZXEuZmlsZSkge1xyXG4gICAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGNsb3VkaW5hcnkudXBsb2FkZXIudXBsb2FkKHJlcS5maWxlLnBhdGgsIHtcclxuICAgICAgICAgIGZvbGRlcjogXCJ0aXBzXCIsXHJcbiAgICAgICAgICByZXNvdXJjZV90eXBlOiBcImF1dG9cIixcclxuICAgICAgICB9KTtcclxuICAgICAgICBpbWFnZVVybCA9IHJlc3VsdC5zZWN1cmVfdXJsO1xyXG4gICAgICAgIC8vIFjDs2EgZmlsZSB04bqhbSBzYXUga2hpIMSRw6MgdXBsb2FkXHJcbiAgICAgICAgZnMudW5saW5rU3luYyhyZXEuZmlsZS5wYXRoKTtcclxuICAgICAgfSBjYXRjaCAodXBsb2FkRXJyb3IpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKFwiTOG7l2kga2hpIHVwbG9hZCDhuqNuaDpcIiwgdXBsb2FkRXJyb3IpO1xyXG4gICAgICAgIGlmIChmcy5leGlzdHNTeW5jKHJlcS5maWxlLnBhdGgpKSB7XHJcbiAgICAgICAgICBmcy51bmxpbmtTeW5jKHJlcS5maWxlLnBhdGgpO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gcmVzLnN0YXR1cyg1MDApLmpzb24oeyBtZXNzYWdlOiBcIkzhu5dpIGtoaSB1cGxvYWQg4bqjbmhcIiwgZXJyb3I6IHVwbG9hZEVycm9yLm1lc3NhZ2UgfSk7XHJcbiAgICAgIH1cclxuICAgIH0gZWxzZSBpZiAocmVxLmJvZHkuaW1hZ2UpIHtcclxuICAgICAgLy8gTuG6v3UgY8OzIGltYWdlIFVSTCB0cm9uZyByZXF1ZXN0IGJvZHlcclxuICAgICAgaW1hZ2VVcmwgPSByZXEuYm9keS5pbWFnZTtcclxuICAgIH1cclxuICAgIFxyXG4gICAgLy8gWOG7rSBsw70gdGFnc1xyXG4gICAgbGV0IHRhZ3MgPSBleGlzdGluZ1RpcC50YWdzO1xyXG4gICAgaWYgKHJlcS5ib2R5LnRhZ3MpIHtcclxuICAgICAgdHJ5IHtcclxuICAgICAgICB0YWdzID0gQXJyYXkuaXNBcnJheShyZXEuYm9keS50YWdzKSA/IHJlcS5ib2R5LnRhZ3MgOiBKU09OLnBhcnNlKHJlcS5ib2R5LnRhZ3MpO1xyXG4gICAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICAgIHRhZ3MgPSByZXEuYm9keS50YWdzLnNwbGl0KFwiLFwiKS5tYXAodGFnID0+IHRhZy50cmltKCkpO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgICBcclxuICAgIC8vIEZvcm1hdCBuZ8OgeSB4deG6pXQgYuG6o25cclxuICAgIGxldCBkYXRlUHVibGlzaGVkID0gZXhpc3RpbmdUaXAuZGF0ZVB1Ymxpc2hlZDtcclxuICAgIGlmIChyZXEuYm9keS5kYXRlUHVibGlzaGVkKSB7XHJcbiAgICAgIGRhdGVQdWJsaXNoZWQgPSBuZXcgRGF0ZShyZXEuYm9keS5kYXRlUHVibGlzaGVkKTtcclxuICAgIH1cclxuICAgIFxyXG4gICAgY29uc3QgdXBkYXRlZFRpcCA9IGF3YWl0IFRpcC5maW5kQnlJZEFuZFVwZGF0ZShcclxuICAgICAgaWQsXHJcbiAgICAgIHtcclxuICAgICAgICB0aXRsZTogcmVxLmJvZHkudGl0bGUgfHwgZXhpc3RpbmdUaXAudGl0bGUsXHJcbiAgICAgICAgY2F0ZWdvcnk6IHJlcS5ib2R5LmNhdGVnb3J5IHx8IGV4aXN0aW5nVGlwLmNhdGVnb3J5LFxyXG4gICAgICAgIGltYWdlOiBpbWFnZVVybCxcclxuICAgICAgICBjb250ZW50OiByZXEuYm9keS5jb250ZW50IHx8IGV4aXN0aW5nVGlwLmNvbnRlbnQsXHJcbiAgICAgICAgYXV0aG9yOiByZXEuYm9keS5hdXRob3IgfHwgZXhpc3RpbmdUaXAuYXV0aG9yLFxyXG4gICAgICAgIGF1dGhvclRpdGxlOiByZXEuYm9keS5hdXRob3JUaXRsZSB8fCBleGlzdGluZ1RpcC5hdXRob3JUaXRsZSxcclxuICAgICAgICB0YWdzOiB0YWdzLFxyXG4gICAgICAgIGxpa2VzOiByZXEuYm9keS5saWtlcyAhPT0gdW5kZWZpbmVkID8gcmVxLmJvZHkubGlrZXMgOiBleGlzdGluZ1RpcC5saWtlcyxcclxuICAgICAgICBkYXRlUHVibGlzaGVkOiBkYXRlUHVibGlzaGVkLFxyXG4gICAgICAgIGlzRmVhdHVyZWQ6IHJlcS5ib2R5LmlzRmVhdHVyZWQgIT09IHVuZGVmaW5lZCA/IFxyXG4gICAgICAgICAgcmVxLmJvZHkuaXNGZWF0dXJlZCA9PT0gXCJ0cnVlXCIgfHwgcmVxLmJvZHkuaXNGZWF0dXJlZCA9PT0gdHJ1ZSA6IFxyXG4gICAgICAgICAgZXhpc3RpbmdUaXAuaXNGZWF0dXJlZFxyXG4gICAgICB9LFxyXG4gICAgICB7IG5ldzogdHJ1ZSB9XHJcbiAgICApO1xyXG4gICAgXHJcbiAgICByZXMuc3RhdHVzKDIwMCkuanNvbih1cGRhdGVkVGlwKTtcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcihcIkzhu5dpIGtoaSBj4bqtcCBuaOG6rXQgbeG6uW86XCIsIGVycm9yKTtcclxuICAgIC8vIFjDs2EgZmlsZSB04bqhbSBu4bq/dSBjw7MgbOG7l2kgeOG6o3kgcmFcclxuICAgIGlmIChyZXEuZmlsZSAmJiBmcy5leGlzdHNTeW5jKHJlcS5maWxlLnBhdGgpKSB7XHJcbiAgICAgIGZzLnVubGlua1N5bmMocmVxLmZpbGUucGF0aCk7XHJcbiAgICB9XHJcbiAgICByZXMuc3RhdHVzKDUwMCkuanNvbih7IG1lc3NhZ2U6IFwiTOG7l2kga2hpIGPhuq1wIG5o4bqtdCBt4bq5b1wiLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9KTtcclxuICB9XHJcbn07XHJcblxyXG4vLyBYw7NhIG3hurlvIGhheVxyXG5leHBvcnQgY29uc3QgZGVsZXRlVGlwID0gYXN5bmMgKHJlcSwgcmVzKSA9PiB7XHJcbiAgdHJ5IHtcclxuICAgIGNvbnN0IHsgaWQgfSA9IHJlcS5wYXJhbXM7XHJcbiAgICBcclxuICAgIGNvbnN0IHRpcCA9IGF3YWl0IFRpcC5maW5kQnlJZEFuZERlbGV0ZShpZCk7XHJcbiAgICBcclxuICAgIGlmICghdGlwKSB7XHJcbiAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwNCkuanNvbih7IG1lc3NhZ2U6IFwiS2jDtG5nIHTDrG0gdGjhuqV5IG3hurlvXCIgfSk7XHJcbiAgICB9XHJcbiAgICBcclxuICAgIHJlcy5zdGF0dXMoMjAwKS5qc29uKHsgbWVzc2FnZTogXCJYw7NhIG3hurlvIHRow6BuaCBjw7RuZ1wiIH0pO1xyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKFwiTOG7l2kga2hpIHjDs2EgbeG6uW86XCIsIGVycm9yKTtcclxuICAgIHJlcy5zdGF0dXMoNTAwKS5qc29uKHsgbWVzc2FnZTogXCJM4buXaSBraGkgeMOzYSBt4bq5b1wiLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9KTtcclxuICB9XHJcbn07XHJcblxyXG4vLyBUxINuZyBsaWtlcyBjaG8gbeG6uW8gaGF5XHJcbmV4cG9ydCBjb25zdCBsaWtlVGlwID0gYXN5bmMgKHJlcSwgcmVzKSA9PiB7XHJcbiAgdHJ5IHtcclxuICAgIGNvbnN0IHsgaWQgfSA9IHJlcS5wYXJhbXM7XHJcbiAgICBcclxuICAgIGNvbnN0IHRpcCA9IGF3YWl0IFRpcC5maW5kQnlJZChpZCk7XHJcbiAgICBcclxuICAgIGlmICghdGlwKSB7XHJcbiAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwNCkuanNvbih7IG1lc3NhZ2U6IFwiS2jDtG5nIHTDrG0gdGjhuqV5IG3hurlvXCIgfSk7XHJcbiAgICB9XHJcbiAgICBcclxuICAgIHRpcC5saWtlcyArPSAxO1xyXG4gICAgYXdhaXQgdGlwLnNhdmUoKTtcclxuICAgIFxyXG4gICAgcmVzLnN0YXR1cygyMDApLmpzb24oeyBsaWtlczogdGlwLmxpa2VzIH0pO1xyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKFwiTOG7l2kga2hpIHTEg25nIGxpa2U6XCIsIGVycm9yKTtcclxuICAgIHJlcy5zdGF0dXMoNTAwKS5qc29uKHsgbWVzc2FnZTogXCJM4buXaSBraGkgdMSDbmcgbGlrZVwiLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9KTtcclxuICB9XHJcbn07XHJcblxyXG4vLyBM4bqleSBjw6FjIG3hurlvIG7hu5VpIGLhuq10XHJcbmV4cG9ydCBjb25zdCBnZXRGZWF0dXJlZFRpcHMgPSBhc3luYyAocmVxLCByZXMpID0+IHtcclxuICB0cnkge1xyXG4gICAgY29uc3QgZmVhdHVyZWRUaXBzID0gYXdhaXQgVGlwLmZpbmQoeyBpc0ZlYXR1cmVkOiB0cnVlIH0pLnNvcnQoeyBkYXRlUHVibGlzaGVkOiAtMSB9KTtcclxuICAgIFxyXG4gICAgcmVzLnN0YXR1cygyMDApLmpzb24oZmVhdHVyZWRUaXBzKTtcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcihcIkzhu5dpIGtoaSBs4bqleSBt4bq5byBu4buVaSBi4bqtdDpcIiwgZXJyb3IpO1xyXG4gICAgcmVzLnN0YXR1cyg1MDApLmpzb24oeyBtZXNzYWdlOiBcIkzhu5dpIGtoaSBs4bqleSBt4bq5byBu4buVaSBi4bqtdFwiLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9KTtcclxuICB9XHJcbn07ICJdLCJtYXBwaW5ncyI6InFWQUFBLElBQUFBLEtBQUEsR0FBQUMsc0JBQUEsQ0FBQUMsT0FBQTtBQUNBLElBQUFDLFdBQUEsR0FBQUYsc0JBQUEsQ0FBQUMsT0FBQTtBQUNBLElBQUFFLEdBQUEsR0FBQUgsc0JBQUEsQ0FBQUMsT0FBQTs7QUFFQTtBQUNPLE1BQU1HLFVBQVUsR0FBRyxNQUFBQSxDQUFPQyxHQUFHLEVBQUVDLEdBQUcsS0FBSztFQUM1QyxJQUFJO0lBQ0YsTUFBTUMsSUFBSSxHQUFHLE1BQU1DLGFBQUcsQ0FBQ0MsSUFBSSxDQUFDLENBQUMsQ0FBQ0MsSUFBSSxDQUFDLEVBQUVDLFNBQVMsRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7SUFDckRMLEdBQUcsQ0FBQ00sTUFBTSxDQUFDLEdBQUcsQ0FBQyxDQUFDQyxJQUFJLENBQUNOLElBQUksQ0FBQztFQUM1QixDQUFDLENBQUMsT0FBT08sS0FBSyxFQUFFO0lBQ2RDLE9BQU8sQ0FBQ0QsS0FBSyxDQUFDLDRCQUE0QixFQUFFQSxLQUFLLENBQUM7SUFDbERSLEdBQUcsQ0FBQ00sTUFBTSxDQUFDLEdBQUcsQ0FBQyxDQUFDQyxJQUFJLENBQUMsRUFBRUcsT0FBTyxFQUFFLDJCQUEyQixFQUFFRixLQUFLLEVBQUVBLEtBQUssQ0FBQ0UsT0FBTyxDQUFDLENBQUMsQ0FBQztFQUN0RjtBQUNGLENBQUM7O0FBRUQ7QUFBQUMsT0FBQSxDQUFBYixVQUFBLEdBQUFBLFVBQUEsQ0FDTyxNQUFNYyxVQUFVLEdBQUcsTUFBQUEsQ0FBT2IsR0FBRyxFQUFFQyxHQUFHLEtBQUs7RUFDNUMsSUFBSTtJQUNGLE1BQU0sRUFBRWEsRUFBRSxDQUFDLENBQUMsR0FBR2QsR0FBRyxDQUFDZSxNQUFNO0lBQ3pCLE1BQU1DLEdB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