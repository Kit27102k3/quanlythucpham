"use strict";Object.defineProperty(exports, "__esModule", { value: true });exports.updateTip = exports.likeTip = exports.getTipsByCategory = exports.getTipById = exports.getFeaturedTips = exports.getAllTips = exports.deleteTip = exports.createTip = void 0;var _Tips = _interopRequireDefault(require("../Model/Tips.js"));
var _cloudinary = _interopRequireDefault(require("../config/cloudinary.js"));
var _fs = _interopRequireDefault(require("fs"));function _interopRequireDefault(e) {return e && e.__esModule ? e : { default: e };}

// Lấy tất cả mẹo hay
const getAllTips = async (req, res) => {
  try {
    const tips = await _Tips.default.find().sort({ createdAt: -1 });
    res.status(200).json(tips);
  } catch (error) {
    console.error("Lỗi khi lấy danh sách mẹo:", error);
    res.status(500).json({ message: "Lỗi khi lấy danh sách mẹo", error: error.message });
  }
};

// Lấy mẹo hay theo ID
exports.getAllTips = getAllTips;const getTipById = async (req, res) => {
  try {
    const { id } = req.params;
    const tip = await _Tips.default.findById(id);

    if (!tip) {
      return res.status(404).json({ message: "Không tìm thấy mẹo" });
    }

    res.status(200).json(tip);
  } catch (error) {
    console.error("Lỗi khi lấy chi tiết mẹo:", error);
    res.status(500).json({ message: "Lỗi khi lấy chi tiết mẹo", error: error.message });
  }
};

// Lấy mẹo hay theo danh mục
exports.getTipById = getTipById;const getTipsByCategory = async (req, res) => {
  try {
    const { category } = req.params;
    const tips = await _Tips.default.find({ category }).sort({ createdAt: -1 });

    res.status(200).json(tips);
  } catch (error) {
    console.error("Lỗi khi lấy mẹo theo danh mục:", error);
    res.status(500).json({ message: "Lỗi khi lấy mẹo theo danh mục", error: error.message });
  }
};

// Tạo mẹo hay mới
exports.getTipsByCategory = getTipsByCategory;const createTip = async (req, res) => {
  try {
    let imageUrl = "";

    // Xử lý upload ảnh nếu có
    if (req.file) {
      try {
        const result = await _cloudinary.default.uploader.upload(req.file.path, {
          folder: "tips",
          resource_type: "auto"
        });
        imageUrl = result.secure_url;
        // Xóa file tạm sau khi đã upload
        _fs.default.unlinkSync(req.file.path);
      } catch (uploadError) {
        console.error("Lỗi khi upload ảnh:", uploadError);
        if (_fs.default.existsSync(req.file.path)) {
          _fs.default.unlinkSync(req.file.path);
        }
        return res.status(500).json({ message: "Lỗi khi upload ảnh", error: uploadError.message });
      }
    }

    // Xử lý tags
    let tags = [];
    if (req.body.tags) {
      try {
        tags = Array.isArray(req.body.tags) ? req.body.tags : JSON.parse(req.body.tags);
      } catch (error) {
        tags = req.body.tags.split(",").map((tag) => tag.trim());
      }
    }

    // Format ngày xuất bản
    let datePublished = req.body.datePublished ? new Date(req.body.datePublished) : new Date();

    const newTip = new _Tips.default({
      title: req.body.title,
      category: req.body.category,
      image: imageUrl || req.body.image,
      content: req.body.content,
      author: req.body.author,
      authorTitle: req.body.authorTitle,
      tags: tags,
      likes: req.body.likes || 0,
      datePublished: datePublished,
      isFeatured: req.body.isFeatured === "true"
    });

    const savedTip = await newTip.save();
    res.status(201).json(savedTip);
  } catch (error) {
    console.error("Lỗi khi tạo mẹo mới:", error);
    // Xóa file tạm nếu có lỗi xảy ra
    if (req.file && _fs.default.existsSync(req.file.path)) {
      _fs.default.unlinkSync(req.file.path);
    }
    res.status(500).json({ message: "Lỗi khi tạo mẹo mới", error: error.message });
  }
};

// Cập nhật mẹo hay
exports.createTip = createTip;const updateTip = async (req, res) => {
  try {
    const { id } = req.params;

    // Kiểm tra mẹo có tồn tại không
    const existingTip = await _Tips.default.findById(id);
    if (!existingTip) {
      return res.status(404).json({ message: "Không tìm thấy mẹo" });
    }

    // Xử lý upload ảnh mới nếu có
    let imageUrl = existingTip.image;
    if (req.file) {
      try {
        const result = await _cloudinary.default.uploader.upload(req.file.path, {
          folder: "tips",
          resource_type: "auto"
        });
        imageUrl = result.secure_url;
        // Xóa file tạm sau khi đã upload
        _fs.default.unlinkSync(req.file.path);
      } catch (uploadError) {
        console.error("Lỗi khi upload ảnh:", uploadError);
        if (_fs.default.existsSync(req.file.path)) {
          _fs.default.unlinkSync(req.file.path);
        }
        return res.status(500).json({ message: "Lỗi khi upload ảnh", error: uploadError.message });
      }
    } else if (req.body.image) {
      // Nếu có image URL trong request body
      imageUrl = req.body.image;
    }

    // Xử lý tags
    let tags = existingTip.tags;
    if (req.body.tags) {
      try {
        tags = Array.isArray(req.body.tags) ? req.body.tags : JSON.parse(req.body.tags);
      } catch (error) {
        tags = req.body.tags.split(",").map((tag) => tag.trim());
      }
    }

    // Format ngày xuất bản
    let datePublished = existingTip.datePublished;
    if (req.body.datePublished) {
      datePublished = new Date(req.body.datePublished);
    }

    const updatedTip = await _Tips.default.findByIdAndUpdate(
      id,
      {
        title: req.body.title || existingTip.title,
        category: req.body.category || existingTip.category,
        image: imageUrl,
        content: req.body.content || existingTip.content,
        author: req.body.author || existingTip.author,
        authorTitle: req.body.authorTitle || existingTip.authorTitle,
        tags: tags,
        likes: req.body.likes !== undefined ? req.body.likes : existingTip.likes,
        datePublished: datePublished,
        isFeatured: req.body.isFeatured !== undefined ?
        req.body.isFeatured === "true" || req.body.isFeatured === true :
        existingTip.isFeatured
      },
      { new: true }
    );

    res.status(200).json(updatedTip);
  } catch (error) {
    console.error("Lỗi khi cập nhật mẹo:", error);
    // Xóa file tạm nếu có lỗi xảy ra
    if (req.file && _fs.default.existsSync(req.file.path)) {
      _fs.default.unlinkSync(req.file.path);
    }
    res.status(500).json({ message: "Lỗi khi cập nhật mẹo", error: error.message });
  }
};

// Xóa mẹo hay
exports.updateTip = updateTip;const deleteTip = async (req, res) => {
  try {
    const { id } = req.params;

    const tip = await _Tips.default.findByIdAndDelete(id);

    if (!tip) {
      return res.status(404).json({ message: "Không tìm thấy mẹo" });
    }

    res.status(200).json({ message: "Xóa mẹo thành công" });
  } catch (error) {
    console.error("Lỗi khi xóa mẹo:", error);
    res.status(500).json({ message: "Lỗi khi xóa mẹo", error: error.message });
  }
};

// Tăng likes cho mẹo hay
exports.deleteTip = deleteTip;const likeTip = async (req, res) => {
  try {
    const { id } = req.params;

    const tip = await _Tips.default.findById(id);

    if (!tip) {
      return res.status(404).json({ message: "Không tìm thấy mẹo" });
    }

    tip.likes += 1;
    await tip.save();

    res.status(200).json({ likes: tip.likes });
  } catch (error) {
    console.error("Lỗi khi tăng like:", error);
    res.status(500).json({ message: "Lỗi khi tăng like", error: error.message });
  }
};

// Lấy các mẹo nổi bật
exports.likeTip = likeTip;const getFeaturedTips = async (req, res) => {
  try {
    const featuredTips = await _Tips.default.find({ isFeatured: true }).sort({ datePublished: -1 });

    res.status(200).json(featuredTips);
  } catch (error) {
    console.error("Lỗi khi lấy mẹo nổi bật:", error);
    res.status(500).json({ message: "Lỗi khi lấy mẹo nổi bật", error: error.message });
  }
};exports.getFeaturedTips = getFeaturedTips;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfVGlwcyIsIl9pbnRlcm9wUmVxdWlyZURlZmF1bHQiLCJyZXF1aXJlIiwiX2Nsb3VkaW5hcnkiLCJfZnMiLCJlIiwiX19lc01vZHVsZSIsImRlZmF1bHQiLCJnZXRBbGxUaXBzIiwicmVxIiwicmVzIiwidGlwcyIsIlRpcCIsImZpbmQiLCJzb3J0IiwiY3JlYXRlZEF0Iiwic3RhdHVzIiwianNvbiIsImVycm9yIiwiY29uc29sZSIsIm1lc3NhZ2UiLCJleHBvcnRzIiwiZ2V0VGlwQnlJZCIsImlkIiwicGFyYW1zIiwidGlwIiwiZmluZEJ5SWQiLCJnZXRUaXBzQnlDYXRlZ29yeSIsImNhdGVnb3J5IiwiY3JlYXRlVGlwIiwiaW1hZ2VVcmwiLCJmaWxlIiwicmVzdWx0IiwiY2xvdWRpbmFyeSIsInVwbG9hZGVyIiwidXBsb2FkIiwicGF0aCIsImZvbGRlciIsInJlc291cmNlX3R5cGUiLCJzZWN1cmVfdXJsIiwiZnMiLCJ1bmxpbmtTeW5jIiwidXBsb2FkRXJyb3IiLCJleGlzdHNTeW5jIiwidGFncyIsImJvZHkiLCJBcnJheSIsImlzQXJyYXkiLCJKU09OIiwicGFyc2UiLCJzcGxpdCIsIm1hcCIsInRhZyIsInRyaW0iLCJkYXRlUHVibGlzaGVkIiwiRGF0ZSIsIm5ld1RpcCIsInRpdGxlIiwiaW1hZ2UiLCJjb250ZW50IiwiYXV0aG9yIiwiYXV0aG9yVGl0bGUiLCJsaWtlcyIsImlzRmVhdHVyZWQiLCJzYXZlZFRpcCIsInNhdmUiLCJ1cGRhdGVUaXAiLCJleGlzdGluZ1RpcCIsInVwZGF0ZWRUaXAiLCJmaW5kQnlJZEFuZFVwZGF0ZSIsInVuZGVmaW5lZCIsIm5ldyIsImRlbGV0ZVRpcCIsImZpbmRCeUlkQW5kRGVsZXRlIiwibGlrZVRpcCIsImdldEZlYXR1cmVkVGlwcyIsImZlYXR1cmVkVGlwcyJdLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NyYy9Db250cm9sbGVyL3RpcHNDb250cm9sbGVyLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBUaXAgZnJvbSBcIi4uL01vZGVsL1RpcHMuanNcIjtcclxuaW1wb3J0IGNsb3VkaW5hcnkgZnJvbSBcIi4uL2NvbmZpZy9jbG91ZGluYXJ5LmpzXCI7XHJcbmltcG9ydCBmcyBmcm9tIFwiZnNcIjtcclxuXHJcbi8vIEzhuqV5IHThuqV0IGPhuqMgbeG6uW8gaGF5XHJcbmV4cG9ydCBjb25zdCBnZXRBbGxUaXBzID0gYXN5bmMgKHJlcSwgcmVzKSA9PiB7XHJcbiAgdHJ5IHtcclxuICAgIGNvbnN0IHRpcHMgPSBhd2FpdCBUaXAuZmluZCgpLnNvcnQoeyBjcmVhdGVkQXQ6IC0xIH0pO1xyXG4gICAgcmVzLnN0YXR1cygyMDApLmpzb24odGlwcyk7XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoXCJM4buXaSBraGkgbOG6pXkgZGFuaCBzw6FjaCBt4bq5bzpcIiwgZXJyb3IpO1xyXG4gICAgcmVzLnN0YXR1cyg1MDApLmpzb24oeyBtZXNzYWdlOiBcIkzhu5dpIGtoaSBs4bqleSBkYW5oIHPDoWNoIG3hurlvXCIsIGVycm9yOiBlcnJvci5tZXNzYWdlIH0pO1xyXG4gIH1cclxufTtcclxuXHJcbi8vIEzhuqV5IG3hurlvIGhheSB0aGVvIElEXHJcbmV4cG9ydCBjb25zdCBnZXRUaXBCeUlkID0gYXN5bmMgKHJlcSwgcmVzKSA9PiB7XHJcbiAgdHJ5IHtcclxuICAgIGNvbnN0IHsgaWQgfSA9IHJlcS5wYXJhbXM7XHJcbiAgICBjb25zdCB0aXAgPSBhd2FpdCBUaXAuZmluZEJ5SWQoaWQpO1xyXG4gICAgXHJcbiAgICBpZiAoIXRpcCkge1xyXG4gICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDQpLmpzb24oeyBtZXNzYWdlOiBcIktow7RuZyB0w6xtIHRo4bqleSBt4bq5b1wiIH0pO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICByZXMuc3RhdHVzKDIwMCkuanNvbih0aXApO1xyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKFwiTOG7l2kga2hpIGzhuqV5IGNoaSB0aeG6v3QgbeG6uW86XCIsIGVycm9yKTtcclxuICAgIHJlcy5zdGF0dXMoNTAwKS5qc29uKHsgbWVzc2FnZTogXCJM4buXaSBraGkgbOG6pXkgY2hpIHRp4bq/dCBt4bq5b1wiLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9KTtcclxuICB9XHJcbn07XHJcblxyXG4vLyBM4bqleSBt4bq5byBoYXkgdGhlbyBkYW5oIG3hu6VjXHJcbmV4cG9ydCBjb25zdCBnZXRUaXBzQnlDYXRlZ29yeSA9IGFzeW5jIChyZXEsIHJlcykgPT4ge1xyXG4gIHRyeSB7XHJcbiAgICBjb25zdCB7IGNhdGVnb3J5IH0gPSByZXEucGFyYW1zO1xyXG4gICAgY29uc3QgdGlwcyA9IGF3YWl0IFRpcC5maW5kKHsgY2F0ZWdvcnkgfSkuc29ydCh7IGNyZWF0ZWRBdDogLTEgfSk7XHJcbiAgICBcclxuICAgIHJlcy5zdGF0dXMoMjAwKS5qc29uKHRpcHMpO1xyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKFwiTOG7l2kga2hpIGzhuqV5IG3hurlvIHRoZW8gZGFuaCBt4bulYzpcIiwgZXJyb3IpO1xyXG4gICAgcmVzLnN0YXR1cyg1MDApLmpzb24oeyBtZXNzYWdlOiBcIkzhu5dpIGtoaSBs4bqleSBt4bq5byB0aGVvIGRhbmggbeG7pWNcIiwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfSk7XHJcbiAgfVxyXG59O1xyXG5cclxuLy8gVOG6oW8gbeG6uW8gaGF5IG3hu5tpXHJcbmV4cG9ydCBjb25zdCBjcmVhdGVUaXAgPSBhc3luYyAocmVxLCByZXMpID0+IHtcclxuICB0cnkge1xyXG4gICAgbGV0IGltYWdlVXJsID0gXCJcIjtcclxuICAgIFxyXG4gICAgLy8gWOG7rSBsw70gdXBsb2FkIOG6o25oIG7hur91IGPDs1xyXG4gICAgaWYgKHJlcS5maWxlKSB7XHJcbiAgICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgY2xvdWRpbmFyeS51cGxvYWRlci51cGxvYWQocmVxLmZpbGUucGF0aCwge1xyXG4gICAgICAgICAgZm9sZGVyOiBcInRpcHNcIixcclxuICAgICAgICAgIHJlc291cmNlX3R5cGU6IFwiYXV0b1wiLFxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIGltYWdlVXJsID0gcmVzdWx0LnNlY3VyZV91cmw7XHJcbiAgICAgICAgLy8gWMOzYSBmaWxlIHThuqFtIHNhdSBraGkgxJHDoyB1cGxvYWRcclxuICAgICAgICBmcy51bmxpbmtTeW5jKHJlcS5maWxlLnBhdGgpO1xyXG4gICAgICB9IGNhdGNoICh1cGxvYWRFcnJvcikge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoXCJM4buXaSBraGkgdXBsb2FkIOG6o25oOlwiLCB1cGxvYWRFcnJvcik7XHJcbiAgICAgICAgaWYgKGZzLmV4aXN0c1N5bmMocmVxLmZpbGUucGF0aCkpIHtcclxuICAgICAgICAgIGZzLnVubGlua1N5bmMocmVxLmZpbGUucGF0aCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiByZXMuc3RhdHVzKDUwMCkuanNvbih7IG1lc3NhZ2U6IFwiTOG7l2kga2hpIHVwbG9hZCDhuqNuaFwiLCBlcnJvcjogdXBsb2FkRXJyb3IubWVzc2FnZSB9KTtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gICAgXHJcbiAgICAvLyBY4butIGzDvSB0YWdzXHJcbiAgICBsZXQgdGFncyA9IFtdO1xyXG4gICAgaWYgKHJlcS5ib2R5LnRhZ3MpIHtcclxuICAgICAgdHJ5IHtcclxuICAgICAgICB0YWdzID0gQXJyYXkuaXNBcnJheShyZXEuYm9keS50YWdzKSA/IHJlcS5ib2R5LnRhZ3MgOiBKU09OLnBhcnNlKHJlcS5ib2R5LnRhZ3MpO1xyXG4gICAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICAgIHRhZ3MgPSByZXEuYm9keS50YWdzLnNwbGl0KFwiLFwiKS5tYXAodGFnID0+IHRhZy50cmltKCkpO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgICBcclxuICAgIC8vIEZvcm1hdCBuZ8OgeSB4deG6pXQgYuG6o25cclxuICAgIGxldCBkYXRlUHVibGlzaGVkID0gcmVxLmJvZHkuZGF0ZVB1Ymxpc2hlZCA/IG5ldyBEYXRlKHJlcS5ib2R5LmRhdGVQdWJsaXNoZWQpIDogbmV3IERhdGUoKTtcclxuICAgIFxyXG4gICAgY29uc3QgbmV3VGlwID0gbmV3IFRpcCh7XHJcbiAgICAgIHRpdGxlOiByZXEuYm9keS50aXRsZSxcclxuICAgICAgY2F0ZWdvcnk6IHJlcS5ib2R5LmNhdGVnb3J5LFxyXG4gICAgICBpbWFnZTogaW1hZ2VVcmwgfHwgcmVxLmJvZHkuaW1hZ2UsXHJcbiAgICAgIGNvbnRlbnQ6IHJlcS5ib2R5LmNvbnRlbnQsXHJcbiAgICAgIGF1dGhvcjogcmVxLmJvZHkuYXV0aG9yLFxyXG4gICAgICBhdXRob3JUaXRsZTogcmVxLmJvZHkuYXV0aG9yVGl0bGUsXHJcbiAgICAgIHRhZ3M6IHRhZ3MsXHJcbiAgICAgIGxpa2VzOiByZXEuYm9keS5saWtlcyB8fCAwLFxyXG4gICAgICBkYXRlUHVibGlzaGVkOiBkYXRlUHVibGlzaGVkLFxyXG4gICAgICBpc0ZlYXR1cmVkOiByZXEuYm9keS5pc0ZlYXR1cmVkID09PSBcInRydWVcIlxyXG4gICAgfSk7XHJcbiAgICBcclxuICAgIGNvbnN0IHNhdmVkVGlwID0gYXdhaXQgbmV3VGlwLnNhdmUoKTtcclxuICAgIHJlcy5zdGF0dXMoMjAxKS5qc29uKHNhdmVkVGlwKTtcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcihcIkzhu5dpIGtoaSB04bqhbyBt4bq5byBt4bubaTpcIiwgZXJyb3IpO1xyXG4gICAgLy8gWMOzYSBmaWxlIHThuqFtIG7hur91IGPDsyBs4buXaSB44bqjeSByYVxyXG4gICAgaWYgKHJlcS5maWxlICYmIGZzLmV4aXN0c1N5bmMocmVxLmZpbGUucGF0aCkpIHtcclxuICAgICAgZnMudW5saW5rU3luYyhyZXEuZmlsZS5wYXRoKTtcclxuICAgIH1cclxuICAgIHJlcy5zdGF0dXMoNTAwKS5qc29uKHsgbWVzc2FnZTogXCJM4buXaSBraGkgdOG6oW8gbeG6uW8gbeG7m2lcIiwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfSk7XHJcbiAgfVxyXG59O1xyXG5cclxuLy8gQ+G6rXAgbmjhuq10IG3hurlvIGhheVxyXG5leHBvcnQgY29uc3QgdXBkYXRlVGlwID0gYXN5bmMgKHJlcSwgcmVzKSA9PiB7XHJcbiAgdHJ5IHtcclxuICAgIGNvbnN0IHsgaWQgfSA9IHJlcS5wYXJhbXM7XHJcbiAgICBcclxuICAgIC8vIEtp4buDbSB0cmEgbeG6uW8gY8OzIHThu5NuIHThuqFpIGtow7RuZ1xyXG4gICAgY29uc3QgZXhpc3RpbmdUaXAgPSBhd2FpdCBUaXAuZmluZEJ5SWQoaWQpO1xyXG4gICAgaWYgKCFleGlzdGluZ1RpcCkge1xyXG4gICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDQpLmpzb24oeyBtZXNzYWdlOiBcIktow7RuZyB0w6xtIHRo4bqleSBt4bq5b1wiIH0pO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICAvLyBY4butIGzDvSB1cGxvYWQg4bqjbmggbeG7m2kgbuG6v3UgY8OzXHJcbiAgICBsZXQgaW1hZ2VVcmwgPSBleGlzdGluZ1RpcC5pbWFnZTtcclxuICAgIGlmIChyZXEuZmlsZSkge1xyXG4gICAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGNsb3VkaW5hcnkudXBsb2FkZXIudXBsb2FkKHJlcS5maWxlLnBhdGgsIHtcclxuICAgICAgICAgIGZvbGRlcjogXCJ0aXBzXCIsXHJcbiAgICAgICAgICByZXNvdXJjZV90eXBlOiBcImF1dG9cIixcclxuICAgICAgICB9KTtcclxuICAgICAgICBpbWFnZVVybCA9IHJlc3VsdC5zZWN1cmVfdXJsO1xyXG4gICAgICAgIC8vIFjDs2EgZmlsZSB04bqhbSBzYXUga2hpIMSRw6MgdXBsb2FkXHJcbiAgICAgICAgZnMudW5saW5rU3luYyhyZXEuZmlsZS5wYXRoKTtcclxuICAgICAgfSBjYXRjaCAodXBsb2FkRXJyb3IpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKFwiTOG7l2kga2hpIHVwbG9hZCDhuqNuaDpcIiwgdXBsb2FkRXJyb3IpO1xyXG4gICAgICAgIGlmIChmcy5leGlzdHNTeW5jKHJlcS5maWxlLnBhdGgpKSB7XHJcbiAgICAgICAgICBmcy51bmxpbmtTeW5jKHJlcS5maWxlLnBhdGgpO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gcmVzLnN0YXR1cyg1MDApLmpzb24oeyBtZXNzYWdlOiBcIkzhu5dpIGtoaSB1cGxvYWQg4bqjbmhcIiwgZXJyb3I6IHVwbG9hZEVycm9yLm1lc3NhZ2UgfSk7XHJcbiAgICAgIH1cclxuICAgIH0gZWxzZSBpZiAocmVxLmJvZHkuaW1hZ2UpIHtcclxuICAgICAgLy8gTuG6v3UgY8OzIGltYWdlIFVSTCB0cm9uZyByZXF1ZXN0IGJvZHlcclxuICAgICAgaW1hZ2VVcmwgPSByZXEuYm9keS5pbWFnZTtcclxuICAgIH1cclxuICAgIFxyXG4gICAgLy8gWOG7rSBsw70gdGFnc1xyXG4gICAgbGV0IHRhZ3MgPSBleGlzdGluZ1RpcC50YWdzO1xyXG4gICAgaWYgKHJlcS5ib2R5LnRhZ3MpIHtcclxuICAgICAgdHJ5IHtcclxuICAgICAgICB0YWdzID0gQXJyYXkuaXNBcnJheShyZXEuYm9keS50YWdzKSA/IHJlcS5ib2R5LnRhZ3MgOiBKU09OLnBhcnNlKHJlcS5ib2R5LnRhZ3MpO1xyXG4gICAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICAgIHRhZ3MgPSByZXEuYm9keS50YWdzLnNwbGl0KFwiLFwiKS5tYXAodGFnID0+IHRhZy50cmltKCkpO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgICBcclxuICAgIC8vIEZvcm1hdCBuZ8OgeSB4deG6pXQgYuG6o25cclxuICAgIGxldCBkYXRlUHVibGlzaGVkID0gZXhpc3RpbmdUaXAuZGF0ZVB1Ymxpc2hlZDtcclxuICAgIGlmIChyZXEuYm9keS5kYXRlUHVibGlzaGVkKSB7XHJcbiAgICAgIGRhdGVQdWJsaXNoZWQgPSBuZXcgRGF0ZShyZXEuYm9keS5kYXRlUHVibGlzaGVkKTtcclxuICAgIH1cclxuICAgIFxyXG4gICAgY29uc3QgdXBkYXRlZFRpcCA9IGF3YWl0IFRpcC5maW5kQnlJZEFuZFVwZGF0ZShcclxuICAgICAgaWQsXHJcbiAgICAgIHtcclxuICAgICAgICB0aXRsZTogcmVxLmJvZHkudGl0bGUgfHwgZXhpc3RpbmdUaXAudGl0bGUsXHJcbiAgICAgICAgY2F0ZWdvcnk6IHJlcS5ib2R5LmNhdGVnb3J5IHx8IGV4aXN0aW5nVGlwLmNhdGVnb3J5LFxyXG4gICAgICAgIGltYWdlOiBpbWFnZVVybCxcclxuICAgICAgICBjb250ZW50OiByZXEuYm9keS5jb250ZW50IHx8IGV4aXN0aW5nVGlwLmNvbnRlbnQsXHJcbiAgICAgICAgYXV0aG9yOiByZXEuYm9keS5hdXRob3IgfHwgZXhpc3RpbmdUaXAuYXV0aG9yLFxyXG4gICAgICAgIGF1dGhvclRpdGxlOiByZXEuYm9keS5hdXRob3JUaXRsZSB8fCBleGlzdGluZ1RpcC5hdXRob3JUaXRsZSxcclxuICAgICAgICB0YWdzOiB0YWdzLFxyXG4gICAgICAgIGxpa2VzOiByZXEuYm9keS5saWtlcyAhPT0gdW5kZWZpbmVkID8gcmVxLmJvZHkubGlrZXMgOiBleGlzdGluZ1RpcC5saWtlcyxcclxuICAgICAgICBkYXRlUHVibGlzaGVkOiBkYXRlUHVibGlzaGVkLFxyXG4gICAgICAgIGlzRmVhdHVyZWQ6IHJlcS5ib2R5LmlzRmVhdHVyZWQgIT09IHVuZGVmaW5lZCA/IFxyXG4gICAgICAgICAgcmVxLmJvZHkuaXNGZWF0dXJlZCA9PT0gXCJ0cnVlXCIgfHwgcmVxLmJvZHkuaXNGZWF0dXJlZCA9PT0gdHJ1ZSA6IFxyXG4gICAgICAgICAgZXhpc3RpbmdUaXAuaXNGZWF0dXJlZFxyXG4gICAgICB9LFxyXG4gICAgICB7IG5ldzogdHJ1ZSB9XHJcbiAgICApO1xyXG4gICAgXHJcbiAgICByZXMuc3RhdHVzKDIwMCkuanNvbih1cGRhdGVkVGlwKTtcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcihcIkzhu5dpIGtoaSBj4bqtcCBuaOG6rXQgbeG6uW86XCIsIGVycm9yKTtcclxuICAgIC8vIFjDs2EgZmlsZSB04bqhbSBu4bq/dSBjw7MgbOG7l2kgeOG6o3kgcmFcclxuICAgIGlmIChyZXEuZmlsZSAmJiBmcy5leGlzdHNTeW5jKHJlcS5maWxlLnBhdGgpKSB7XHJcbiAgICAgIGZzLnVubGlua1N5bmMocmVxLmZpbGUucGF0aCk7XHJcbiAgICB9XHJcbiAgICByZXMuc3RhdHVzKDUwMCkuanNvbih7IG1lc3NhZ2U6IFwiTOG7l2kga2hpIGPhuq1wIG5o4bqtdCBt4bq5b1wiLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9KTtcclxuICB9XHJcbn07XHJcblxyXG4vLyBYw7NhIG3hurlvIGhheVxyXG5leHBvcnQgY29uc3QgZGVsZXRlVGlwID0gYXN5bmMgKHJlcSwgcmVzKSA9PiB7XHJcbiAgdHJ5IHtcclxuICAgIGNvbnN0IHsgaWQgfSA9IHJlcS5wYXJhbXM7XHJcbiAgICBcclxuICAgIGNvbnN0IHRpcCA9IGF3YWl0IFRpcC5maW5kQnlJZEFuZERlbGV0ZShpZCk7XHJcbiAgICBcclxuICAgIGlmICghdGlwKSB7XHJcbiAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwNCkuanNvbih7IG1lc3NhZ2U6IFwiS2jDtG5nIHTDrG0gdGjhuqV5IG3hurlvXCIgfSk7XHJcbiAgICB9XHJcbiAgICBcclxuICAgIHJlcy5zdGF0dXMoMjAwKS5qc29uKHsgbWVzc2FnZTogXCJYw7NhIG3hurlvIHRow6BuaCBjw7RuZ1wiIH0pO1xyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKFwiTOG7l2kga2hpIHjDs2EgbeG6uW86XCIsIGVycm9yKTtcclxuICAgIHJlcy5zdGF0dXMoNTAwKS5qc29uKHsgbWVzc2FnZTogXCJM4buXaSBraGkgeMOzYSBt4bq5b1wiLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9KTtcclxuICB9XHJcbn07XHJcblxyXG4vLyBUxINuZyBsaWtlcyBjaG8gbeG6uW8gaGF5XHJcbmV4cG9ydCBjb25zdCBsaWtlVGlwID0gYXN5bmMgKHJlcSwgcmVzKSA9PiB7XHJcbiAgdHJ5IHtcclxuICAgIGNvbnN0IHsgaWQgfSA9IHJlcS5wYXJhbXM7XHJcbiAgICBcclxuICAgIGNvbnN0IHRpcCA9IGF3YWl0IFRpcC5maW5kQnlJZChpZCk7XHJcbiAgICBcclxuICAgIGlmICghdGlwKSB7XHJcbiAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwNCkuanNvbih7IG1lc3NhZ2U6IFwiS2jDtG5nIHTDrG0gdGjhuqV5IG3hurlvXCIgfSk7XHJcbiAgICB9XHJcbiAgICBcclxuICAgIHRpcC5saWtlcyArPSAxO1xyXG4gICAgYXdhaXQgdGlwLnNhdmUoKTtcclxuICAgIFxyXG4gICAgcmVzLnN0YXR1cygyMDApLmpzb24oeyBsaWtlczogdGlwLmxpa2VzIH0pO1xyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKFwiTOG7l2kga2hpIHTEg25nIGxpa2U6XCIsIGVycm9yKTtcclxuICAgIHJlcy5zdGF0dXMoNTAwKS5qc29uKHsgbWVzc2FnZTogXCJM4buXaSBraGkgdMSDbmcgbGlrZVwiLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9KTtcclxuICB9XHJcbn07XHJcblxyXG4vLyBM4bqleSBjw6FjIG3hurlvIG7hu5VpIGLhuq10XHJcbmV4cG9ydCBjb25zdCBnZXRGZWF0dXJlZFRpcHMgPSBhc3luYyAocmVxLCByZXMpID0+IHtcclxuICB0cnkge1xyXG4gICAgY29uc3QgZmVhdHVyZWRUaXBzID0gYXdhaXQgVGlwLmZpbmQoeyBpc0ZlYXR1cmVkOiB0cnVlIH0pLnNvcnQoeyBkYXRlUHVibGlzaGVkOiAtMSB9KTtcclxuICAgIFxyXG4gICAgcmVzLnN0YXR1cygyMDApLmpzb24oZmVhdHVyZWRUaXBzKTtcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcihcIkzhu5dpIGtoaSBs4bqleSBt4bq5byBu4buVaSBi4bqtdDpcIiwgZXJyb3IpO1xyXG4gICAgcmVzLnN0YXR1cyg1MDApLmpzb24oeyBtZXNzYWdlOiBcIkzhu5dpIGtoaSBs4bqleSBt4bq5byBu4buVaSBi4bqtdFwiLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9KTtcclxuICB9XHJcbn07ICJdLCJtYXBwaW5ncyI6ImdRQUFBLElBQUFBLEtBQUEsR0FBQUMsc0JBQUEsQ0FBQUMsT0FBQTtBQUNBLElBQUFDLFdBQUEsR0FBQUYsc0JBQUEsQ0FBQUMsT0FBQTtBQUNBLElBQUFFLEdBQUEsR0FBQUgsc0JBQUEsQ0FBQUMsT0FBQSxRQUFvQixTQUFBRCx1QkFBQUksQ0FBQSxVQUFBQSxDQUFBLElBQUFBLENBQUEsQ0FBQUMsVUFBQSxHQUFBRCxDQUFBLEtBQUFFLE9BQUEsRUFBQUYsQ0FBQTs7QUFFcEI7QUFDTyxNQUFNRyxVQUFVLEdBQUcsTUFBQUEsQ0FBT0MsR0FBRyxFQUFFQyxHQUFHLEtBQUs7RUFDNUMsSUFBSTtJQUNGLE1BQU1DLElBQUksR0FBRyxNQUFNQyxhQUFHLENBQUNDLElBQUksQ0FBQyxDQUFDLENBQUNDLElBQUksQ0FBQyxFQUFFQyxTQUFTLEVBQUUsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDO0lBQ3JETCxHQUFHLENBQUNNLE1BQU0sQ0FBQyxHQUFHLENBQUMsQ0FBQ0MsSUFBSSxDQUFDTixJQUFJLENBQUM7RUFDNUIsQ0FBQyxDQUFDLE9BQU9PLEtBQUssRUFBRTtJQUNkQyxPQUFPLENBQUNELEtBQUssQ0FBQyw0QkFBNEIsRUFBRUEsS0FBSyxDQUFDO0lBQ2xEUixHQUFHLENBQUNNLE1BQU0sQ0FBQyxHQUFHLENBQUMsQ0FBQ0MsSUFBSSxDQUFDLEVBQUVHLE9BQU8sRUFBRSwyQkFBMkIsRUFBRUYsS0FBSyxFQUFFQSxLQUFLLENBQUNFLE9BQU8sQ0FBQyxDQUFDLENBQUM7RUFDdEY7QUFDRixDQUFDOztBQUVEO0FBQUFDLE9BQUEsQ0FBQWIsVUFBQSxHQUFBQSxVQUFBLENBQ08sTUFBTWMsVUFBVSxHQUFHLE1BQUFBLENBQU9iLEdBQUcsRUFBRUMsR0FBRyxLQUFLO0VBQzVDLElBQUk7SUFDRixNQUFNLEVBQUVhLEVBQUUsQ0FBQyxDQUFDLEdBQUdkLEdBQUcsQ0FBQ2UsTUFBTTtJQUN6QixNQUFNQyxHQUFHLEdBQUcsTUFBTWIsYUFBRyxDQUFDYyxRQUFRLENBQUNILEVBQUUsQ0FBQzs7SUFFbEMsSUFBSSxDQUFDRSxHQUFHLEVBQUU7TUFDUixPQUFPZixHQUFHLENBQUNNLE1BQU0sQ0FBQyxHQUFHLENBQUMsQ0FBQ0MsSUFBSSxDQUFDLEVBQUVHLE9BQU8sRUFBRSxvQkFBb0IsQ0FBQyxDQUFDLENBQUM7SUFDaEU7O0lBRUFWLEdBQUcsQ0FBQ00sTUFBTSxDQUFDLEdBQUcsQ0FBQyxDQUFDQyxJQUFJLENBQUNRLEdBQUcsQ0FBQztFQUMzQixDQUFDLENBQUMsT0FBT1AsS0FBSyxFQUFFO0lBQ2RDLE9BQU8sQ0FBQ0QsS0FBSyxDQUFDLDJCQUEyQixFQUFFQSxLQUFLLENBQUM7SUFDakRSLEdBQUcsQ0FBQ00sTUFBTSxDQUFDLEdBQUcsQ0FBQyxDQUFDQyxJQUFJLENBQUMsRUFBRUcsT0FBTyxFQUFFLDBCQUEwQixFQUFFRixLQUFLLEVBQUVBLEtBQUssQ0FBQ0UsT0FBTyxDQUFDLENBQUMsQ0FBQztFQUNyRjtBQUNGLENBQUM7O0FBRUQ7QUFBQUMsT0FBQSxDQUFBQyxVQUFBLEdBQUFBLFVBQUEsQ0FDTyxNQUFNSyxpQkFBaUIsR0FBRyxNQUFBQSxDQUFPbEIsR0FBRyxFQUFFQyxHQUFHLEtBQUs7RUFDbkQsSUFBSTtJQUNGLE1BQU0sRUFBRWtCLFFBQVEsQ0FBQyxDQUFDLEdBQUduQixHQUFHLENBQUNlLE1BQU07SUFDL0IsTUFBTWIsSUFBSSxHQUFHLE1BQU1DLGFBQUcsQ0FBQ0MsSUFBSSxDQUFDLEVBQUVlLFFBQVEsQ0FBQyxDQUFDLENBQUMsQ0FBQ2QsSUFBSSxDQUFDLEVBQUVDLFNBQVMsRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7O0lBRWpFTCxHQUFHLENBQUNNLE1BQU0sQ0FBQyxHQUFHLENBQUMsQ0FBQ0MsSUFBSSxDQUFDTixJQUFJLENBQUM7RUFDNUIsQ0FBQyxDQUFDLE9BQU9PLEtBQUssRUFBRTtJQUNkQyxPQUFPLENBQUNELEtBQUssQ0FBQyxnQ0FBZ0MsRUFBRUEsS0FBSyxDQUFDO0lBQ3REUixHQUFHLENBQUNNLE1BQU0sQ0FBQyxHQUFHLENBQUMsQ0FBQ0MsSUFBSSxDQUFDLEVBQUVHLE9BQU8sRUFBRSwrQkFBK0IsRUFBRUYsS0FBSyxFQUFFQSxLQUFLLENBQUNFLE9BQU8sQ0FBQyxDQUFDLENBQUM7RUFDMUY7QUFDRixDQUFDOztBQUVEO0FBQUFDLE9BQUEsQ0FBQU0saUJBQUEsR0FBQUEsaUJBQUEsQ0FDTyxNQUFNRSxTQUFTLEdBQUcsTUFBQUEsQ0FBT3BCLEdBQUcsRUFBRUMsR0FBRyxLQUFLO0VBQzNDLElBQUk7SUFDRixJQUFJb0IsUUFBUSxHQUFHLEVBQUU7O0lBRWpCO0lBQ0EsSUFBSXJCLEdBQUcsQ0FBQ3NCLElBQUksRUFBRTtNQUNaLElBQUk7UUFDRixNQUFNQyxNQUFNLEdBQUcsTUFBTUMsbUJBQVUsQ0FBQ0MsUUFBUSxDQUFDQyxNQUFNLENBQUMxQixHQUFHLENBQUNzQixJQUFJLENBQUNLLElBQUksRUFBRTtVQUM3REMsTUFBTSxFQUFFLE1BQU07VUFDZEMsYUFBYSxFQUFFO1FBQ2pCLENBQUMsQ0FBQztRQUNGUixRQUFRLEdBQUdFLE1BQU0sQ0FBQ08sVUFBVTtRQUM1QjtRQUNBQyxXQUFFLENBQUNDLFVBQVUsQ0FBQ2hDLEdBQUcsQ0FBQ3NCLElBQUksQ0FBQ0ssSUFBSSxDQUFDO01BQzlCLENBQUMsQ0FBQyxPQUFPTSxXQUFXLEVBQUU7UUFDcEJ2QixPQUFPLENBQUNELEtBQUssQ0FBQyxxQkFBcUIsRUFBRXdCLFdBQVcsQ0FBQztRQUNqRCxJQUFJRixXQUFFLENBQUNHLFVBQVUsQ0FBQ2xDLEdBQUcsQ0FBQ3NCLElBQUksQ0FBQ0ssSUFBSSxDQUFDLEVBQUU7VUFDaENJLFdBQUUsQ0FBQ0MsVUFBVSxDQUFDaEMsR0FBRyxDQUFDc0IsSUFBSSxDQUFDSyxJQUFJLENBQUM7UUFDOUI7UUFDQSxPQUFPMUIsR0FBRyxDQUFDTSxNQUFNLENBQUMsR0FBRyxDQUFDLENBQUNDLElBQUksQ0FBQyxFQUFFRyxPQUFPLEVBQUUsb0JBQW9CLEVBQUVGLEtBQUssRUFBRXdCLFdBQVcsQ0FBQ3RCLE9BQU8sQ0FBQyxDQUFDLENBQUM7TUFDNUY7SUFDRjs7SUFFQTtJQUNBLElBQUl3QixJQUFJLEdBQUcsRUFBRTtJQUNiLElBQUluQyxHQUFHLENBQUNvQyxJQUFJLENBQUNELElBQUksRUFBRTtNQUNqQixJQUFJO1FBQ0ZBLElBQUksR0FBR0UsS0FBSyxDQUFDQyxPQUFPLENBQUN0QyxHQUFHLENBQUNvQyxJQUFJLENBQUNELElBQUksQ0FBQyxHQUFHbkMsR0FBRyxDQUFDb0MsSUFBSSxDQUFDRCxJQUFJLEdBQUdJLElBQUksQ0FBQ0MsS0FBSyxDQUFDeEMsR0FBRyxDQUFDb0MsSUFBSSxDQUFDRCxJQUFJLENBQUM7TUFDakYsQ0FBQyxDQUFDLE9BQU8xQixLQUFLLEVBQUU7UUFDZDBCLElBQUksR0FBR25DLEdBQUcsQ0FBQ29DLElBQUksQ0FBQ0QsSUFBSSxDQUFDTSxLQUFLLENBQUMsR0FBRyxDQUFDLENBQUNDLEdBQUcsQ0FBQyxDQUFBQyxHQUFHLEtBQUlBLEdBQUcsQ0FBQ0MsSUFBSSxDQUFDLENBQUMsQ0FBQztNQUN4RDtJQUNGOztJQUVBO0lBQ0EsSUFBSUMsYUFBYSxHQUFHN0MsR0FBRyxDQUFDb0MsSUFBSSxDQUFDUyxhQUFhLEdBQUcsSUFBSUMsSUFBSSxDQUFDOUMsR0FBRyxDQUFDb0MsSUFBSSxDQUFDUyxhQUFhLENBQUMsR0FBRyxJQUFJQyxJQUFJLENBQUMsQ0FBQzs7SUFFMUYsTUFBTUMsTUFBTSxHQUFHLElBQUk1QyxhQUFHLENBQUM7TUFDckI2QyxLQUFLLEVBQUVoRCxHQUFHLENBQUNvQyxJQUFJLENBQUNZLEtBQUs7TUFDckI3QixRQUFRLEVBQUVuQixHQUFHLENBQUNvQyxJQUFJLENBQUNqQixRQUFRO01BQzNCOEIsS0FBSyxFQUFFNUIsUUFBUSxJQUFJckIsR0FBRyxDQUFDb0MsSUFBSSxDQUFDYSxLQUFLO01BQ2pDQyxPQUFPLEVBQUVsRCxHQUFHLENBQUNvQyxJQUFJLENBQUNjLE9BQU87TUFDekJDLE1BQU0sRUFBRW5ELEdBQUcsQ0FBQ29DLElBQUksQ0FBQ2UsTUFBTTtNQUN2QkMsV0FBVyxFQUFFcEQsR0FBRyxDQUFDb0MsSUFBSSxDQUFDZ0IsV0FBVztNQUNqQ2pCLElBQUksRUFBRUEsSUFBSTtNQUNWa0IsS0FBSyxFQUFFckQsR0FBRyxDQUFDb0MsSUFBSSxDQUFDaUIsS0FBSyxJQUFJLENBQUM7TUFDMUJSLGFBQWEsRUFBRUEsYUFBYTtNQUM1QlMsVUFBVSxFQUFFdEQsR0FBRyxDQUFDb0MsSUFBSSxDQUFDa0IsVUFBVSxLQUFLO0lBQ3RDLENBQUMsQ0FBQzs7SUFFRixNQUFNQyxRQUFRLEdBQUcsTUFBTVIsTUFBTSxDQUFDUyxJQUFJLENBQUMsQ0FBQztJQUNwQ3ZELEdBQUcsQ0FBQ00sTUFBTSxDQUFDLEdBQUcsQ0FBQyxDQUFDQyxJQUFJLENBQUMrQyxRQUFRLENBQUM7RUFDaEMsQ0FBQyxDQUFDLE9BQU85QyxLQUFLLEVBQUU7SUFDZEMsT0FBTyxDQUFDRCxLQUFLLENBQUMsc0JBQXNCLEVBQUVBLEtBQUssQ0FBQztJQUM1QztJQUNBLElBQUlULEdBQUcsQ0FBQ3NCLElBQUksSUFBSVMsV0FBRSxDQUFDRyxVQUFVLENBQUNsQyxHQUFHLENBQUNzQixJQUFJLENBQUNLLElBQUksQ0FBQyxFQUFFO01BQzVDSSxXQUFFLENBQUNDLFVBQVUsQ0FBQ2hDLEdBQUcsQ0FBQ3NCLElBQUksQ0FBQ0ssSUFBSSxDQUFDO0lBQzlCO0lBQ0ExQixHQUFHLENBQUNNLE1BQU0sQ0FBQyxHQUFHLENBQUMsQ0FBQ0MsSUFBSSxDQUFDLEVBQUVHLE9BQU8sRUFBRSxxQkFBcUIsRUFBRUYsS0FBSyxFQUFFQSxLQUFLLENBQUNFLE9BQU8sQ0FBQyxDQUFDLENBQUM7RUFDaEY7QUFDRixDQUFDOztBQUVEO0FBQUFDLE9BQUEsQ0FBQVEsU0FBQSxHQUFBQSxTQUFBLENBQ08sTUFBTXFDLFNBQVMsR0FBRyxNQUFBQSxDQUFPekQsR0FBRyxFQUFFQyxHQUFHLEtBQUs7RUFDM0MsSUFBSTtJQUNGLE1BQU0sRUFBRWEsRUFBRSxDQUFDLENBQUMsR0FBR2QsR0FBRyxDQUFDZSxNQUFNOztJQUV6QjtJQUNBLE1BQU0yQyxXQUFXLEdBQUcsTUFBTXZELGFBQUcsQ0FBQ2MsUUFBUSxDQUFDSCxFQUFFLENBQUM7SUFDMUMsSUFBSSxDQUFDNEMsV0FBVyxFQUFFO01BQ2hCLE9BQU96RCxHQUFHLENBQUNNLE1BQU0sQ0FBQyxHQUFHLENBQUMsQ0FBQ0MsSUFBSSxDQUFDLEVBQUVHLE9BQU8sRUFBRSxvQkFBb0IsQ0FBQyxDQUFDLENBQUM7SUFDaEU7O0lBRUE7SUFDQSxJQUFJVSxRQUFRLEdBQUdxQyxXQUFXLENBQUNULEtBQUs7SUFDaEMsSUFBSWpELEdBQUcsQ0FBQ3NCLElBQUksRUFBRTtNQUNaLElBQUk7UUFDRixNQUFNQyxNQUFNLEdBQUcsTUFBTUMsbUJBQVUsQ0FBQ0MsUUFBUSxDQUFDQyxNQUFNLENBQUMxQixHQUFHLENBQUNzQixJQUFJLENBQUNLLElBQUksRUFBRTtVQUM3REMsTUFBTSxFQUFFLE1BQU07VUFDZEMsYUFBYSxFQUFFO1FBQ2pCLENBQUMsQ0FBQztRQUNGUixRQUFRLEdBQUdFLE1BQU0sQ0FBQ08sVUFBVTtRQUM1QjtRQUNBQyxXQUFFLENBQUNDLFVBQVUsQ0FBQ2hDLEdBQUcsQ0FBQ3NCLElBQUksQ0FBQ0ssSUFBSSxDQUFDO01BQzlCLENBQUMsQ0FBQyxPQUFPTSxXQUFXLEVBQUU7UUFDcEJ2QixPQUFPLENBQUNELEtBQUssQ0FBQyxxQkFBcUIsRUFBRXdCLFdBQVcsQ0FBQztRQUNqRCxJQUFJRixXQUFFLENBQUNHLFVBQVUsQ0FBQ2xDLEdBQUcsQ0FBQ3NCLElBQUksQ0FBQ0ssSUFBSSxDQUFDLEVBQUU7VUFDaENJLFdBQUUsQ0FBQ0MsVUFBVSxDQUFDaEMsR0FBRyxDQUFDc0IsSUFBSSxDQUFDSyxJQUFJLENBQUM7UUFDOUI7UUFDQSxPQUFPMUIsR0FBRyxDQUFDTSxNQUFNLENBQUMsR0FBRyxDQUFDLENBQUNDLElBQUksQ0FBQyxFQUFFRyxPQUFPLEVBQUUsb0JBQW9CLEVBQUVGLEtBQUssRUFBRXdCLFdBQVcsQ0FBQ3RCLE9BQU8sQ0FBQyxDQUFDLENBQUM7TUFDNUY7SUFDRixDQUFDLE1BQU0sSUFBSVgsR0FBRyxDQUFDb0MsSUFBSSxDQUFDYSxLQUFLLEVBQUU7TUFDekI7TUFDQTVCLFFBQVEsR0FBR3JCLEdBQUcsQ0FBQ29DLElBQUksQ0FBQ2EsS0FBSztJQUMzQjs7SUFFQTtJQUNBLElBQUlkLElBQUksR0FBR3VCLFdBQVcsQ0FBQ3ZCLElBQUk7SUFDM0IsSUFBSW5DLEdBQUcsQ0FBQ29DLElBQUksQ0FBQ0QsSUFBSSxFQUFFO01BQ2pCLElBQUk7UUFDRkEsSUFBSSxHQUFHRSxLQUFLLENBQUNDLE9BQU8sQ0FBQ3RDLEdBQUcsQ0FBQ29DLElBQUksQ0FBQ0QsSUFBSSxDQUFDLEdBQUduQyxHQUFHLENBQUNvQyxJQUFJLENBQUNELElBQUksR0FBR0ksSUFBSSxDQUFDQyxLQUFLLENBQUN4QyxHQUFHLENBQUNvQyxJQUFJLENBQUNELElBQUksQ0FBQztNQUNqRixDQUFDLENBQUMsT0FBTzFCLEtBQUssRUFBRTtRQUNkMEIsSUFBSSxHQUFHbkMsR0FBRyxDQUFDb0MsSUFBSSxDQUFDRCxJQUFJLENBQUNNLEtBQUssQ0FBQyxHQUFHLENBQUMsQ0FBQ0MsR0FBRyxDQUFDLENBQUFDLEdBQUcsS0FBSUEsR0FBRyxDQUFDQyxJQUFJLENBQUMsQ0FBQyxDQUFDO01BQ3hEO0lBQ0Y7O0lBRUE7SUFDQSxJQUFJQyxhQUFhLEdBQUdhLFdBQVcsQ0FBQ2IsYUFBYTtJQUM3QyxJQUFJN0MsR0FBRyxDQUFDb0MsSUFBSSxDQUFDUyxhQUFhLEVBQUU7TUFDMUJBLGFBQWEsR0FBRyxJQUFJQyxJQUFJLENBQUM5QyxHQUFHLENBQUNvQyxJQUFJLENBQUNTLGFBQWEsQ0FBQztJQUNsRDs7SUFFQSxNQUFNYyxVQUFVLEdBQUcsTUFBTXhELGFBQUcsQ0FBQ3lELGlCQUFpQjtNQUM1QzlDLEVBQUU7TUFDRjtRQUNFa0MsS0FBSyxFQUFFaEQsR0FBRyxDQUFDb0MsSUFBSSxDQUFDWSxLQUFLLElBQUlVLFdBQVcsQ0FBQ1YsS0FBSztRQUMxQzdCLFFBQVEsRUFBRW5CLEdBQUcsQ0FBQ29DLElBQUksQ0FBQ2pCLFFBQVEsSUFBSXVDLFdBQVcsQ0FBQ3ZDLFFBQVE7UUFDbkQ4QixLQUFLLEVBQUU1QixRQUFRO1FBQ2Y2QixPQUFPLEVBQUVsRCxHQUFHLENBQUNvQyxJQUFJLENBQUNjLE9BQU8sSUFBSVEsV0FBVyxDQUFDUixPQUFPO1FBQ2hEQyxNQUFNLEVBQUVuRCxHQUFHLENBQUNvQyxJQUFJLENBQUNlLE1BQU0sSUFBSU8sV0FBVyxDQUFDUCxNQUFNO1FBQzdDQyxXQUFXLEVBQUVwRCxHQUFHLENBQUNvQyxJQUFJLENBQUNnQixXQUFXLElBQUlNLFdBQVcsQ0FBQ04sV0FBVztRQUM1RGpCLElBQUksRUFBRUEsSUFBSTtRQUNWa0IsS0FBSyxFQUFFckQsR0FBRyxDQUFDb0MsSUFBSSxDQUFDaUIsS0FBSyxLQUFLUSxTQUFTLEdBQUc3RCxHQUFHLENBQUNvQyxJQUFJLENBQUNpQixLQUFLLEdBQUdLLFdBQVcsQ0FBQ0wsS0FBSztRQUN4RVIsYUFBYSxFQUFFQSxhQUFhO1FBQzVCUyxVQUFVLEVBQUV0RCxHQUFHLENBQUNvQyxJQUFJLENBQUNrQixVQUFVLEtBQUtPLFNBQVM7UUFDM0M3RCxHQUFHLENBQUNvQyxJQUFJLENBQUNrQixVQUFVLEtBQUssTUFBTSxJQUFJdEQsR0FBRyxDQUFDb0MsSUFBSSxDQUFDa0IsVUFBVSxLQUFLLElBQUk7UUFDOURJLFdBQVcsQ0FBQ0o7TUFDaEIsQ0FBQztNQUNELEVBQUVRLEdBQUcsRUFBRSxJQUFJLENBQUM7SUFDZCxDQUFDOztJQUVEN0QsR0FBRyxDQUFDTSxNQUFNLENBQUMsR0FBRyxDQUFDLENBQUNDLElBQUksQ0FBQ21ELFVBQVUsQ0FBQztFQUNsQyxDQUFDLENBQUMsT0FBT2xELEtBQUssRUFBRTtJQUNkQyxPQUFPLENBQUNELEtBQUssQ0FBQyx1QkFBdUIsRUFBRUEsS0FBSyxDQUFDO0lBQzdDO0lBQ0EsSUFBSVQsR0FBRyxDQUFDc0IsSUFBSSxJQUFJUyxXQUFFLENBQUNHLFVBQVUsQ0FBQ2xDLEdBQUcsQ0FBQ3NCLElBQUksQ0FBQ0ssSUFBSSxDQUFDLEVBQUU7TUFDNUNJLFdBQUUsQ0FBQ0MsVUFBVSxDQUFDaEMsR0FBRyxDQUFDc0IsSUFBSSxDQUFDSyxJQUFJLENBQUM7SUFDOUI7SUFDQTFCLEdBQUcsQ0FBQ00sTUFBTSxDQUFDLEdBQUcsQ0FBQyxDQUFDQyxJQUFJLENBQUMsRUFBRUcsT0FBTyxFQUFFLHNCQUFzQixFQUFFRixLQUFLLEVBQUVBLEtBQUssQ0FBQ0UsT0FBTyxDQUFDLENBQUMsQ0FBQztFQUNqRjtBQUNGLENBQUM7O0FBRUQ7QUFBQUMsT0FBQSxDQUFBNkMsU0FBQSxHQUFBQSxTQUFBLENBQ08sTUFBTU0sU0FBUyxHQUFHLE1BQUFBLENBQU8vRCxHQUFHLEVBQUVDLEdBQUcsS0FBSztFQUMzQyxJQUFJO0lBQ0YsTUFBTSxFQUFFYSxFQUFFLENBQUMsQ0FBQyxHQUFHZCxHQUFHLENBQUNlLE1BQU07O0lBRXpCLE1BQU1DLEdBQUcsR0FBRyxNQUFNYixhQUFHLENBQUM2RCxpQkFBaUIsQ0FBQ2xELEVBQUUsQ0FBQzs7SUFFM0MsSUFBSSxDQUFDRSxHQUFHLEVBQUU7TUFDUixPQUFPZixHQUFHLENBQUNNLE1BQU0sQ0FBQyxHQUFHLENBQUMsQ0FBQ0MsSUFBSSxDQUFDLEVBQUVHLE9BQU8sRUFBRSxvQkFBb0IsQ0FBQyxDQUFDLENBQUM7SUFDaEU7O0lBRUFWLEdBQUcsQ0FBQ00sTUFBTSxDQUFDLEdBQUcsQ0FBQyxDQUFDQyxJQUFJLENBQUMsRUFBRUcsT0FBTyxFQUFFLG9CQUFvQixDQUFDLENBQUMsQ0FBQztFQUN6RCxDQUFDLENBQUMsT0FBT0YsS0FBSyxFQUFFO0lBQ2RDLE9BQU8sQ0FBQ0QsS0FBSyxDQUFDLGtCQUFrQixFQUFFQSxLQUFLLENBQUM7SUFDeENSLEdBQUcsQ0FBQ00sTUFBTSxDQUFDLEdBQUcsQ0FBQyxDQUFDQyxJQUFJLENBQUMsRUFBRUcsT0FBTyxFQUFFLGlCQUFpQixFQUFFRixLQUFLLEVBQUVBLEtBQUssQ0FBQ0UsT0FBTyxDQUFDLENBQUMsQ0FBQztFQUM1RTtBQUNGLENBQUM7O0FBRUQ7QUFBQUMsT0FBQSxDQUFBbUQsU0FBQSxHQUFBQSxTQUFBLENBQ08sTUFBTUUsT0FBTyxHQUFHLE1BQUFBLENBQU9qRSxHQUFHLEVBQUVDLEdBQUcsS0FBSztFQUN6QyxJQUFJO0lBQ0YsTUFBTSxFQUFFYSxFQUFFLENBQUMsQ0FBQyxHQUFHZCxHQUFHLENBQUNlLE1BQU07O0lBRXpCLE1BQU1DLEdBQUcsR0FBRyxNQUFNYixhQUFHLENBQUNjLFFBQVEsQ0FBQ0gsRUFBRSxDQUFDOztJQUVsQyxJQUFJLENBQUNFLEdBQUcsRUFBRTtNQUNSLE9BQU9mLEdBQUcsQ0FBQ00sTUFBTSxDQUFDLEdBQUcsQ0FBQyxDQUFDQyxJQUFJLENBQUMsRUFBRUcsT0FBTyxFQUFFLG9CQUFvQixDQUFDLENBQUMsQ0FBQztJQUNoRTs7SUFFQUssR0FBRyxDQUFDcUMsS0FBSyxJQUFJLENBQUM7SUFDZCxNQUFNckMsR0FBRyxDQUFDd0MsSUFBSSxDQUFDLENBQUM7O0lBRWhCdkQsR0FBRyxDQUFDTSxNQUFNLENBQUMsR0FBRyxDQUFDLENBQUNDLElBQUksQ0FBQyxFQUFFNkMsS0FBSyxFQUFFckMsR0FBRyxDQUFDcUMsS0FBSyxDQUFDLENBQUMsQ0FBQztFQUM1QyxDQUFDLENBQUMsT0FBTzVDLEtBQUssRUFBRTtJQUNkQyxPQUFPLENBQUNELEtBQUssQ0FBQyxvQkFBb0IsRUFBRUEsS0FBSyxDQUFDO0lBQzFDUixHQUFHLENBQUNNLE1BQU0sQ0FBQyxHQUFHLENBQUMsQ0FBQ0MsSUFBSSxDQUFDLEVBQUVHLE9BQU8sRUFBRSxtQkFBbUIsRUFBRUYsS0FBSyxFQUFFQSxLQUFLLENBQUNFLE9BQU8sQ0FBQyxDQUFDLENBQUM7RUFDOUU7QUFDRixDQUFDOztBQUVEO0FBQUFDLE9BQUEsQ0FBQXFELE9BQUEsR0FBQUEsT0FBQSxDQUNPLE1BQU1DLGVBQWUsR0FBRyxNQUFBQSxDQUFPbEUsR0FBRyxFQUFFQyxHQUFHLEtBQUs7RUFDakQsSUFBSTtJQUNGLE1BQU1rRSxZQUFZLEdBQUcsTUFBTWhFLGFBQUcsQ0FBQ0MsSUFBSSxDQUFDLEVBQUVrRCxVQUFVLEVBQUUsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDakQsSUFBSSxDQUFDLEVBQUV3QyxhQUFhLEVBQUUsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDOztJQUVyRjVDLEdBQUcsQ0FBQ00sTUFBTSxDQUFDLEdBQUcsQ0FBQyxDQUFDQyxJQUFJLENBQUMyRCxZQUFZLENBQUM7RUFDcEMsQ0FBQyxDQUFDLE9BQU8xRCxLQUFLLEVBQUU7SUFDZEMsT0FBTyxDQUFDRCxLQUFLLENBQUMsMEJBQTBCLEVBQUVBLEtBQUssQ0FBQztJQUNoRFIsR0FBRyxDQUFDTSxNQUFNLENBQUMsR0FBRyxDQUFDLENBQUNDLElBQUksQ0FBQyxFQUFFRyxPQUFPLEVBQUUseUJBQXlCLEVBQUVGLEtBQUssRUFBRUEsS0FBSyxDQUFDRSxPQUFPLENBQUMsQ0FBQyxDQUFDO0VBQ3BGO0FBQ0YsQ0FBQyxDQUFDQyxPQUFBLENBQUFzRCxlQUFBLEdBQUFBLGVBQUEiLCJpZ25vcmVMaXN0IjpbXX0=