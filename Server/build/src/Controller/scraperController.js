"use strict";Object.defineProperty(exports, "__esModule", { value: true });exports.scrapeWebsite = void 0;var _puppeteer = _interopRequireDefault(require("puppeteer"));function _interopRequireDefault(e) {return e && e.__esModule ? e : { default: e };}

const scrapeWebsite = async (req, res) => {
  const url = req.query.url;
  if (!url) return res.status(400).json({ error: "Thiếu URL" });

  try {
    const browser = await _puppeteer.default.launch({ headless: true });
    const page = await browser.newPage();
    await page.goto(url, { waitUntil: "domcontentloaded" });

    const title = await page.
    $eval("meta[property='og:title']", (el) => el.content).
    catch(() => "Không có tiêu đề");
    const image = await page.
    $eval("meta[property='og:image']", (el) => el.content).
    catch(() => "");
    const description = await page.
    $eval("meta[property='og:description']", (el) => el.content).
    catch(() => "Không có mô tả");

    await browser.close();

    res.json({ title, image, description });
  } catch (error) {
    res.status(500).json({ error: "Lỗi khi lấy dữ liệu" });
  }
};exports.scrapeWebsite = scrapeWebsite;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfcHVwcGV0ZWVyIiwiX2ludGVyb3BSZXF1aXJlRGVmYXVsdCIsInJlcXVpcmUiLCJlIiwiX19lc01vZHVsZSIsImRlZmF1bHQiLCJzY3JhcGVXZWJzaXRlIiwicmVxIiwicmVzIiwidXJsIiwicXVlcnkiLCJzdGF0dXMiLCJqc29uIiwiZXJyb3IiLCJicm93c2VyIiwicHVwcGV0ZWVyIiwibGF1bmNoIiwiaGVhZGxlc3MiLCJwYWdlIiwibmV3UGFnZSIsImdvdG8iLCJ3YWl0VW50aWwiLCJ0aXRsZSIsIiRldmFsIiwiZWwiLCJjb250ZW50IiwiY2F0Y2giLCJpbWFnZSIsImRlc2NyaXB0aW9uIiwiY2xvc2UiLCJleHBvcnRzIl0sInNvdXJjZXMiOlsiLi4vLi4vLi4vc3JjL0NvbnRyb2xsZXIvc2NyYXBlckNvbnRyb2xsZXIuanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHB1cHBldGVlciBmcm9tIFwicHVwcGV0ZWVyXCI7XHJcblxyXG5leHBvcnQgY29uc3Qgc2NyYXBlV2Vic2l0ZSA9IGFzeW5jIChyZXEsIHJlcykgPT4ge1xyXG4gIGNvbnN0IHVybCA9IHJlcS5xdWVyeS51cmw7XHJcbiAgaWYgKCF1cmwpIHJldHVybiByZXMuc3RhdHVzKDQwMCkuanNvbih7IGVycm9yOiBcIlRoaeG6v3UgVVJMXCIgfSk7XHJcblxyXG4gIHRyeSB7XHJcbiAgICBjb25zdCBicm93c2VyID0gYXdhaXQgcHVwcGV0ZWVyLmxhdW5jaCh7IGhlYWRsZXNzOiB0cnVlIH0pO1xyXG4gICAgY29uc3QgcGFnZSA9IGF3YWl0IGJyb3dzZXIubmV3UGFnZSgpO1xyXG4gICAgYXdhaXQgcGFnZS5nb3RvKHVybCwgeyB3YWl0VW50aWw6IFwiZG9tY29udGVudGxvYWRlZFwiIH0pO1xyXG5cclxuICAgIGNvbnN0IHRpdGxlID0gYXdhaXQgcGFnZVxyXG4gICAgICAuJGV2YWwoXCJtZXRhW3Byb3BlcnR5PSdvZzp0aXRsZSddXCIsIChlbCkgPT4gZWwuY29udGVudClcclxuICAgICAgLmNhdGNoKCgpID0+IFwiS2jDtG5nIGPDsyB0acOqdSDEkeG7gVwiKTtcclxuICAgIGNvbnN0IGltYWdlID0gYXdhaXQgcGFnZVxyXG4gICAgICAuJGV2YWwoXCJtZXRhW3Byb3BlcnR5PSdvZzppbWFnZSddXCIsIChlbCkgPT4gZWwuY29udGVudClcclxuICAgICAgLmNhdGNoKCgpID0+IFwiXCIpO1xyXG4gICAgY29uc3QgZGVzY3JpcHRpb24gPSBhd2FpdCBwYWdlXHJcbiAgICAgIC4kZXZhbChcIm1ldGFbcHJvcGVydHk9J29nOmRlc2NyaXB0aW9uJ11cIiwgKGVsKSA9PiBlbC5jb250ZW50KVxyXG4gICAgICAuY2F0Y2goKCkgPT4gXCJLaMO0bmcgY8OzIG3DtCB04bqjXCIpO1xyXG5cclxuICAgIGF3YWl0IGJyb3dzZXIuY2xvc2UoKTtcclxuXHJcbiAgICByZXMuanNvbih7IHRpdGxlLCBpbWFnZSwgZGVzY3JpcHRpb24gfSk7XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIHJlcy5zdGF0dXMoNTAwKS5qc29uKHsgZXJyb3I6IFwiTOG7l2kga2hpIGzhuqV5IGThu68gbGnhu4d1XCIgfSk7XHJcbiAgfVxyXG59O1xyXG4iXSwibWFwcGluZ3MiOiIwR0FBQSxJQUFBQSxVQUFBLEdBQUFDLHNCQUFBLENBQUFDLE9BQUEsZUFBa0MsU0FBQUQsdUJBQUFFLENBQUEsVUFBQUEsQ0FBQSxJQUFBQSxDQUFBLENBQUFDLFVBQUEsR0FBQUQsQ0FBQSxLQUFBRSxPQUFBLEVBQUFGLENBQUE7O0FBRTNCLE1BQU1HLGFBQWEsR0FBRyxNQUFBQSxDQUFPQyxHQUFHLEVBQUVDLEdBQUcsS0FBSztFQUMvQyxNQUFNQyxHQUFHLEdBQUdGLEdBQUcsQ0FBQ0csS0FBSyxDQUFDRCxHQUFHO0VBQ3pCLElBQUksQ0FBQ0EsR0FBRyxFQUFFLE9BQU9ELEdBQUcsQ0FBQ0csTUFBTSxDQUFDLEdBQUcsQ0FBQyxDQUFDQyxJQUFJLENBQUMsRUFBRUMsS0FBSyxFQUFFLFdBQVcsQ0FBQyxDQUFDLENBQUM7O0VBRTdELElBQUk7SUFDRixNQUFNQyxPQUFPLEdBQUcsTUFBTUMsa0JBQVMsQ0FBQ0MsTUFBTSxDQUFDLEVBQUVDLFFBQVEsRUFBRSxJQUFJLENBQUMsQ0FBQyxDQUFDO0lBQzFELE1BQU1DLElBQUksR0FBRyxNQUFNSixPQUFPLENBQUNLLE9BQU8sQ0FBQyxDQUFDO0lBQ3BDLE1BQU1ELElBQUksQ0FBQ0UsSUFBSSxDQUFDWCxHQUFHLEVBQUUsRUFBRVksU0FBUyxFQUFFLGtCQUFrQixDQUFDLENBQUMsQ0FBQzs7SUFFdkQsTUFBTUMsS0FBSyxHQUFHLE1BQU1KLElBQUk7SUFDckJLLEtBQUssQ0FBQywyQkFBMkIsRUFBRSxDQUFDQyxFQUFFLEtBQUtBLEVBQUUsQ0FBQ0MsT0FBTyxDQUFDO0lBQ3REQyxLQUFLLENBQUMsTUFBTSxrQkFBa0IsQ0FBQztJQUNsQyxNQUFNQyxLQUFLLEdBQUcsTUFBTVQsSUFBSTtJQUNyQkssS0FBSyxDQUFDLDJCQUEyQixFQUFFLENBQUNDLEVBQUUsS0FBS0EsRUFBRSxDQUFDQyxPQUFPLENBQUM7SUFDdERDLEtBQUssQ0FBQyxNQUFNLEVBQUUsQ0FBQztJQUNsQixNQUFNRSxXQUFXLEdBQUcsTUFBTVYsSUFBSTtJQUMzQkssS0FBSyxDQUFDLGlDQUFpQyxFQUFFLENBQUNDLEVBQUUsS0FBS0EsRUFBRSxDQUFDQyxPQUFPLENBQUM7SUFDNURDLEtBQUssQ0FBQyxNQUFNLGdCQUFnQixDQUFDOztJQUVoQyxNQUFNWixPQUFPLENBQUNlLEtBQUssQ0FBQyxDQUFDOztJQUVyQnJCLEdBQUcsQ0FBQ0ksSUFBSSxDQUFDLEVBQUVVLEtBQUssRUFBRUssS0FBSyxFQUFFQyxXQUFXLENBQUMsQ0FBQyxDQUFDO0VBQ3pDLENBQUMsQ0FBQyxPQUFPZixLQUFLLEVBQUU7SUFDZEwsR0FBRyxDQUFDRyxNQUFNLENBQUMsR0FBRyxDQUFDLENBQUNDLElBQUksQ0FBQyxFQUFFQyxLQUFLLEVBQUUscUJBQXFCLENBQUMsQ0FBQyxDQUFDO0VBQ3hEO0FBQ0YsQ0FBQyxDQUFDaUIsT0FBQSxDQUFBeEIsYUFBQSxHQUFBQSxhQUFBIiwiaWdub3JlTGlzdCI6W119