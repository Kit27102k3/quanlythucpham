"use strict";var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(exports, "__esModule", { value: true });exports.default = exports.customerLogController = void 0;var _CustomerLog = _interopRequireDefault(require("../Model/CustomerLog.js"));

/**
 * Controller for customer log operations
 */
const customerLogController = exports.customerLogController = {
  /**
   * Get all logs with pagination and filtering
   * @param {Object} req - Request object
   * @param {Object} res - Response object
   */
  getAllLogs: async (req, res) => {
    try {
      const {
        page = 1,
        limit = 20,
        action,
        status,
        startDate,
        endDate,
        customerId,
        customerEmail,
        sort = 'timestamp',
        order = -1
      } = req.query;

      // Build filter
      const filter = {};

      if (action) filter.action = action;
      if (status) filter.status = status;
      if (customerId) filter.customerId = customerId;
      if (customerEmail) filter.customerEmail = { $regex: customerEmail, $options: 'i' };

      // Date range filter
      if (startDate || endDate) {
        filter.timestamp = {};
        if (startDate) filter.timestamp.$gte = new Date(startDate);
        if (endDate) filter.timestamp.$lte = new Date(endDate);
      }

      // Calculate pagination
      const skip = (parseInt(page) - 1) * parseInt(limit);

      // Sort options
      const sortOptions = {};
      sortOptions[sort] = parseInt(order);

      // Get logs
      const logs = await _CustomerLog.default.find(filter).
      sort(sortOptions).
      skip(skip).
      limit(parseInt(limit)).
      exec();

      // Get total count for pagination
      const total = await _CustomerLog.default.countDocuments(filter);

      return res.status(200).json({
        success: true,
        data: logs,
        pagination: {
          total,
          page: parseInt(page),
          limit: parseInt(limit),
          pages: Math.ceil(total / parseInt(limit))
        }
      });
    } catch (error) {
      console.error('Error getting logs:', error);
      return res.status(500).json({
        success: false,
        message: 'Error retrieving logs',
        error: error.message
      });
    }
  },

  /**
   * Get logs for a specific customer
   * @param {Object} req - Request object
   * @param {Object} res - Response object
   */
  getCustomerLogs: async (req, res) => {
    try {
      const { customerId } = req.params;
      const { page = 1, limit = 20, action, status } = req.query;

      // Build filter
      const filter = { customerId };
      if (action) filter.action = action;
      if (status) filter.status = status;

      // Calculate pagination
      const skip = (parseInt(page) - 1) * parseInt(limit);

      // Get logs
      const logs = await _CustomerLog.default.find(filter).
      sort({ timestamp: -1 }).
      skip(skip).
      limit(parseInt(limit)).
      exec();

      // Get total count for pagination
      const total = await _CustomerLog.default.countDocuments(filter);

      return res.status(200).json({
        success: true,
        data: logs,
        pagination: {
          total,
          page: parseInt(page),
          limit: parseInt(limit),
          pages: Math.ceil(total / parseInt(limit))
        }
      });
    } catch (error) {
      console.error('Error getting customer logs:', error);
      return res.status(500).json({
        success: false,
        message: 'Error retrieving customer logs',
        error: error.message
      });
    }
  },

  /**
   * Get logs by action type
   * @param {Object} req - Request object
   * @param {Object} res - Response object
   */
  getLogsByAction: async (req, res) => {
    try {
      const { action } = req.params;
      const { page = 1, limit = 20, status } = req.query;

      // Build filter
      const filter = { action };
      if (status) filter.status = status;

      // Calculate pagination
      const skip = (parseInt(page) - 1) * parseInt(limit);

      // Get logs
      const logs = await _CustomerLog.default.find(filter).
      sort({ timestamp: -1 }).
      skip(skip).
      limit(parseInt(limit)).
      exec();

      // Get total count for pagination
      const total = await _CustomerLog.default.countDocuments(filter);

      return res.status(200).json({
        success: true,
        data: logs,
        pagination: {
          total,
          page: parseInt(page),
          limit: parseInt(limit),
          pages: Math.ceil(total / parseInt(limit))
        }
      });
    } catch (error) {
      console.error('Error getting logs by action:', error);
      return res.status(500).json({
        success: false,
        message: 'Error retrieving logs by action',
        error: error.message
      });
    }
  },

  /**
   * Get logs by status
   * @param {Object} req - Request object
   * @param {Object} res - Response object
   */
  getLogsByStatus: async (req, res) => {
    try {
      const { status } = req.params;
      const { page = 1, limit = 20, action } = req.query;

      // Build filter
      const filter = { status };
      if (action) filter.action = action;

      // Calculate pagination
      const skip = (parseInt(page) - 1) * parseInt(limit);

      // Get logs
      const logs = await _CustomerLog.default.find(filter).
      sort({ timestamp: -1 }).
      skip(skip).
      limit(parseInt(limit)).
      exec();

      // Get total count for pagination
      const total = await _CustomerLog.default.countDocuments(filter);

      return res.status(200).json({
        success: true,
        data: logs,
        pagination: {
          total,
          page: parseInt(page),
          limit: parseInt(limit),
          pages: Math.ceil(total / parseInt(limit))
        }
      });
    } catch (error) {
      console.error('Error getting logs by status:', error);
      return res.status(500).json({
        success: false,
        message: 'Error retrieving logs by status',
        error: error.message
      });
    }
  },

  /**
   * Get log statistics
   * @param {Object} req - Request object
   * @param {Object} res - Response object
   */
  getLogStats: async (req, res) => {
    try {
      const { startDate, endDate } = req.query;

      // Date range filter
      const dateFilter = {};
      if (startDate || endDate) {
        dateFilter.timestamp = {};
        if (startDate) dateFilter.timestamp.$gte = new Date(startDate);
        if (endDate) dateFilter.timestamp.$lte = new Date(endDate);
      }

      // Get statistics
      const stats = await Promise.all([
      // Total logs
      _CustomerLog.default.countDocuments(dateFilter),

      // Logs by action
      _CustomerLog.default.aggregate([
      { $match: dateFilter },
      { $group: { _id: '$action', count: { $sum: 1 } } },
      { $sort: { count: -1 } }]
      ),

      // Logs by status
      _CustomerLog.default.aggregate([
      { $match: dateFilter },
      { $group: { _id: '$status', count: { $sum: 1 } } },
      { $sort: { count: -1 } }]
      ),

      // Failed login attempts
      _CustomerLog.default.countDocuments({
        ...dateFilter,
        action: 'login',
        status: 'failed'
      }),

      // Successful logins
      _CustomerLog.default.countDocuments({
        ...dateFilter,
        action: 'login',
        status: 'success'
      })]
      );

      return res.status(200).json({
        success: true,
        data: {
          total: stats[0],
          byAction: stats[1],
          byStatus: stats[2],
          failedLogins: stats[3],
          successfulLogins: stats[4]
        }
      });
    } catch (error) {
      console.error('Error getting log statistics:', error);
      return res.status(500).json({
        success: false,
        message: 'Error retrieving log statistics',
        error: error.message
      });
    }
  },

  /**
   * Delete logs older than a certain date
   * @param {Object} req - Request object
   * @param {Object} res - Response object
   */
  deleteOldLogs: async (req, res) => {
    try {
      const { olderThan } = req.body;

      if (!olderThan) {
        return res.status(400).json({
          success: false,
          message: 'Missing olderThan parameter'
        });
      }

      const date = new Date(olderThan);

      if (isNaN(date.getTime())) {
        return res.status(400).json({
          success: false,
          message: 'Invalid date format'
        });
      }

      const result = await _CustomerLog.default.deleteMany({
        timestamp: { $lt: date }
      });

      return res.status(200).json({
        success: true,
        message: `Deleted ${result.deletedCount} logs older than ${date.toISOString()}`,
        deletedCount: result.deletedCount
      });
    } catch (error) {
      console.error('Error deleting old logs:', error);
      return res.status(500).json({
        success: false,
        message: 'Error deleting old logs',
        error: error.message
      });
    }
  }
};var _default = exports.default =

customerLogController;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfQ3VzdG9tZXJMb2ciLCJfaW50ZXJvcFJlcXVpcmVEZWZhdWx0IiwicmVxdWlyZSIsImN1c3RvbWVyTG9nQ29udHJvbGxlciIsImV4cG9ydHMiLCJnZXRBbGxMb2dzIiwicmVxIiwicmVzIiwicGFnZSIsImxpbWl0IiwiYWN0aW9uIiwic3RhdHVzIiwic3RhcnREYXRlIiwiZW5kRGF0ZSIsImN1c3RvbWVySWQiLCJjdXN0b21lckVtYWlsIiwic29ydCIsIm9yZGVyIiwicXVlcnkiLCJmaWx0ZXIiLCIkcmVnZXgiLCIkb3B0aW9ucyIsInRpbWVzdGFtcCIsIiRndGUiLCJEYXRlIiwiJGx0ZSIsInNraXAiLCJwYXJzZUludCIsInNvcnRPcHRpb25zIiwibG9ncyIsIkN1c3RvbWVyTG9nIiwiZmluZCIsImV4ZWMiLCJ0b3RhbCIsImNvdW50RG9jdW1lbnRzIiwianNvbiIsInN1Y2Nlc3MiLCJkYXRhIiwicGFnaW5hdGlvbiIsInBhZ2VzIiwiTWF0aCIsImNlaWwiLCJlcnJvciIsImNvbnNvbGUiLCJtZXNzYWdlIiwiZ2V0Q3VzdG9tZXJMb2dzIiwicGFyYW1zIiwiZ2V0TG9nc0J5QWN0aW9uIiwiZ2V0TG9nc0J5U3RhdHVzIiwiZ2V0TG9nU3RhdHMiLCJkYXRlRmlsdGVyIiwic3RhdHMiLCJQcm9taXNlIiwiYWxsIiwiYWdncmVnYXRlIiwiJG1hdGNoIiwiJGdyb3VwIiwiX2lkIiwiY291bnQiLCIkc3VtIiwiJHNvcnQiLCJieUFjdGlvbiIsImJ5U3RhdHVzIiwiZmFpbGVkTG9naW5zIiwic3VjY2Vzc2Z1bExvZ2lucyIsImRlbGV0ZU9sZExvZ3MiLCJvbGRlclRoYW4iLCJib2R5IiwiZGF0ZSIsImlzTmFOIiwiZ2V0VGltZSIsInJlc3VsdCIsImRlbGV0ZU1hbnkiLCIkbHQiLCJkZWxldGVkQ291bnQiLCJ0b0lTT1N0cmluZyIsIl9kZWZhdWx0IiwiZGVmYXVsdCJdLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NyYy9Db250cm9sbGVyL2N1c3RvbWVyTG9nQ29udHJvbGxlci5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgQ3VzdG9tZXJMb2cgZnJvbSAnLi4vTW9kZWwvQ3VzdG9tZXJMb2cuanMnO1xyXG5cclxuLyoqXHJcbiAqIENvbnRyb2xsZXIgZm9yIGN1c3RvbWVyIGxvZyBvcGVyYXRpb25zXHJcbiAqL1xyXG5leHBvcnQgY29uc3QgY3VzdG9tZXJMb2dDb250cm9sbGVyID0ge1xyXG4gIC8qKlxyXG4gICAqIEdldCBhbGwgbG9ncyB3aXRoIHBhZ2luYXRpb24gYW5kIGZpbHRlcmluZ1xyXG4gICAqIEBwYXJhbSB7T2JqZWN0fSByZXEgLSBSZXF1ZXN0IG9iamVjdFxyXG4gICAqIEBwYXJhbSB7T2JqZWN0fSByZXMgLSBSZXNwb25zZSBvYmplY3RcclxuICAgKi9cclxuICBnZXRBbGxMb2dzOiBhc3luYyAocmVxLCByZXMpID0+IHtcclxuICAgIHRyeSB7XHJcbiAgICAgIGNvbnN0IHsgXHJcbiAgICAgICAgcGFnZSA9IDEsIFxyXG4gICAgICAgIGxpbWl0ID0gMjAsIFxyXG4gICAgICAgIGFjdGlvbiwgXHJcbiAgICAgICAgc3RhdHVzLCBcclxuICAgICAgICBzdGFydERhdGUsIFxyXG4gICAgICAgIGVuZERhdGUsXHJcbiAgICAgICAgY3VzdG9tZXJJZCxcclxuICAgICAgICBjdXN0b21lckVtYWlsLFxyXG4gICAgICAgIHNvcnQgPSAndGltZXN0YW1wJyxcclxuICAgICAgICBvcmRlciA9IC0xXHJcbiAgICAgIH0gPSByZXEucXVlcnk7XHJcblxyXG4gICAgICAvLyBCdWlsZCBmaWx0ZXJcclxuICAgICAgY29uc3QgZmlsdGVyID0ge307XHJcbiAgICAgIFxyXG4gICAgICBpZiAoYWN0aW9uKSBmaWx0ZXIuYWN0aW9uID0gYWN0aW9uO1xyXG4gICAgICBpZiAoc3RhdHVzKSBmaWx0ZXIuc3RhdHVzID0gc3RhdHVzO1xyXG4gICAgICBpZiAoY3VzdG9tZXJJZCkgZmlsdGVyLmN1c3RvbWVySWQgPSBjdXN0b21lcklkO1xyXG4gICAgICBpZiAoY3VzdG9tZXJFbWFpbCkgZmlsdGVyLmN1c3RvbWVyRW1haWwgPSB7ICRyZWdleDogY3VzdG9tZXJFbWFpbCwgJG9wdGlvbnM6ICdpJyB9O1xyXG4gICAgICBcclxuICAgICAgLy8gRGF0ZSByYW5nZSBmaWx0ZXJcclxuICAgICAgaWYgKHN0YXJ0RGF0ZSB8fCBlbmREYXRlKSB7XHJcbiAgICAgICAgZmlsdGVyLnRpbWVzdGFtcCA9IHt9O1xyXG4gICAgICAgIGlmIChzdGFydERhdGUpIGZpbHRlci50aW1lc3RhbXAuJGd0ZSA9IG5ldyBEYXRlKHN0YXJ0RGF0ZSk7XHJcbiAgICAgICAgaWYgKGVuZERhdGUpIGZpbHRlci50aW1lc3RhbXAuJGx0ZSA9IG5ldyBEYXRlKGVuZERhdGUpO1xyXG4gICAgICB9XHJcblxyXG4gICAgICAvLyBDYWxjdWxhdGUgcGFnaW5hdGlvblxyXG4gICAgICBjb25zdCBza2lwID0gKHBhcnNlSW50KHBhZ2UpIC0gMSkgKiBwYXJzZUludChsaW1pdCk7XHJcbiAgICAgIFxyXG4gICAgICAvLyBTb3J0IG9wdGlvbnNcclxuICAgICAgY29uc3Qgc29ydE9wdGlvbnMgPSB7fTtcclxuICAgICAgc29ydE9wdGlvbnNbc29ydF0gPSBwYXJzZUludChvcmRlcik7XHJcblxyXG4gICAgICAvLyBHZXQgbG9nc1xyXG4gICAgICBjb25zdCBsb2dzID0gYXdhaXQgQ3VzdG9tZXJMb2cuZmluZChmaWx0ZXIpXHJcbiAgICAgICAgLnNvcnQoc29ydE9wdGlvbnMpXHJcbiAgICAgICAgLnNraXAoc2tpcClcclxuICAgICAgICAubGltaXQocGFyc2VJbnQobGltaXQpKVxyXG4gICAgICAgIC5leGVjKCk7XHJcblxyXG4gICAgICAvLyBHZXQgdG90YWwgY291bnQgZm9yIHBhZ2luYXRpb25cclxuICAgICAgY29uc3QgdG90YWwgPSBhd2FpdCBDdXN0b21lckxvZy5jb3VudERvY3VtZW50cyhmaWx0ZXIpO1xyXG5cclxuICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoMjAwKS5qc29uKHtcclxuICAgICAgICBzdWNjZXNzOiB0cnVlLFxyXG4gICAgICAgIGRhdGE6IGxvZ3MsXHJcbiAgICAgICAgcGFnaW5hdGlvbjoge1xyXG4gICAgICAgICAgdG90YWwsXHJcbiAgICAgICAgICBwYWdlOiBwYXJzZUludChwYWdlKSxcclxuICAgICAgICAgIGxpbWl0OiBwYXJzZUludChsaW1pdCksXHJcbiAgICAgICAgICBwYWdlczogTWF0aC5jZWlsKHRvdGFsIC8gcGFyc2VJbnQobGltaXQpKVxyXG4gICAgICAgIH1cclxuICAgICAgfSk7XHJcbiAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBnZXR0aW5nIGxvZ3M6JywgZXJyb3IpO1xyXG4gICAgICByZXR1cm4gcmVzLnN0YXR1cyg1MDApLmpzb24oe1xyXG4gICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxyXG4gICAgICAgIG1lc3NhZ2U6ICdFcnJvciByZXRyaWV2aW5nIGxvZ3MnLFxyXG4gICAgICAgIGVycm9yOiBlcnJvci5tZXNzYWdlXHJcbiAgICAgIH0pO1xyXG4gICAgfVxyXG4gIH0sXHJcblxyXG4gIC8qKlxyXG4gICAqIEdldCBsb2dzIGZvciBhIHNwZWNpZmljIGN1c3RvbWVyXHJcbiAgICogQHBhcmFtIHtPYmplY3R9IHJlcSAtIFJlcXVlc3Qgb2JqZWN0XHJcbiAgICogQHBhcmFtIHtPYmplY3R9IHJlcyAtIFJlc3BvbnNlIG9iamVjdFxyXG4gICAqL1xyXG4gIGdldEN1c3RvbWVyTG9nczogYXN5bmMgKHJlcSwgcmVzKSA9PiB7XHJcbiAgICB0cnkge1xyXG4gICAgICBjb25zdCB7IGN1c3RvbWVySWQgfSA9IHJlcS5wYXJhbXM7XHJcbiAgICAgIGNvbnN0IHsgcGFnZSA9IDEsIGxpbWl0ID0gMjAsIGFjdGlvbiwgc3RhdHVzIH0gPSByZXEucXVlcnk7XHJcblxyXG4gICAgICAvLyBCdWlsZCBmaWx0ZXJcclxuICAgICAgY29uc3QgZmlsdGVyID0geyBjdXN0b21lcklkIH07XHJcbiAgICAgIGlmIChhY3Rpb24pIGZpbHRlci5hY3Rpb24gPSBhY3Rpb247XHJcbiAgICAgIGlmIChzdGF0dXMpIGZpbHRlci5zdGF0dXMgPSBzdGF0dXM7XHJcblxyXG4gICAgICAvLyBDYWxjdWxhdGUgcGFnaW5hdGlvblxyXG4gICAgICBjb25zdCBza2lwID0gKHBhcnNlSW50KHBhZ2UpIC0gMSkgKiBwYXJzZUludChsaW1pdCk7XHJcblxyXG4gICAgICAvLyBHZXQgbG9nc1xyXG4gICAgICBjb25zdCBsb2dzID0gYXdhaXQgQ3VzdG9tZXJMb2cuZmluZChmaWx0ZXIpXHJcbiAgICAgICAgLnNvcnQoeyB0aW1lc3RhbXA6IC0xIH0pXHJcbiAgICAgICAgLnNraXAoc2tpcClcclxuICAgICAgICAubGltaXQocGFyc2VJbnQobGltaXQpKVxyXG4gICAgICAgIC5leGVjKCk7XHJcblxyXG4gICAgICAvLyBHZXQgdG90YWwgY291bnQgZm9yIHBhZ2luYXRpb25cclxuICAgICAgY29uc3QgdG90YWwgPSBhd2FpdCBDdXN0b21lckxvZy5jb3VudERvY3VtZW50cyhmaWx0ZXIpO1xyXG5cclxuICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoMjAwKS5qc29uKHtcclxuICAgICAgICBzdWNjZXNzOiB0cnVlLFxyXG4gICAgICAgIGRhdGE6IGxvZ3MsXHJcbiAgICAgICAgcGFnaW5hdGlvbjoge1xyXG4gICAgICAgICAgdG90YWwsXHJcbiAgICAgICAgICBwYWdlOiBwYXJzZUludChwYWdlKSxcclxuICAgICAgICAgIGxpbWl0OiBwYXJzZUludChsaW1pdCksXHJcbiAgICAgICAgICBwYWdlczogTWF0aC5jZWlsKHRvdGFsIC8gcGFyc2VJbnQobGltaXQpKVxyXG4gICAgICAgIH1cclxuICAgICAgfSk7XHJcbiAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBnZXR0aW5nIGN1c3RvbWVyIGxvZ3M6JywgZXJyb3IpO1xyXG4gICAgICByZXR1cm4gcmVzLnN0YXR1cyg1MDApLmpzb24oe1xyXG4gICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxyXG4gICAgICAgIG1lc3NhZ2U6ICdFcnJvciByZXRyaWV2aW5nIGN1c3RvbWVyIGxvZ3MnLFxyXG4gICAgICAgIGVycm9yOiBlcnJvci5tZXNzYWdlXHJcbiAgICAgIH0pO1xyXG4gICAgfVxyXG4gIH0sXHJcblxyXG4gIC8qKlxyXG4gICAqIEdldCBsb2dzIGJ5IGFjdGlvbiB0eXBlXHJcbiAgICogQHBhcmFtIHtPYmplY3R9IHJlcSAtIFJlcXVlc3Qgb2JqZWN0XHJcbiAgICogQHBhcmFtIHtPYmplY3R9IHJlcyAtIFJlc3BvbnNlIG9iamVjdFxyXG4gICAqL1xyXG4gIGdldExvZ3NCeUFjdGlvbjogYXN5bmMgKHJlcSwgcmVzKSA9PiB7XHJcbiAgICB0cnkge1xyXG4gICAgICBjb25zdCB7IGFjdGlvbiB9ID0gcmVxLnBhcmFtcztcclxuICAgICAgY29uc3QgeyBwYWdlID0gMSwgbGltaXQgPSAyMCwgc3RhdHVzIH0gPSByZXEucXVlcnk7XHJcblxyXG4gICAgICAvLyBCdWlsZCBmaWx0ZXJcclxuICAgICAgY29uc3QgZmlsdGVyID0geyBhY3Rpb24gfTtcclxuICAgICAgaWYgKHN0YXR1cykgZmlsdGVyLnN0YXR1cyA9IHN0YXR1cztcclxuXHJcbiAgICAgIC8vIENhbGN1bGF0ZSBwYWdpbmF0aW9uXHJcbiAgICAgIGNvbnN0IHNraXAgPSAocGFyc2VJbnQocGFnZSkgLSAxKSAqIHBhcnNlSW50KGxpbWl0KTtcclxuXHJcbiAgICAgIC8vIEdldCBsb2dzXHJcbiAgICAgIGNvbnN0IGxvZ3MgPSBhd2FpdCBDdXN0b21lckxvZy5maW5kKGZpbHRlcilcclxuICAgICAgICAuc29ydCh7IHRpbWVzdGFtcDogLTEgfSlcclxuICAgICAgICAuc2tpcChza2lwKVxyXG4gICAgICAgIC5saW1pdChwYXJzZUludChsaW1pdCkpXHJcbiAgICAgICAgLmV4ZWMoKTtcclxuXHJcbiAgICAgIC8vIEdldCB0b3RhbCBjb3VudCBmb3IgcGFnaW5hdGlvblxyXG4gICAgICBjb25zdCB0b3RhbCA9IGF3YWl0IEN1c3RvbWVyTG9nLmNvdW50RG9jdW1lbnRzKGZpbHRlcik7XHJcblxyXG4gICAgICByZXR1cm4gcmVzLnN0YXR1cygyMDApLmpzb24oe1xyXG4gICAgICAgIHN1Y2Nlc3M6IHRydWUsXHJcbiAgICAgICAgZGF0YTogbG9ncyxcclxuICAgICAgICBwYWdpbmF0aW9uOiB7XHJcbiAgICAgICAgICB0b3RhbCxcclxuICAgICAgICAgIHBhZ2U6IHBhcnNlSW50KHBhZ2UpLFxyXG4gICAgICAgICAgbGltaXQ6IHBhcnNlSW50KGxpbWl0KSxcclxuICAgICAgICAgIHBhZ2VzOiBNYXRoLmNlaWwodG90YWwgLyBwYXJzZUludChsaW1pdCkpXHJcbiAgICAgICAgfVxyXG4gICAgICB9KTtcclxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGdldHRpbmcgbG9ncyBieSBhY3Rpb246JywgZXJyb3IpO1xyXG4gICAgICByZXR1cm4gcmVzLnN0YXR1cyg1MDApLmpzb24oe1xyXG4gICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxyXG4gICAgICAgIG1lc3NhZ2U6ICdFcnJvciByZXRyaWV2aW5nIGxvZ3MgYnkgYWN0aW9uJyxcclxuICAgICAgICBlcnJvcjogZXJyb3IubWVzc2FnZVxyXG4gICAgICB9KTtcclxuICAgIH1cclxuICB9LFxyXG5cclxuICAvKipcclxuICAgKiBHZXQgbG9ncyBieSBzdGF0dXNcclxuICAgKiBAcGFyYW0ge09iamVjdH0gcmVxIC0gUmVxdWVzdCBvYmplY3RcclxuICAgKiBAcGFyYW0ge09iamVjdH0gcmVzIC0gUmVzcG9uc2Ugb2JqZWN0XHJcbiAgICovXHJcbiAgZ2V0TG9nc0J5U3RhdHVzOiBhc3luYyAocmVxLCByZXMpID0+IHtcclxuICAgIHRyeSB7XHJcbiAgICAgIGNvbnN0IHsgc3RhdHVzIH0gPSByZXEucGFyYW1zO1xyXG4gICAgICBjb25zdCB7IHBhZ2UgPSAxLCBsaW1pdCA9IDIwLCBhY3Rpb24gfSA9IHJlcS5xdWVyeTtcclxuXHJcbiAgICAgIC8vIEJ1aWxkIGZpbHRlclxyXG4gICAgICBjb25zdCBmaWx0ZXIgPSB7IHN0YXR1cyB9O1xyXG4gICAgICBpZiAoYWN0aW9uKSBmaWx0ZXIuYWN0aW9uID0gYWN0aW9uO1xyXG5cclxuICAgICAgLy8gQ2FsY3VsYXRlIHBhZ2luYXRpb25cclxuICAgICAgY29uc3Qgc2tpcCA9IChwYXJzZUludChwYWdlKSAtIDEpICogcGFyc2VJbnQobGltaXQpO1xyXG5cclxuICAgICAgLy8gR2V0IGxvZ3NcclxuICAgICAgY29uc3QgbG9ncyA9IGF3YWl0IEN1c3RvbWVyTG9nLmZpbmQoZmlsdGVyKVxyXG4gICAgICAgIC5zb3J0KHsgdGltZXN0YW1wOiAtMSB9KVxyXG4gICAgICAgIC5za2lwKHNraXApXHJcbiAgICAgICAgLmxpbWl0KHBhcnNlSW50KGxpbWl0KSlcclxuICAgICAgICAuZXhlYygpO1xyXG5cclxuICAgICAgLy8gR2V0IHRvdGFsIGNvdW50IGZvciBwYWdpbmF0aW9uXHJcbiAgICAgIGNvbnN0IHRvdGFsID0gYXdhaXQgQ3VzdG9tZXJMb2cuY291bnREb2N1bWVudHMoZmlsdGVyKTtcclxuXHJcbiAgICAgIHJldHVybiByZXMuc3RhdHVzKDIwMCkuanNvbih7XHJcbiAgICAgICAgc3VjY2VzczogdHJ1ZSxcclxuICAgICAgICBkYXRhOiBsb2dzLFxyXG4gICAgICAgIHBhZ2luYXRpb246IHtcclxuICAgICAgICAgIHRvdGFsLFxyXG4gICAgICAgICAgcGFnZTogcGFyc2VJbnQocGFnZSksXHJcbiAgICAgICAgICBsaW1pdDogcGFyc2VJbnQobGltaXQpLFxyXG4gICAgICAgICAgcGFnZXM6IE1hdGguY2VpbCh0b3RhbCAvIHBhcnNlSW50KGxpbWl0KSlcclxuICAgICAgICB9XHJcbiAgICAgIH0pO1xyXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgZ2V0dGluZyBsb2dzIGJ5IHN0YXR1czonLCBlcnJvcik7XHJcbiAgICAgIHJldHVybiByZXMuc3RhdHVzKDUwMCkuanNvbih7XHJcbiAgICAgICAgc3VjY2VzczogZmFsc2UsXHJcbiAgICAgICAgbWVzc2FnZTogJ0Vycm9yIHJldHJpZXZpbmcgbG9ncyBieSBzdGF0dXMnLFxyXG4gICAgICAgIGVycm9yOiBlcnJvci5tZXNzYWdlXHJcbiAgICAgIH0pO1xyXG4gICAgfVxyXG4gIH0sXHJcblxyXG4gIC8qKlxyXG4gICAqIEdldCBsb2cgc3RhdGlzdGljc1xyXG4gICAqIEBwYXJhbSB7T2JqZWN0fSByZXEgLSBSZXF1ZXN0IG9iamVjdFxyXG4gICAqIEBwYXJhbSB7T2JqZWN0fSByZXMgLSBSZXNwb25zZSBvYmplY3RcclxuICAgKi9cclxuICBnZXRMb2dTdGF0czogYXN5bmMgKHJlcSwgcmVzKSA9PiB7XHJcbiAgICB0cnkge1xyXG4gICAgICBjb25zdCB7IHN0YXJ0RGF0ZSwgZW5kRGF0ZSB9ID0gcmVxLnF1ZXJ5O1xyXG4gICAgICBcclxuICAgICAgLy8gRGF0ZSByYW5nZSBmaWx0ZXJcclxuICAgICAgY29uc3QgZGF0ZUZpbHRlciA9IHt9O1xyXG4gICAgICBpZiAoc3RhcnREYXRlIHx8IGVuZERhdGUpIHtcclxuICAgICAgICBkYXRlRmlsdGVyLnRpbWVzdGFtcCA9IHt9O1xyXG4gICAgICAgIGlmIChzdGFydERhdGUpIGRhdGVGaWx0ZXIudGltZXN0YW1wLiRndGUgPSBuZXcgRGF0ZShzdGFydERhdGUpO1xyXG4gICAgICAgIGlmIChlbmREYXRlKSBkYXRlRmlsdGVyLnRpbWVzdGFtcC4kbHRlID0gbmV3IERhdGUoZW5kRGF0ZSk7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIC8vIEdldCBzdGF0aXN0aWNzXHJcbiAgICAgIGNvbnN0IHN0YXRzID0gYXdhaXQgUHJvbWlzZS5hbGwoW1xyXG4gICAgICAgIC8vIFRvdGFsIGxvZ3NcclxuICAgICAgICBDdXN0b21lckxvZy5jb3VudERvY3VtZW50cyhkYXRlRmlsdGVyKSxcclxuICAgICAgICBcclxuICAgICAgICAvLyBMb2dzIGJ5IGFjdGlvblxyXG4gICAgICAgIEN1c3RvbWVyTG9nLmFnZ3JlZ2F0ZShbXHJcbiAgICAgICAgICB7ICRtYXRjaDogZGF0ZUZpbHRlciB9LFxyXG4gICAgICAgICAgeyAkZ3JvdXA6IHsgX2lkOiAnJGFjdGlvbicsIGNvdW50OiB7ICRzdW06IDEgfSB9IH0sXHJcbiAgICAgICAgICB7ICRzb3J0OiB7IGNvdW50OiAtMSB9IH1cclxuICAgICAgICBdKSxcclxuICAgICAgICBcclxuICAgICAgICAvLyBMb2dzIGJ5IHN0YXR1c1xyXG4gICAgICAgIEN1c3RvbWVyTG9nLmFnZ3JlZ2F0ZShbXHJcbiAgICAgICAgICB7ICRtYXRjaDogZGF0ZUZpbHRlciB9LFxyXG4gICAgICAgICAgeyAkZ3JvdXA6IHsgX2lkOiAnJHN0YXR1cycsIGNvdW50OiB7ICRzdW06IDEgfSB9IH0sXHJcbiAgICAgICAgICB7ICRzb3J0OiB7IGNvdW50OiAtMSB9IH1cclxuICAgICAgICBdKSxcclxuICAgICAgICBcclxuICAgICAgICAvLyBGYWlsZWQgbG9naW4gYXR0ZW1wdHNcclxuICAgICAgICBDdXN0b21lckxvZy5jb3VudERvY3VtZW50cyh7IFxyXG4gICAgICAgICAgLi4uZGF0ZUZpbHRlciwgXHJcbiAgICAgICAgICBhY3Rpb246ICdsb2dpbicsIFxyXG4gICAgICAgICAgc3RhdHVzOiAnZmFpbGVkJyBcclxuICAgICAgICB9KSxcclxuICAgICAgICBcclxuICAgICAgICAvLyBTdWNjZXNzZnVsIGxvZ2luc1xyXG4gICAgICAgIEN1c3RvbWVyTG9nLmNvdW50RG9jdW1lbnRzKHsgXHJcbiAgICAgICAgICAuLi5kYXRlRmlsdGVyLCBcclxuICAgICAgICAgIGFjdGlvbjogJ2xvZ2luJywgXHJcbiAgICAgICAgICBzdGF0dXM6ICdzdWNjZXNzJyBcclxuICAgICAgICB9KVxyXG4gICAgICBdKTtcclxuXHJcbiAgICAgIHJldHVybiByZXMuc3RhdHVzKDIwMCkuanNvbih7XHJcbiAgICAgICAgc3VjY2VzczogdHJ1ZSxcclxuICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICB0b3RhbDogc3RhdHNbMF0sXHJcbiAgICAgICAgICBieUFjdGlvbjogc3RhdHNbMV0sXHJcbiAgICAgICAgICBieVN0YXR1czogc3RhdHNbMl0sXHJcbiAgICAgICAgICBmYWlsZWRMb2dpbnM6IHN0YXRzWzNdLFxyXG4gICAgICAgICAgc3VjY2Vzc2Z1bExvZ2luczogc3RhdHNbNF1cclxuICAgICAgICB9XHJcbiAgICAgIH0pO1xyXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgZ2V0dGluZyBsb2cgc3RhdGlzdGljczonLCBlcnJvcik7XHJcbiAgICAgIHJldHVybiByZXMuc3RhdHVzKDUwMCkuanNvbih7XHJcbiAgICAgICAgc3VjY2VzczogZmFsc2UsXHJcbiAgICAgICAgbWVzc2FnZTogJ0Vycm9yIHJldHJpZXZpbmcgbG9nIHN0YXRpc3RpY3MnLFxyXG4gICAgICAgIGVycm9yOiBlcnJvci5tZXNzYWdlXHJcbiAgICAgIH0pO1xyXG4gICAgfVxyXG4gIH0sXHJcblxyXG4gIC8qKlxyXG4gICAqIERlbGV0ZSBsb2dzIG9sZGVyIHRoYW4gYSBjZXJ0YWluIGRhdGVcclxuICAgKiBAcGFyYW0ge09iamVjdH0gcmVxIC0gUmVxdWVzdCBvYmplY3RcclxuICAgKiBAcGFyYW0ge09iamVjdH0gcmVzIC0gUmVzcG9uc2Ugb2JqZWN0XHJcbiAgICovXHJcbiAgZGVsZXRlT2xkTG9nczogYXN5bmMgKHJlcSwgcmVzKSA9PiB7XHJcbiAgICB0cnkge1xyXG4gICAgICBjb25zdCB7IG9sZGVyVGhhbiB9ID0gcmVxLmJvZHk7XHJcbiAgICAgIFxyXG4gICAgICBpZiAoIW9sZGVyVGhhbikge1xyXG4gICAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwMCkuanNvbih7XHJcbiAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcclxuICAgICAgICAgIG1lc3NhZ2U6ICdNaXNzaW5nIG9sZGVyVGhhbiBwYXJhbWV0ZXInXHJcbiAgICAgICAgfSk7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGNvbnN0IGRhdGUgPSBuZXcgRGF0ZShvbGRlclRoYW4pO1xyXG4gICAgICBcclxuICAgICAgaWYgKGlzTmFOKGRhdGUuZ2V0VGltZSgpKSkge1xyXG4gICAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwMCkuanNvbih7XHJcbiAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcclxuICAgICAgICAgIG1lc3NhZ2U6ICdJbnZhbGlkIGRhdGUgZm9ybWF0J1xyXG4gICAgICAgIH0pO1xyXG4gICAgICB9XHJcblxyXG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBDdXN0b21lckxvZy5kZWxldGVNYW55KHtcclxuICAgICAgICB0aW1lc3RhbXA6IHsgJGx0OiBkYXRlIH1cclxuICAgICAgfSk7XHJcblxyXG4gICAgICByZXR1cm4gcmVzLnN0YXR1cygyMDApLmpzb24oe1xyXG4gICAgICAgIHN1Y2Nlc3M6IHRydWUsXHJcbiAgICAgICAgbWVzc2FnZTogYERlbGV0ZWQgJHtyZXN1bHQuZGVsZXRlZENvdW50fSBsb2dzIG9sZGVyIHRoYW4gJHtkYXRlLnRvSVNPU3RyaW5nKCl9YCxcclxuICAgICAgICBkZWxldGVkQ291bnQ6IHJlc3VsdC5kZWxldGVkQ291bnRcclxuICAgICAgfSk7XHJcbiAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBkZWxldGluZyBvbGQgbG9nczonLCBlcnJvcik7XHJcbiAgICAgIHJldHVybiByZXMuc3RhdHVzKDUwMCkuanNvbih7XHJcbiAgICAgICAgc3VjY2VzczogZmFsc2UsXHJcbiAgICAgICAgbWVzc2FnZTogJ0Vycm9yIGRlbGV0aW5nIG9sZCBsb2dzJyxcclxuICAgICAgICBlcnJvcjogZXJyb3IubWVzc2FnZVxyXG4gICAgICB9KTtcclxuICAgIH1cclxuICB9XHJcbn07XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjdXN0b21l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