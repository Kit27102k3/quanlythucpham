"use strict";var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(exports, "__esModule", { value: true });exports.getDashboardStats = void 0;var _Order = _interopRequireDefault(require("../Model/Order.js"));
var _Products = _interopRequireDefault(require("../Model/Products.js"));
var _Register = _interopRequireDefault(require("../Model/Register.js"));

const getDashboardStats = async (req, res) => {
  try {
    // Lấy tổng doanh thu - đã cập nhật để sử dụng status correct và isPaid
    const totalRevenue = await _Order.default.aggregate([
    { $match: { status: "completed", isPaid: true } },
    { $group: { _id: null, total: { $sum: "$totalAmount" } } }]
    );

    // Lấy tổng số đơn hàng
    const totalOrders = await _Order.default.countDocuments();

    // Lấy tổng số sản phẩm
    const totalProducts = await _Products.default.countDocuments();

    // Lấy tổng số khách hàng
    const totalCustomers = await _Register.default.countDocuments();

    // Lấy doanh thu theo ngày (7 ngày gần nhất) - sử dụng completedAt nếu có
    const dailyRevenue = await _Order.default.aggregate([
    { $match: { status: "completed", isPaid: true } },
    {
      $group: {
        _id: {
          year: { $year: { $ifNull: ["$completedAt", "$updatedAt"] } },
          month: { $month: { $ifNull: ["$completedAt", "$updatedAt"] } },
          day: { $dayOfMonth: { $ifNull: ["$completedAt", "$updatedAt"] } }
        },
        revenue: { $sum: "$totalAmount" },
        orders: { $sum: 1 }
      }
    },
    { $sort: { "_id.year": -1, "_id.month": -1, "_id.day": -1 } },
    { $limit: 7 }]
    );

    // Lấy doanh thu theo tuần (4 tuần gần nhất) - sử dụng completedAt nếu có
    const weeklyRevenue = await _Order.default.aggregate([
    { $match: { status: "completed", isPaid: true } },
    {
      $group: {
        _id: {
          year: { $year: { $ifNull: ["$completedAt", "$updatedAt"] } },
          week: { $week: { $ifNull: ["$completedAt", "$updatedAt"] } }
        },
        revenue: { $sum: "$totalAmount" },
        orders: { $sum: 1 }
      }
    },
    { $sort: { "_id.year": -1, "_id.week": -1 } },
    { $limit: 4 }]
    );

    // Lấy doanh thu theo tháng (6 tháng gần nhất) - sử dụng completedAt nếu có
    const monthlyRevenue = await _Order.default.aggregate([
    { $match: { status: "completed", isPaid: true } },
    {
      $group: {
        _id: {
          year: { $year: { $ifNull: ["$completedAt", "$updatedAt"] } },
          month: { $month: { $ifNull: ["$completedAt", "$updatedAt"] } }
        },
        revenue: { $sum: "$totalAmount" },
        orders: { $sum: 1 }
      }
    },
    { $sort: { "_id.year": -1, "_id.month": -1 } },
    { $limit: 6 }]
    );

    // Lấy thống kê sản phẩm theo danh mục
    const productsByCategory = await _Products.default.aggregate([
    {
      $group: {
        _id: "$productCategory",
        name: { $first: "$productCategory" },
        value: { $sum: 1 }
      }
    },
    {
      $project: {
        _id: 0,
        name: 1,
        value: 1
      }
    },
    {
      $sort: { value: -1 }
    }]
    );

    // Khởi tạo biến để lưu kết quả cuối cùng
    let finalProductsByCategory = [];

    // Trong trường hợp không có dữ liệu phân loại
    if (!productsByCategory || productsByCategory.length === 0) {
      console.log("Không tìm thấy dữ liệu phân loại");

      const totalProducts = await _Products.default.countDocuments();
      finalProductsByCategory = [
      { name: "Tất cả sản phẩm", value: totalProducts }];

    } else {
      finalProductsByCategory = productsByCategory;
    }

    // Lấy top 5 sản phẩm bán chạy
    const topProducts = await _Products.default.aggregate([
    {
      $project: {
        name: "$productName",
        soldQuantity: { $ifNull: ["$soldCount", 0] } // Sử dụng trường đếm số lượng bán nếu có
      }
    },
    {
      $sort: { soldQuantity: -1 }
    },
    {
      $limit: 5
    }]
    );

    // Nếu không có dữ liệu hoặc dữ liệu trống, tạo dữ liệu mẫu
    let finalTopProducts =
    topProducts.length > 0 ?
    topProducts :
    [{ name: "Chưa có dữ liệu bán hàng", soldQuantity: 0 }];

    // Lấy thống kê đơn hàng theo trạng thái
    const ordersByStatus = await _Order.default.aggregate([
    {
      $group: {
        _id: "$status",
        count: { $sum: 1 }
      }
    },
    {
      $project: {
        _id: 0,
        name: "$_id",
        value: "$count"
      }
    }]
    );

    const response = {
      success: true,
      data: {
        totalRevenue: totalRevenue[0] && totalRevenue[0].total ? totalRevenue[0].total : 0,
        totalOrders,
        totalProducts,
        totalCustomers,
        dailyRevenue,
        weeklyRevenue,
        monthlyRevenue,
        productsByCategory: finalProductsByCategory,
        ordersByStatus,
        topProducts: finalTopProducts
      }
    };

    res.status(200).json(response);
  } catch (error) {
    res.status(500).json({
      success: false,
      message: "Lỗi server khi lấy thống kê",
      error: error.message
    });
  }
};exports.getDashboardStats = getDashboardStats;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfT3JkZXIiLCJfaW50ZXJvcFJlcXVpcmVEZWZhdWx0IiwicmVxdWlyZSIsIl9Qcm9kdWN0cyIsIl9SZWdpc3RlciIsImdldERhc2hib2FyZFN0YXRzIiwicmVxIiwicmVzIiwidG90YWxSZXZlbnVlIiwiT3JkZXIiLCJhZ2dyZWdhdGUiLCIkbWF0Y2giLCJzdGF0dXMiLCJpc1BhaWQiLCIkZ3JvdXAiLCJfaWQiLCJ0b3RhbCIsIiRzdW0iLCJ0b3RhbE9yZGVycyIsImNvdW50RG9jdW1lbnRzIiwidG90YWxQcm9kdWN0cyIsIlByb2R1Y3QiLCJ0b3RhbEN1c3RvbWVycyIsIlVzZXIiLCJkYWlseVJldmVudWUiLCJ5ZWFyIiwiJHllYXIiLCIkaWZOdWxsIiwibW9udGgiLCIkbW9udGgiLCJkYXkiLCIkZGF5T2ZNb250aCIsInJldmVudWUiLCJvcmRlcnMiLCIkc29ydCIsIiRsaW1pdCIsIndlZWtseVJldmVudWUiLCJ3ZWVrIiwiJHdlZWsiLCJtb250aGx5UmV2ZW51ZSIsInByb2R1Y3RzQnlDYXRlZ29yeSIsIm5hbWUiLCIkZmlyc3QiLCJ2YWx1ZSIsIiRwcm9qZWN0IiwiZmluYWxQcm9kdWN0c0J5Q2F0ZWdvcnkiLCJsZW5ndGgiLCJjb25zb2xlIiwibG9nIiwidG9wUHJvZHVjdHMiLCJzb2xkUXVhbnRpdHkiLCJmaW5hbFRvcFByb2R1Y3RzIiwib3JkZXJzQnlTdGF0dXMiLCJjb3VudCIsInJlc3BvbnNlIiwic3VjY2VzcyIsImRhdGEiLCJqc29uIiwiZXJyb3IiLCJtZXNzYWdlIiwiZXhwb3J0cyJdLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NyYy9Db250cm9sbGVyL2Rhc2hib2FyZENvbnRyb2xsZXIuanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IE9yZGVyIGZyb20gXCIuLi9Nb2RlbC9PcmRlci5qc1wiO1xyXG5pbXBvcnQgUHJvZHVjdCBmcm9tIFwiLi4vTW9kZWwvUHJvZHVjdHMuanNcIjtcclxuaW1wb3J0IFVzZXIgZnJvbSBcIi4uL01vZGVsL1JlZ2lzdGVyLmpzXCI7XHJcblxyXG5leHBvcnQgY29uc3QgZ2V0RGFzaGJvYXJkU3RhdHMgPSBhc3luYyAocmVxLCByZXMpID0+IHtcclxuICB0cnkge1xyXG4gICAgLy8gTOG6pXkgdOG7lW5nIGRvYW5oIHRodSAtIMSRw6MgY+G6rXAgbmjhuq10IMSR4buDIHPhu60gZOG7pW5nIHN0YXR1cyBjb3JyZWN0IHbDoCBpc1BhaWRcclxuICAgIGNvbnN0IHRvdGFsUmV2ZW51ZSA9IGF3YWl0IE9yZGVyLmFnZ3JlZ2F0ZShbXHJcbiAgICAgIHsgJG1hdGNoOiB7IHN0YXR1czogXCJjb21wbGV0ZWRcIiwgaXNQYWlkOiB0cnVlIH0gfSxcclxuICAgICAgeyAkZ3JvdXA6IHsgX2lkOiBudWxsLCB0b3RhbDogeyAkc3VtOiBcIiR0b3RhbEFtb3VudFwiIH0gfSB9LFxyXG4gICAgXSk7XHJcblxyXG4gICAgLy8gTOG6pXkgdOG7lW5nIHPhu5EgxJHGoW4gaMOgbmdcclxuICAgIGNvbnN0IHRvdGFsT3JkZXJzID0gYXdhaXQgT3JkZXIuY291bnREb2N1bWVudHMoKTtcclxuXHJcbiAgICAvLyBM4bqleSB04buVbmcgc+G7kSBz4bqjbiBwaOG6qW1cclxuICAgIGNvbnN0IHRvdGFsUHJvZHVjdHMgPSBhd2FpdCBQcm9kdWN0LmNvdW50RG9jdW1lbnRzKCk7XHJcblxyXG4gICAgLy8gTOG6pXkgdOG7lW5nIHPhu5Ega2jDoWNoIGjDoG5nXHJcbiAgICBjb25zdCB0b3RhbEN1c3RvbWVycyA9IGF3YWl0IFVzZXIuY291bnREb2N1bWVudHMoKTtcclxuXHJcbiAgICAvLyBM4bqleSBkb2FuaCB0aHUgdGhlbyBuZ8OgeSAoNyBuZ8OgeSBn4bqnbiBuaOG6pXQpIC0gc+G7rSBk4bulbmcgY29tcGxldGVkQXQgbuG6v3UgY8OzXHJcbiAgICBjb25zdCBkYWlseVJldmVudWUgPSBhd2FpdCBPcmRlci5hZ2dyZWdhdGUoW1xyXG4gICAgICB7ICRtYXRjaDogeyBzdGF0dXM6IFwiY29tcGxldGVkXCIsIGlzUGFpZDogdHJ1ZSB9IH0sXHJcbiAgICAgIHtcclxuICAgICAgICAkZ3JvdXA6IHtcclxuICAgICAgICAgIF9pZDoge1xyXG4gICAgICAgICAgICB5ZWFyOiB7ICR5ZWFyOiB7ICRpZk51bGw6IFtcIiRjb21wbGV0ZWRBdFwiLCBcIiR1cGRhdGVkQXRcIl0gfSB9LFxyXG4gICAgICAgICAgICBtb250aDogeyAkbW9udGg6IHsgJGlmTnVsbDogW1wiJGNvbXBsZXRlZEF0XCIsIFwiJHVwZGF0ZWRBdFwiXSB9IH0sXHJcbiAgICAgICAgICAgIGRheTogeyAkZGF5T2ZNb250aDogeyAkaWZOdWxsOiBbXCIkY29tcGxldGVkQXRcIiwgXCIkdXBkYXRlZEF0XCJdIH0gfSxcclxuICAgICAgICAgIH0sXHJcbiAgICAgICAgICByZXZlbnVlOiB7ICRzdW06IFwiJHRvdGFsQW1vdW50XCIgfSxcclxuICAgICAgICAgIG9yZGVyczogeyAkc3VtOiAxIH0sXHJcbiAgICAgICAgfSxcclxuICAgICAgfSxcclxuICAgICAgeyAkc29ydDogeyBcIl9pZC55ZWFyXCI6IC0xLCBcIl9pZC5tb250aFwiOiAtMSwgXCJfaWQuZGF5XCI6IC0xIH0gfSxcclxuICAgICAgeyAkbGltaXQ6IDcgfSxcclxuICAgIF0pO1xyXG5cclxuICAgIC8vIEzhuqV5IGRvYW5oIHRodSB0aGVvIHR14bqnbiAoNCB0deG6p24gZ+G6p24gbmjhuqV0KSAtIHPhu60gZOG7pW5nIGNvbXBsZXRlZEF0IG7hur91IGPDs1xyXG4gICAgY29uc3Qgd2Vla2x5UmV2ZW51ZSA9IGF3YWl0IE9yZGVyLmFnZ3JlZ2F0ZShbXHJcbiAgICAgIHsgJG1hdGNoOiB7IHN0YXR1czogXCJjb21wbGV0ZWRcIiwgaXNQYWlkOiB0cnVlIH0gfSxcclxuICAgICAge1xyXG4gICAgICAgICRncm91cDoge1xyXG4gICAgICAgICAgX2lkOiB7XHJcbiAgICAgICAgICAgIHllYXI6IHsgJHllYXI6IHsgJGlmTnVsbDogW1wiJGNvbXBsZXRlZEF0XCIsIFwiJHVwZGF0ZWRBdFwiXSB9IH0sXHJcbiAgICAgICAgICAgIHdlZWs6IHsgJHdlZWs6IHsgJGlmTnVsbDogW1wiJGNvbXBsZXRlZEF0XCIsIFwiJHVwZGF0ZWRBdFwiXSB9IH0sXHJcbiAgICAgICAgICB9LFxyXG4gICAgICAgICAgcmV2ZW51ZTogeyAkc3VtOiBcIiR0b3RhbEFtb3VudFwiIH0sXHJcbiAgICAgICAgICBvcmRlcnM6IHsgJHN1bTogMSB9LFxyXG4gICAgICAgIH0sXHJcbiAgICAgIH0sXHJcbiAgICAgIHsgJHNvcnQ6IHsgXCJfaWQueWVhclwiOiAtMSwgXCJfaWQud2Vla1wiOiAtMSB9IH0sXHJcbiAgICAgIHsgJGxpbWl0OiA0IH0sXHJcbiAgICBdKTtcclxuXHJcbiAgICAvLyBM4bqleSBkb2FuaCB0aHUgdGhlbyB0aMOhbmcgKDYgdGjDoW5nIGfhuqduIG5o4bqldCkgLSBz4butIGThu6VuZyBjb21wbGV0ZWRBdCBu4bq/dSBjw7NcclxuICAgIGNvbnN0IG1vbnRobHlSZXZlbnVlID0gYXdhaXQgT3JkZXIuYWdncmVnYXRlKFtcclxuICAgICAgeyAkbWF0Y2g6IHsgc3RhdHVzOiBcImNvbXBsZXRlZFwiLCBpc1BhaWQ6IHRydWUgfSB9LFxyXG4gICAgICB7XHJcbiAgICAgICAgJGdyb3VwOiB7XHJcbiAgICAgICAgICBfaWQ6IHtcclxuICAgICAgICAgICAgeWVhcjogeyAkeWVhcjogeyAkaWZOdWxsOiBbXCIkY29tcGxldGVkQXRcIiwgXCIkdXBkYXRlZEF0XCJdIH0gfSxcclxuICAgICAgICAgICAgbW9udGg6IHsgJG1vbnRoOiB7ICRpZk51bGw6IFtcIiRjb21wbGV0ZWRBdFwiLCBcIiR1cGRhdGVkQXRcIl0gfSB9LFxyXG4gICAgICAgICAgfSxcclxuICAgICAgICAgIHJldmVudWU6IHsgJHN1bTogXCIkdG90YWxBbW91bnRcIiB9LFxyXG4gICAgICAgICAgb3JkZXJzOiB7ICRzdW06IDEgfSxcclxuICAgICAgICB9LFxyXG4gICAgICB9LFxyXG4gICAgICB7ICRzb3J0OiB7IFwiX2lkLnllYXJcIjogLTEsIFwiX2lkLm1vbnRoXCI6IC0xIH0gfSxcclxuICAgICAgeyAkbGltaXQ6IDYgfSxcclxuICAgIF0pO1xyXG5cclxuICAgIC8vIEzhuqV5IHRo4buRbmcga8OqIHPhuqNuIHBo4bqpbSB0aGVvIGRhbmggbeG7pWNcclxuICAgIGNvbnN0IHByb2R1Y3RzQnlDYXRlZ29yeSA9IGF3YWl0IFByb2R1Y3QuYWdncmVnYXRlKFtcclxuICAgICAge1xyXG4gICAgICAgICRncm91cDoge1xyXG4gICAgICAgICAgX2lkOiBcIiRwcm9kdWN0Q2F0ZWdvcnlcIixcclxuICAgICAgICAgIG5hbWU6IHsgJGZpcnN0OiBcIiRwcm9kdWN0Q2F0ZWdvcnlcIiB9LFxyXG4gICAgICAgICAgdmFsdWU6IHsgJHN1bTogMSB9LFxyXG4gICAgICAgIH0sXHJcbiAgICAgIH0sXHJcbiAgICAgIHtcclxuICAgICAgICAkcHJvamVjdDoge1xyXG4gICAgICAgICAgX2lkOiAwLFxyXG4gICAgICAgICAgbmFtZTogMSxcclxuICAgICAgICAgIHZhbHVlOiAxLFxyXG4gICAgICAgIH0sXHJcbiAgICAgIH0sXHJcbiAgICAgIHtcclxuICAgICAgICAkc29ydDogeyB2YWx1ZTogLTEgfSxcclxuICAgICAgfSxcclxuICAgIF0pO1xyXG5cclxuICAgIC8vIEto4bufaSB04bqhbyBiaeG6v24gxJHhu4MgbMawdSBr4bq/dCBxdeG6oyBjdeG7kWkgY8O5bmdcclxuICAgIGxldCBmaW5hbFByb2R1Y3RzQnlDYXRlZ29yeSA9IFtdO1xyXG5cclxuICAgIC8vIFRyb25nIHRyxrDhu51uZyBo4bujcCBraMO0bmcgY8OzIGThu68gbGnhu4d1IHBow6JuIGxv4bqhaVxyXG4gICAgaWYgKCFwcm9kdWN0c0J5Q2F0ZWdvcnkgfHwgcHJvZHVjdHNCeUNhdGVnb3J5Lmxlbmd0aCA9PT0gMCkge1xyXG4gICAgICBjb25zb2xlLmxvZyhcIktow7RuZyB0w6xtIHRo4bqleSBk4buvIGxp4buHdSBwaMOibiBsb+G6oWlcIik7XHJcblxyXG4gICAgICBjb25zdCB0b3RhbFByb2R1Y3RzID0gYXdhaXQgUHJvZHVjdC5jb3VudERvY3VtZW50cygpO1xyXG4gICAgICBmaW5hbFByb2R1Y3RzQnlDYXRlZ29yeSA9IFtcclxuICAgICAgICB7IG5hbWU6IFwiVOG6pXQgY+G6oyBz4bqjbiBwaOG6qW1cIiwgdmFsdWU6IHRvdGFsUHJvZHVjdHMgfSxcclxuICAgICAgXTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIGZpbmFsUHJvZHVjdHNCeUNhdGVnb3J5ID0gcHJvZHVjdHNCeUNhdGVnb3J5O1xyXG4gICAgfVxyXG5cclxuICAgIC8vIEzhuqV5IHRvcCA1IHPhuqNuIHBo4bqpbSBiw6FuIGNo4bqheVxyXG4gICAgY29uc3QgdG9wUHJvZHVjdHMgPSBhd2FpdCBQcm9kdWN0LmFnZ3JlZ2F0ZShbXHJcbiAgICAgIHtcclxuICAgICAgICAkcHJvamVjdDoge1xyXG4gICAgICAgICAgbmFtZTogXCIkcHJvZHVjdE5hbWVcIixcclxuICAgICAgICAgIHNvbGRRdWFudGl0eTogeyAkaWZOdWxsOiBbXCIkc29sZENvdW50XCIsIDBdIH0sIC8vIFPhu60gZOG7pW5nIHRyxrDhu51uZyDEkeG6v20gc+G7kSBsxrDhu6NuZyBiw6FuIG7hur91IGPDs1xyXG4gICAgICAgIH0sXHJcbiAgICAgIH0sXHJcbiAgICAgIHtcclxuICAgICAgICAkc29ydDogeyBzb2xkUXVhbnRpdHk6IC0xIH0sXHJcbiAgICAgIH0sXHJcbiAgICAgIHtcclxuICAgICAgICAkbGltaXQ6IDUsXHJcbiAgICAgIH0sXHJcbiAgICBdKTtcclxuXHJcbiAgICAvLyBO4bq/dSBraMO0bmcgY8OzIGThu68gbGnhu4d1IGhv4bq3YyBk4buvIGxp4buHdSB0cuG7kW5nLCB04bqhbyBk4buvIGxp4buHdSBt4bqrdVxyXG4gICAgbGV0IGZpbmFsVG9wUHJvZHVjdHMgPVxyXG4gICAgICB0b3BQcm9kdWN0cy5sZW5ndGggPiAwXHJcbiAgICAgICAgPyB0b3BQcm9kdWN0c1xyXG4gICAgICAgIDogW3sgbmFtZTogXCJDaMawYSBjw7MgZOG7ryBsaeG7h3UgYsOhbiBow6BuZ1wiLCBzb2xkUXVhbnRpdHk6IDAgfV07XHJcblxyXG4gICAgLy8gTOG6pXkgdGjhu5FuZyBrw6ogxJHGoW4gaMOgbmcgdGhlbyB0cuG6oW5nIHRow6FpXHJcbiAgICBjb25zdCBvcmRlcnNCeVN0YXR1cyA9IGF3YWl0IE9yZGVyLmFnZ3JlZ2F0ZShbXHJcbiAgICAgIHtcclxuICAgICAgICAkZ3JvdXA6IHtcclxuICAgICAgICAgIF9pZDogXCIkc3RhdHVzXCIsXHJcbiAgICAgICAgICBjb3VudDogeyAkc3VtOiAxIH0sXHJcbiAgICAgICAgfSxcclxuICAgICAgfSxcclxuICAgICAge1xyXG4gICAgICAgICRwcm9qZWN0OiB7XHJcbiAgICAgICAgICBfaWQ6IDAsXHJcbiAgICAgICAgICBuYW1lOiBcIiRfaWRcIixcclxuICAgICAgICAgIHZhbHVlOiBcIiRjb3VudFwiLFxyXG4gICAgICAgIH0sXHJcbiAgICAgIH0sXHJcbiAgICBdKTtcclxuXHJcbiAgICBjb25zdCByZXNwb25zZSA9IHtcclxuICAgICAgc3VjY2VzczogdHJ1ZSxcclxuICAgICAgZGF0YToge1xyXG4gICAgICAgIHRvdGFsUmV2ZW51ZTogdG90YWxSZXZlbnVlWzBdICYmIHRvdGFsUmV2ZW51ZVswXS50b3RhbCA/IHRvdGFsUmV2ZW51ZVswXS50b3RhbCA6IDAsXHJcbiAgICAgICAgdG90YWxPcmRlcnMsXHJcbiAgICAgICAgdG90YWxQcm9kdWN0cyxcclxuICAgICAgICB0b3RhbEN1c3RvbWVycyxcclxuICAgICAgICBkYWlseVJldmVudWUsXHJcbiAgICAgICAgd2Vla2x5UmV2ZW51ZSxcclxuICAgICAgICBtb250aGx5UmV2ZW51ZSxcclxuICAgICAgICBwcm9kdWN0c0J5Q2F0ZWdvcnk6IGZpbmFsUHJvZHVjdHNCeUNhdGVnb3J5LFxyXG4gICAgICAgIG9yZGVyc0J5U3RhdHVzLFxyXG4gICAgICAgIHRvcFByb2R1Y3RzOiBmaW5hbFRvcFByb2R1Y3RzLFxyXG4gICAgICB9LFxyXG4gICAgfTtcclxuXHJcbiAgICByZXMuc3RhdHVzKDIwMCkuanNvbihyZXNwb25zZSk7XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIHJlcy5zdGF0dXMoNTAwKS5qc29uKHtcclxuICAgICAgc3VjY2VzczogZmFsc2UsXHJcbiAgICAgIG1lc3NhZ2U6IFwiTOG7l2kgc2VydmVyIGtoaSBs4bqleSB0aOG7kW5nIGvDqlwiLFxyXG4gICAgICBlcnJvcjogZXJyb3IubWVzc2FnZSxcclxuICAgIH0pO1xyXG4gIH1cclxufTtcclxuIl0sIm1hcHBpbmdzIjoibU1BQUEsSUFBQUEsTUFBQSxHQUFBQyxzQkFBQSxDQUFBQyxPQUFBO0FBQ0EsSUFBQUMsU0FBQSxHQUFBRixzQkFBQSxDQUFBQyxPQUFBO0FBQ0EsSUFBQUUsU0FBQSxHQUFBSCxzQkFBQSxDQUFBQyxPQUFBOztBQUVPLE1BQU1HLGlCQUFpQixHQUFHLE1BQUFBLENBQU9DLEdBQUcsRUFBRUMsR0FBRyxLQUFLO0VBQ25ELElBQUk7SUFDRjtJQUNBLE1BQU1DLFlBQVksR0FBRyxNQUFNQyxjQUFLLENBQUNDLFNBQVMsQ0FBQztJQUN6QyxFQUFFQyxNQUFNLEVBQUUsRUFBRUMsTUFBTSxFQUFFLFdBQVcsRUFBRUMsTUFBTSxFQUFFLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQztJQUNqRCxFQUFFQyxNQUFNLEVBQUUsRUFBRUMsR0FBRyxFQUFFLElBQUksRUFBRUMsS0FBSyxFQUFFLEVBQUVDLElBQUksRUFBRSxjQUFjLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDO0lBQzNELENBQUM7O0lBRUY7SUFDQSxNQUFNQyxXQUFXLEdBQUcsTUFBTVQsY0FBSyxDQUFDVSxjQUFjLENBQUMsQ0FBQzs7SUFFaEQ7SUFDQSxNQUFNQyxhQUFhLEdBQUcsTUFBTUMsaUJBQU8sQ0FBQ0YsY0FBYyxDQUFDLENBQUM7O0lBRXBEO0lBQ0EsTUFBTUcsY0FBYyxHQUFHLE1BQU1DLGlCQUFJLENBQUNKLGNBQWMsQ0FBQyxDQUFDOztJQUVsRDtJQUNBLE1B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