"use strict";Object.defineProperty(exports, "__esModule", { value: true });exports.getDashboardStats = void 0;var _Order = _interopRequireDefault(require("../Model/Order.js"));
var _Products = _interopRequireDefault(require("../Model/Products.js"));
var _Register = _interopRequireDefault(require("../Model/Register.js"));function _interopRequireDefault(e) {return e && e.__esModule ? e : { default: e };}

const getDashboardStats = async (req, res) => {
  try {
    // Lấy tổng doanh thu - đã cập nhật để sử dụng status correct và isPaid
    const totalRevenue = await _Order.default.aggregate([
    { $match: { status: "completed", isPaid: true } },
    { $group: { _id: null, total: { $sum: "$totalAmount" } } }]
    );

    // Lấy tổng số đơn hàng
    const totalOrders = await _Order.default.countDocuments();

    // Lấy tổng số sản phẩm
    const totalProducts = await _Products.default.countDocuments();

    // Lấy tổng số khách hàng
    const totalCustomers = await _Register.default.countDocuments();

    // Lấy doanh thu theo ngày (7 ngày gần nhất) - sử dụng completedAt nếu có
    const dailyRevenue = await _Order.default.aggregate([
    { $match: { status: "completed", isPaid: true } },
    {
      $group: {
        _id: {
          year: { $year: { $ifNull: ["$completedAt", "$updatedAt"] } },
          month: { $month: { $ifNull: ["$completedAt", "$updatedAt"] } },
          day: { $dayOfMonth: { $ifNull: ["$completedAt", "$updatedAt"] } }
        },
        revenue: { $sum: "$totalAmount" },
        orders: { $sum: 1 }
      }
    },
    { $sort: { "_id.year": -1, "_id.month": -1, "_id.day": -1 } },
    { $limit: 7 }]
    );

    // Lấy doanh thu theo tuần (4 tuần gần nhất) - sử dụng completedAt nếu có
    const weeklyRevenue = await _Order.default.aggregate([
    { $match: { status: "completed", isPaid: true } },
    {
      $group: {
        _id: {
          year: { $year: { $ifNull: ["$completedAt", "$updatedAt"] } },
          week: { $week: { $ifNull: ["$completedAt", "$updatedAt"] } }
        },
        revenue: { $sum: "$totalAmount" },
        orders: { $sum: 1 }
      }
    },
    { $sort: { "_id.year": -1, "_id.week": -1 } },
    { $limit: 4 }]
    );

    // Lấy doanh thu theo tháng (6 tháng gần nhất) - sử dụng completedAt nếu có
    const monthlyRevenue = await _Order.default.aggregate([
    { $match: { status: "completed", isPaid: true } },
    {
      $group: {
        _id: {
          year: { $year: { $ifNull: ["$completedAt", "$updatedAt"] } },
          month: { $month: { $ifNull: ["$completedAt", "$updatedAt"] } }
        },
        revenue: { $sum: "$totalAmount" },
        orders: { $sum: 1 }
      }
    },
    { $sort: { "_id.year": -1, "_id.month": -1 } },
    { $limit: 6 }]
    );

    // Lấy thống kê sản phẩm theo danh mục
    const productsByCategory = await _Products.default.aggregate([
    {
      $group: {
        _id: "$productCategory",
        name: { $first: "$productCategory" },
        value: { $sum: 1 }
      }
    },
    {
      $project: {
        _id: 0,
        name: 1,
        value: 1
      }
    },
    {
      $sort: { value: -1 }
    }]
    );

    // Khởi tạo biến để lưu kết quả cuối cùng
    let finalProductsByCategory = [];

    // Trong trường hợp không có dữ liệu phân loại
    if (!productsByCategory || productsByCategory.length === 0) {
      console.log("Không tìm thấy dữ liệu phân loại");

      const totalProducts = await _Products.default.countDocuments();
      finalProductsByCategory = [
      { name: "Tất cả sản phẩm", value: totalProducts }];

    } else {
      finalProductsByCategory = productsByCategory;
    }

    // Lấy top 5 sản phẩm bán chạy
    const topProducts = await _Products.default.aggregate([
    {
      $project: {
        name: "$productName",
        soldQuantity: { $ifNull: ["$soldCount", 0] } // Sử dụng trường đếm số lượng bán nếu có
      }
    },
    {
      $sort: { soldQuantity: -1 }
    },
    {
      $limit: 5
    }]
    );

    // Nếu không có dữ liệu hoặc dữ liệu trống, tạo dữ liệu mẫu
    let finalTopProducts =
    topProducts.length > 0 ?
    topProducts :
    [{ name: "Chưa có dữ liệu bán hàng", soldQuantity: 0 }];

    // Lấy thống kê đơn hàng theo trạng thái
    const ordersByStatus = await _Order.default.aggregate([
    {
      $group: {
        _id: "$status",
        count: { $sum: 1 }
      }
    },
    {
      $project: {
        _id: 0,
        name: "$_id",
        value: "$count"
      }
    }]
    );

    const response = {
      success: true,
      data: {
        totalRevenue: totalRevenue[0] && totalRevenue[0].total ? totalRevenue[0].total : 0,
        totalOrders,
        totalProducts,
        totalCustomers,
        dailyRevenue,
        weeklyRevenue,
        monthlyRevenue,
        productsByCategory: finalProductsByCategory,
        ordersByStatus,
        topProducts: finalTopProducts
      }
    };

    res.status(200).json(response);
  } catch (error) {
    res.status(500).json({
      success: false,
      message: "Lỗi server khi lấy thống kê",
      error: error.message
    });
  }
};exports.getDashboardStats = getDashboardStats;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfT3JkZXIiLCJfaW50ZXJvcFJlcXVpcmVEZWZhdWx0IiwicmVxdWlyZSIsIl9Qcm9kdWN0cyIsIl9SZWdpc3RlciIsImUiLCJfX2VzTW9kdWxlIiwiZGVmYXVsdCIsImdldERhc2hib2FyZFN0YXRzIiwicmVxIiwicmVzIiwidG90YWxSZXZlbnVlIiwiT3JkZXIiLCJhZ2dyZWdhdGUiLCIkbWF0Y2giLCJzdGF0dXMiLCJpc1BhaWQiLCIkZ3JvdXAiLCJfaWQiLCJ0b3RhbCIsIiRzdW0iLCJ0b3RhbE9yZGVycyIsImNvdW50RG9jdW1lbnRzIiwidG90YWxQcm9kdWN0cyIsIlByb2R1Y3QiLCJ0b3RhbEN1c3RvbWVycyIsIlVzZXIiLCJkYWlseVJldmVudWUiLCJ5ZWFyIiwiJHllYXIiLCIkaWZOdWxsIiwibW9udGgiLCIkbW9udGgiLCJkYXkiLCIkZGF5T2ZNb250aCIsInJldmVudWUiLCJvcmRlcnMiLCIkc29ydCIsIiRsaW1pdCIsIndlZWtseVJldmVudWUiLCJ3ZWVrIiwiJHdlZWsiLCJtb250aGx5UmV2ZW51ZSIsInByb2R1Y3RzQnlDYXRlZ29yeSIsIm5hbWUiLCIkZmlyc3QiLCJ2YWx1ZSIsIiRwcm9qZWN0IiwiZmluYWxQcm9kdWN0c0J5Q2F0ZWdvcnkiLCJsZW5ndGgiLCJjb25zb2xlIiwibG9nIiwidG9wUHJvZHVjdHMiLCJzb2xkUXVhbnRpdHkiLCJmaW5hbFRvcFByb2R1Y3RzIiwib3JkZXJzQnlTdGF0dXMiLCJjb3VudCIsInJlc3BvbnNlIiwic3VjY2VzcyIsImRhdGEiLCJqc29uIiwiZXJyb3IiLCJtZXNzYWdlIiwiZXhwb3J0cyJdLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NyYy9Db250cm9sbGVyL2Rhc2hib2FyZENvbnRyb2xsZXIuanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IE9yZGVyIGZyb20gXCIuLi9Nb2RlbC9PcmRlci5qc1wiO1xuaW1wb3J0IFByb2R1Y3QgZnJvbSBcIi4uL01vZGVsL1Byb2R1Y3RzLmpzXCI7XG5pbXBvcnQgVXNlciBmcm9tIFwiLi4vTW9kZWwvUmVnaXN0ZXIuanNcIjtcblxuZXhwb3J0IGNvbnN0IGdldERhc2hib2FyZFN0YXRzID0gYXN5bmMgKHJlcSwgcmVzKSA9PiB7XG4gIHRyeSB7XG4gICAgLy8gTOG6pXkgdOG7lW5nIGRvYW5oIHRodSAtIMSRw6MgY+G6rXAgbmjhuq10IMSR4buDIHPhu60gZOG7pW5nIHN0YXR1cyBjb3JyZWN0IHbDoCBpc1BhaWRcbiAgICBjb25zdCB0b3RhbFJldmVudWUgPSBhd2FpdCBPcmRlci5hZ2dyZWdhdGUoW1xuICAgICAgeyAkbWF0Y2g6IHsgc3RhdHVzOiBcImNvbXBsZXRlZFwiLCBpc1BhaWQ6IHRydWUgfSB9LFxuICAgICAgeyAkZ3JvdXA6IHsgX2lkOiBudWxsLCB0b3RhbDogeyAkc3VtOiBcIiR0b3RhbEFtb3VudFwiIH0gfSB9LFxuICAgIF0pO1xuXG4gICAgLy8gTOG6pXkgdOG7lW5nIHPhu5EgxJHGoW4gaMOgbmdcbiAgICBjb25zdCB0b3RhbE9yZGVycyA9IGF3YWl0IE9yZGVyLmNvdW50RG9jdW1lbnRzKCk7XG5cbiAgICAvLyBM4bqleSB04buVbmcgc+G7kSBz4bqjbiBwaOG6qW1cbiAgICBjb25zdCB0b3RhbFByb2R1Y3RzID0gYXdhaXQgUHJvZHVjdC5jb3VudERvY3VtZW50cygpO1xuXG4gICAgLy8gTOG6pXkgdOG7lW5nIHPhu5Ega2jDoWNoIGjDoG5nXG4gICAgY29uc3QgdG90YWxDdXN0b21lcnMgPSBhd2FpdCBVc2VyLmNvdW50RG9jdW1lbnRzKCk7XG5cbiAgICAvLyBM4bqleSBkb2FuaCB0aHUgdGhlbyBuZ8OgeSAoNyBuZ8OgeSBn4bqnbiBuaOG6pXQpIC0gc+G7rSBk4bulbmcgY29tcGxldGVkQXQgbuG6v3UgY8OzXG4gICAgY29uc3QgZGFpbHlSZXZlbnVlID0gYXdhaXQgT3JkZXIuYWdncmVnYXRlKFtcbiAgICAgIHsgJG1hdGNoOiB7IHN0YXR1czogXCJjb21wbGV0ZWRcIiwgaXNQYWlkOiB0cnVlIH0gfSxcbiAgICAgIHtcbiAgICAgICAgJGdyb3VwOiB7XG4gICAgICAgICAgX2lkOiB7XG4gICAgICAgICAgICB5ZWFyOiB7ICR5ZWFyOiB7ICRpZk51bGw6IFtcIiRjb21wbGV0ZWRBdFwiLCBcIiR1cGRhdGVkQXRcIl0gfSB9LFxuICAgICAgICAgICAgbW9udGg6IHsgJG1vbnRoOiB7ICRpZk51bGw6IFtcIiRjb21wbGV0ZWRBdFwiLCBcIiR1cGRhdGVkQXRcIl0gfSB9LFxuICAgICAgICAgICAgZGF5OiB7ICRkYXlPZk1vbnRoOiB7ICRpZk51bGw6IFtcIiRjb21wbGV0ZWRBdFwiLCBcIiR1cGRhdGVkQXRcIl0gfSB9LFxuICAgICAgICAgIH0sXG4gICAgICAgICAgcmV2ZW51ZTogeyAkc3VtOiBcIiR0b3RhbEFtb3VudFwiIH0sXG4gICAgICAgICAgb3JkZXJzOiB7ICRzdW06IDEgfSxcbiAgICAgICAgfSxcbiAgICAgIH0sXG4gICAgICB7ICRzb3J0OiB7IFwiX2lkLnllYXJcIjogLTEsIFwiX2lkLm1vbnRoXCI6IC0xLCBcIl9pZC5kYXlcIjogLTEgfSB9LFxuICAgICAgeyAkbGltaXQ6IDcgfSxcbiAgICBdKTtcblxuICAgIC8vIEzhuqV5IGRvYW5oIHRodSB0aGVvIHR14bqnbiAoNCB0deG6p24gZ+G6p24gbmjhuqV0KSAtIHPhu60gZOG7pW5nIGNvbXBsZXRlZEF0IG7hur91IGPDs1xuICAgIGNvbnN0IHdlZWtseVJldmVudWUgPSBhd2FpdCBPcmRlci5hZ2dyZWdhdGUoW1xuICAgICAgeyAkbWF0Y2g6IHsgc3RhdHVzOiBcImNvbXBsZXRlZFwiLCBpc1BhaWQ6IHRydWUgfSB9LFxuICAgICAge1xuICAgICAgICAkZ3JvdXA6IHtcbiAgICAgICAgICBfaWQ6IHtcbiAgICAgICAgICAgIHllYXI6IHsgJHllYXI6IHsgJGlmTnVsbDogW1wiJGNvbXBsZXRlZEF0XCIsIFwiJHVwZGF0ZWRBdFwiXSB9IH0sXG4gICAgICAgICAgICB3ZWVrOiB7ICR3ZWVrOiB7ICRpZk51bGw6IFtcIiRjb21wbGV0ZWRBdFwiLCBcIiR1cGRhdGVkQXRcIl0gfSB9LFxuICAgICAgICAgIH0sXG4gICAgICAgICAgcmV2ZW51ZTogeyAkc3VtOiBcIiR0b3RhbEFtb3VudFwiIH0sXG4gICAgICAgICAgb3JkZXJzOiB7ICRzdW06IDEgfSxcbiAgICAgICAgfSxcbiAgICAgIH0sXG4gICAgICB7ICRzb3J0OiB7IFwiX2lkLnllYXJcIjogLTEsIFwiX2lkLndlZWtcIjogLTEgfSB9LFxuICAgICAgeyAkbGltaXQ6IDQgfSxcbiAgICBdKTtcblxuICAgIC8vIEzhuqV5IGRvYW5oIHRodSB0aGVvIHRow6FuZyAoNiB0aMOhbmcgZ+G6p24gbmjhuqV0KSAtIHPhu60gZOG7pW5nIGNvbXBsZXRlZEF0IG7hur91IGPDs1xuICAgIGNvbnN0IG1vbnRobHlSZXZlbnVlID0gYXdhaXQgT3JkZXIuYWdncmVnYXRlKFtcbiAgICAgIHsgJG1hdGNoOiB7IHN0YXR1czogXCJjb21wbGV0ZWRcIiwgaXNQYWlkOiB0cnVlIH0gfSxcbiAgICAgIHtcbiAgICAgICAgJGdyb3VwOiB7XG4gICAgICAgICAgX2lkOiB7XG4gICAgICAgICAgICB5ZWFyOiB7ICR5ZWFyOiB7ICRpZk51bGw6IFtcIiRjb21wbGV0ZWRBdFwiLCBcIiR1cGRhdGVkQXRcIl0gfSB9LFxuICAgICAgICAgICAgbW9udGg6IHsgJG1vbnRoOiB7ICRpZk51bGw6IFtcIiRjb21wbGV0ZWRBdFwiLCBcIiR1cGRhdGVkQXRcIl0gfSB9LFxuICAgICAgICAgIH0sXG4gICAgICAgICAgcmV2ZW51ZTogeyAkc3VtOiBcIiR0b3RhbEFtb3VudFwiIH0sXG4gICAgICAgICAgb3JkZXJzOiB7ICRzdW06IDEgfSxcbiAgICAgICAgfSxcbiAgICAgIH0sXG4gICAgICB7ICRzb3J0OiB7IFwiX2lkLnllYXJcIjogLTEsIFwiX2lkLm1vbnRoXCI6IC0xIH0gfSxcbiAgICAgIHsgJGxpbWl0OiA2IH0sXG4gICAgXSk7XG5cbiAgICAvLyBM4bqleSB0aOG7kW5nIGvDqiBz4bqjbiBwaOG6qW0gdGhlbyBkYW5oIG3hu6VjXG4gICAgY29uc3QgcHJvZHVjdHNCeUNhdGVnb3J5ID0gYXdhaXQgUHJvZHVjdC5hZ2dyZWdhdGUoW1xuICAgICAge1xuICAgICAgICAkZ3JvdXA6IHtcbiAgICAgICAgICBfaWQ6IFwiJHByb2R1Y3RDYXRlZ29yeVwiLFxuICAgICAgICAgIG5hbWU6IHsgJGZpcnN0OiBcIiRwcm9kdWN0Q2F0ZWdvcnlcIiB9LFxuICAgICAgICAgIHZhbHVlOiB7ICRzdW06IDEgfSxcbiAgICAgICAgfSxcbiAgICAgIH0sXG4gICAgICB7XG4gICAgICAgICRwcm9qZWN0OiB7XG4gICAgICAgICAgX2lkOiAwLFxuICAgICAgICAgIG5hbWU6IDEsXG4gICAgICAgICAgdmFsdWU6IDEsXG4gICAgICAgIH0sXG4gICAgICB9LFxuICAgICAge1xuICAgICAgICAkc29ydDogeyB2YWx1ZTogLTEgfSxcbiAgICAgIH0sXG4gICAgXSk7XG5cbiAgICAvLyBLaOG7n2kgdOG6oW8gYmnhur9uIMSR4buDIGzGsHUga+G6v3QgcXXhuqMgY3Xhu5FpIGPDuW5nXG4gICAgbGV0IGZpbmFsUHJvZHVjdHNCeUNhdGVnb3J5ID0gW107XG5cbiAgICAvLyBUcm9uZyB0csaw4budbmcgaOG7o3Aga2jDtG5nIGPDsyBk4buvIGxp4buHdSBwaMOibiBsb+G6oWlcbiAgICBpZiAoIXByb2R1Y3RzQnlDYXRlZ29yeSB8fCBwcm9kdWN0c0J5Q2F0ZWdvcnkubGVuZ3RoID09PSAwKSB7XG4gICAgICBjb25zb2xlLmxvZyhcIktow7RuZyB0w6xtIHRo4bqleSBk4buvIGxp4buHdSBwaMOibiBsb+G6oWlcIik7XG5cbiAgICAgIGNvbnN0IHRvdGFsUHJvZHVjdHMgPSBhd2FpdCBQcm9kdWN0LmNvdW50RG9jdW1lbnRzKCk7XG4gICAgICBmaW5hbFByb2R1Y3RzQnlDYXRlZ29yeSA9IFtcbiAgICAgICAgeyBuYW1lOiBcIlThuqV0IGPhuqMgc+G6o24gcGjhuqltXCIsIHZhbHVlOiB0b3RhbFByb2R1Y3RzIH0sXG4gICAgICBdO1xuICAgIH0gZWxzZSB7XG4gICAgICBmaW5hbFByb2R1Y3RzQnlDYXRlZ29yeSA9IHByb2R1Y3RzQnlDYXRlZ29yeTtcbiAgICB9XG5cbiAgICAvLyBM4bqleSB0b3AgNSBz4bqjbiBwaOG6qW0gYsOhbiBjaOG6oXlcbiAgICBjb25zdCB0b3BQcm9kdWN0cyA9IGF3YWl0IFByb2R1Y3QuYWdncmVnYXRlKFtcbiAgICAgIHtcbiAgICAgICAgJHByb2plY3Q6IHtcbiAgICAgICAgICBuYW1lOiBcIiRwcm9kdWN0TmFtZVwiLFxuICAgICAgICAgIHNvbGRRdWFudGl0eTogeyAkaWZOdWxsOiBbXCIkc29sZENvdW50XCIsIDBdIH0sIC8vIFPhu60gZOG7pW5nIHRyxrDhu51uZyDEkeG6v20gc+G7kSBsxrDhu6NuZyBiw6FuIG7hur91IGPDs1xuICAgICAgICB9LFxuICAgICAgfSxcbiAgICAgIHtcbiAgICAgICAgJHNvcnQ6IHsgc29sZFF1YW50aXR5OiAtMSB9LFxuICAgICAgfSxcbiAgICAgIHtcbiAgICAgICAgJGxpbWl0OiA1LFxuICAgICAgfSxcbiAgICBdKTtcblxuICAgIC8vIE7hur91IGtow7RuZyBjw7MgZOG7ryBsaeG7h3UgaG/hurdjIGThu68gbGnhu4d1IHRy4buRbmcsIHThuqFvIGThu68gbGnhu4d1IG3huqt1XG4gICAgbGV0IGZpbmFsVG9wUHJvZHVjdHMgPVxuICAgICAgdG9wUHJvZHVjdHMubGVuZ3RoID4gMFxuICAgICAgICA/IHRvcFByb2R1Y3RzXG4gICAgICAgIDogW3sgbmFtZTogXCJDaMawYSBjw7MgZOG7ryBsaeG7h3UgYsOhbiBow6BuZ1wiLCBzb2xkUXVhbnRpdHk6IDAgfV07XG5cbiAgICAvLyBM4bqleSB0aOG7kW5nIGvDqiDEkcahbiBow6BuZyB0aGVvIHRy4bqhbmcgdGjDoWlcbiAgICBjb25zdCBvcmRlcnNCeVN0YXR1cyA9IGF3YWl0IE9yZGVyLmFnZ3JlZ2F0ZShbXG4gICAgICB7XG4gICAgICAgICRncm91cDoge1xuICAgICAgICAgIF9pZDogXCIkc3RhdHVzXCIsXG4gICAgICAgICAgY291bnQ6IHsgJHN1bTogMSB9LFxuICAgICAgICB9LFxuICAgICAgfSxcbiAgICAgIHtcbiAgICAgICAgJHByb2plY3Q6IHtcbiAgICAgICAgICBfaWQ6IDAsXG4gICAgICAgICAgbmFtZTogXCIkX2lkXCIsXG4gICAgICAgICAgdmFsdWU6IFwiJGNvdW50XCIsXG4gICAgICAgIH0sXG4gICAgICB9LFxuICAgIF0pO1xuXG4gICAgY29uc3QgcmVzcG9uc2UgPSB7XG4gICAgICBzdWNjZXNzOiB0cnVlLFxuICAgICAgZGF0YToge1xuICAgICAgICB0b3RhbFJldmVudWU6IHRvdGFsUmV2ZW51ZVswXSAmJiB0b3RhbFJldmVudWVbMF0udG90YWwgPyB0b3RhbFJldmVudWVbMF0udG90YWwgOiAwLFxuICAgICAgICB0b3RhbE9yZGVycyxcbiAgICAgICAgdG90YWxQcm9kdWN0cyxcbiAgICAgICAgdG90YWxDdXN0b21lcnMsXG4gICAgICAgIGRhaWx5UmV2ZW51ZSxcbiAgICAgICAgd2Vla2x5UmV2ZW51ZSxcbiAgICAgICAgbW9udGhseVJldmVudWUsXG4gICAgICAgIHByb2R1Y3RzQnlDYXRlZ29yeTogZmluYWxQcm9kdWN0c0J5Q2F0ZWdvcnksXG4gICAgICAgIG9yZGVyc0J5U3RhdHVzLFxuICAgICAgICB0b3BQcm9kdWN0czogZmluYWxUb3BQcm9kdWN0cyxcbiAgICAgIH0sXG4gICAgfTtcblxuICAgIHJlcy5zdGF0dXMoMjAwKS5qc29uKHJlc3BvbnNlKTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICByZXMuc3RhdHVzKDUwMCkuanNvbih7XG4gICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgIG1lc3NhZ2U6IFwiTOG7l2kgc2VydmVyIGtoaSBs4bqleSB0aOG7kW5nIGvDqlwiLFxuICAgICAgZXJyb3I6IGVycm9yLm1lc3NhZ2UsXG4gICAgfSk7XG4gIH1cbn07XG4iXSwibWFwcGluZ3MiOiI4R0FBQSxJQUFBQSxNQUFBLEdBQUFDLHNCQUFBLENBQUFDLE9BQUE7QUFDQSxJQUFBQyxTQUFBLEdB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QUFDO0lBQ0Q7TUFDRWYsTUFBTSxFQUFFO0lBQ1YsQ0FBQztJQUNGLENBQUM7O0lBRUY7SUFDQSxJQUFJZ0IsZ0JBQWdCO0lBQ2xCRixXQUFXLENBQUNILE1BQU0sR0FBRyxDQUFDO0lBQ2xCRyxXQUFXO0lBQ1gsQ0FBQyxFQUFFUixJQUFJLEVBQUUsMEJBQTBCLEVBQUVTLFlBQVksRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDOztJQUU3RDtJQUNBLE1BQU1FLGNBQWMsR0FBRyxNQUFNM0MsY0FBSyxDQUFDQyxTQUFTLENBQUM7SUFDM0M7TUFDRUksTUFBTSxFQUFFO1FBQ05DLEdBQUcsRUFBRSxTQUFTO1FBQ2RzQyxLQUFLLEVBQUUsRUFBRXBDLElBQUksRUFBRSxDQUFDLENBQUM7TUFDbkI7SUFDRixDQUFDO0lBQ0Q7TUFDRTJCLFFBQVEsRUFBRTtRQUNSN0IsR0FBRyxFQUFFLENBQUM7UUFDTjBCLElBQUksRUFBRSxNQUFNO1FBQ1pFLEtBQUssRUFBRTtNQUNUO0lBQ0YsQ0FBQztJQUNGLENBQUM7O0lBRUYsTUFBTVcsUUFBUSxHQUFHO01BQ2ZDLE9BQU8sRUFBRSxJQUFJO01BQ2JDLElBQUksRUFBRTtRQUNKaEQsWUFBWSxFQUFFQSxZQUFZLENBQUMsQ0FBQyxDQUFDLElBQUlBLFlBQVksQ0FBQyxDQUFDLENBQUMsQ0FBQ1EsS0FBSyxHQUFHUixZQUFZLENBQUMsQ0FBQyxDQUFDLENBQUNRLEtBQUssR0FBRyxDQUFDO1FBQ2xGRSxXQUFXO1FBQ1hFLGFBQWE7UUFDYkUsY0FBYztRQUNkRSxZQUFZO1FBQ1pZLGFBQWE7UUFDYkcsY0FBYztRQUNkQyxrQkFBa0IsRUFBRUssdUJBQXVCO1FBQzNDTyxjQUFjO1FBQ2RILFdBQVcsRUFBRUU7TUFDZjtJQUNGLENBQUM7O0lBRUQ1QyxHQUFHLENBQUNLLE1BQU0sQ0FBQyxHQUFHLENBQUMsQ0FBQzZDLElBQUksQ0FBQ0gsUUFBUSxDQUFDO0VBQ2hDLENBQUMsQ0FBQyxPQUFPSSxLQUFLLEVBQUU7SUFDZG5ELEdBQUcsQ0FBQ0ssTUFBTSxDQUFDLEdBQUcsQ0FBQyxDQUFDNkMsSUFBSSxDQUFDO01BQ25CRixPQUFPLEVBQUUsS0FBSztNQUNkSSxPQUFPLEVBQUUsNkJBQTZCO01BQ3RDRCxLQUFLLEVBQUVBLEtBQUssQ0FBQ0M7SUFDZixDQUFDLENBQUM7RUFDSjtBQUNGLENBQUMsQ0FBQ0MsT0FBQSxDQUFBdkQsaUJBQUEsR0FBQUEsaUJBQUEiLCJpZ25vcmVMaXN0IjpbXX0=