"use strict";Object.defineProperty(exports, "__esModule", { value: true });exports.updateRolePermissions = exports.updateAdmin = exports.getAllAdmins = exports.getAdminProfile = exports.getAdminById = exports.deleteAdmin = exports.createAdmin = exports.adminLogin = void 0;
var _adminModel = _interopRequireDefault(require("../Model/adminModel.js"));
var _jsonwebtoken = _interopRequireDefault(require("jsonwebtoken"));
var _bcryptjs = _interopRequireDefault(require("bcryptjs"));function _interopRequireDefault(e) {return e && e.__esModule ? e : { default: e };} // File: adminAuthController.js

const adminLogin = async (req, res) => {
  try {
    const { userName, password } = req.body;

    // Kiểm tra admin tồn tại
    const admin = await _adminModel.default.findOne({ userName });
    if (!admin) {
      return res.status(404).json({ message: "Tài khoản không tồn tại" });
    }

    // Kiểm tra mật khẩu
    const isMatch = await admin.comparePassword(password);
    if (!isMatch) {
      return res.status(400).json({ message: "Mật khẩu không chính xác" });
    }

    // Kiểm tra tài khoản có active không
    if (!admin.isActive) {
      return res.status(403).json({ message: "Tài khoản đã bị vô hiệu hóa" });
    }

    // Tạo token
    const accessToken = _jsonwebtoken.default.sign(
      {
        id: admin._id,
        role: admin.role,
        permissions: admin.permissions
      },
      process.env.JWT_SECRET,
      { expiresIn: "1h" }
    );

    const refreshToken = _jsonwebtoken.default.sign(
      { id: admin._id },
      process.env.JWT_REFRESH_SECRET,
      { expiresIn: "7d" }
    );

    // Cập nhật last login
    admin.lastLogin = new Date();
    await admin.save();

    res.status(200).json({
      accessToken,
      refreshToken,
      userId: admin._id,
      role: admin.role,
      permissions: admin.permissions,
      fullName: admin.fullName
    });
  } catch (error) {
    res.status(500).json({ message: error.message });
  }
};exports.adminLogin = adminLogin;

const getAdminProfile = async (req, res) => {
  try {
    const admin = await _adminModel.default.findById(req.user.id).select("-password");
    if (!admin) {
      return res.status(404).json({ message: "Admin không tồn tại" });
    }
    res.status(200).json(admin);
  } catch (error) {
    res.status(500).json({ message: error.message });
  }
};

// Hàm helper để lấy quyền mặc định theo role
exports.getAdminProfile = getAdminProfile;const getDefaultPermissions = (role) => {
  switch (role) {
    case "admin":
      return [
      "Thêm",
      "Xem",
      "Sửa",
      "Xóa",
      "Quản lý người dùng",
      "Quản lý sản phẩm",
      "Quản lý đơn hàng",
      "Quản lý danh mục",
      "Quản lý cài đặt"];

    case "manager":
      return [
      "Thêm",
      "Xem",
      "Sửa",
      "Quản lý sản phẩm",
      "Quản lý đơn hàng",
      "Quản lý danh mục"];

    case "staff":
      return [
      "Xem",
      "Thêm",
      "Sửa",
      "Quản lý sản phẩm"];

    default:
      return ["Xem"];
  }
};

const createAdmin = async (req, res) => {
  try {
    const { userName, password, fullName, email, phone, birthday, role } = req.body;

    // Kiểm tra email đã tồn tại
    const existingEmail = await _adminModel.default.findOne({ email });
    if (existingEmail) {
      return res.status(400).json({ message: "Email đã được sử dụng" });
    }

    // Kiểm tra username đã tồn tại
    const existingUsername = await _adminModel.default.findOne({ userName });
    if (existingUsername) {
      return res.status(400).json({ message: "Tên đăng nhập đã được sử dụng" });
    }

    // Tạo admin mới
    const newAdmin = new _adminModel.default({
      userName,
      password,
      fullName,
      email,
      phone,
      birthday,
      role,
      permissions: getDefaultPermissions(role)
    });

    const admin = await newAdmin.save();
    res.status(201).json(admin);
  } catch (error) {
    res.status(500).json({ message: error.message });
  }
};exports.createAdmin = createAdmin;

const getAllAdmins = async (req, res) => {
  try {
    const admins = await _adminModel.default.find().select('-password');
    res.status(200).json(admins);
  } catch (error) {
    res.status(500).json({ message: error.message });
  }
};exports.getAllAdmins = getAllAdmins;

const updateAdmin = async (req, res) => {
  try {
    const { id } = req.params;
    const updateData = { ...req.body };

    // Nếu có thay đổi mật khẩu, hash mật khẩu mới
    if (updateData.password) {
      const salt = await _bcryptjs.default.genSalt(10);
      updateData.password = await _bcryptjs.default.hash(updateData.password, salt);
    }

    // Cập nhật quyền nếu thay đổi role
    if (updateData.role) {
      updateData.permissions = getDefaultPermissions(updateData.role);
    }

    const admin = await _adminModel.default.findByIdAndUpdate(
      id,
      updateData,
      { new: true }
    ).select('-password');

    if (!admin) {
      return res.status(404).json({ message: "Không tìm thấy admin" });
    }

    res.status(200).json(admin);
  } catch (error) {
    res.status(500).json({ message: error.message });
  }
};exports.updateAdmin = updateAdmin;

const deleteAdmin = async (req, res) => {
  try {
    const { id } = req.params;
    const admin = await _adminModel.default.findByIdAndDelete(id);

    if (!admin) {
      return res.status(404).json({ message: "Không tìm thấy admin" });
    }

    res.status(200).json({ message: "Xóa admin thành công" });
  } catch (error) {
    res.status(500).json({ message: error.message });
  }
};exports.deleteAdmin = deleteAdmin;

const getAdminById = async (req, res) => {
  try {
    const { id } = req.params;
    const admin = await _adminModel.default.findById(id).select('-password');

    if (!admin) {
      return res.status(404).json({ message: "Không tìm thấy admin" });
    }

    res.status(200).json(admin);
  } catch (error) {
    res.status(500).json({ message: error.message });
  }
};exports.getAdminById = getAdminById;

const updateRolePermissions = async (req, res) => {
  try {
    const { roleKey } = req.params;
    const { permissions } = req.body;

    // Kiểm tra xem mảng permissions có hợp lệ không
    if (!Array.isArray(permissions)) {
      return res.status(400).json({ message: "Permissions phải là một mảng" });
    }

    // Tìm tất cả admin/manager/employee với roleKey và cập nhật quyền
    const result = await _adminModel.default.updateMany(
      { role: roleKey },
      { $set: { permissions: permissions } }
    );

    // Optional: Log số lượng documents đã được cập nhật
    console.log(`Updated permissions for ${result.modifiedCount} users with role ${roleKey}`);

    res.status(200).json({
      success: true,
      message: `Cập nhật quyền cho vai trò ${roleKey} thành công.`, // Message tiếng Việt
      modifiedCount: result.modifiedCount
    });
  } catch (error) {
    console.error("Error updating role permissions:", error);
    res.status(500).json({ message: "Lỗi server khi cập nhật quyền vai trò" });
  }
};exports.updateRolePermissions = updateRolePermissions;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfYWRtaW5Nb2RlbCIsIl9pbnRlcm9wUmVxdWlyZURlZmF1bHQiLCJyZXF1aXJlIiwiX2pzb253ZWJ0b2tlbiIsIl9iY3J5cHRqcyIsImUiLCJfX2VzTW9kdWxlIiwiZGVmYXVsdCIsImFkbWluTG9naW4iLCJyZXEiLCJyZXMiLCJ1c2VyTmFtZSIsInBhc3N3b3JkIiwiYm9keSIsImFkbWluIiwiQWRtaW4iLCJmaW5kT25lIiwic3RhdHVzIiwianNvbiIsIm1lc3NhZ2UiLCJpc01hdGNoIiwiY29tcGFyZVBhc3N3b3JkIiwiaXNBY3RpdmUiLCJhY2Nlc3NUb2tlbiIsImp3dCIsInNpZ24iLCJpZCIsIl9pZCIsInJvbGUiLCJwZXJtaXNzaW9ucyIsInByb2Nlc3MiLCJlbnYiLCJKV1RfU0VDUkVUIiwiZXhwaXJlc0luIiwicmVmcmVzaFRva2VuIiwiSldUX1JFRlJFU0hfU0VDUkVUIiwibGFzdExvZ2luIiwiRGF0ZSIsInNhdmUiLCJ1c2VySWQiLCJmdWxsTmFtZSIsImVycm9yIiwiZXhwb3J0cyIsImdldEFkbWluUHJvZmlsZSIsImZpbmRCeUlkIiwidXNlciIsInNlbGVjdCIsImdldERlZmF1bHRQZXJtaXNzaW9ucyIsImNyZWF0ZUFkbWluIiwiZW1haWwiLCJwaG9uZSIsImJpcnRoZGF5IiwiZXhpc3RpbmdFbWFpbCIsImV4aXN0aW5nVXNlcm5hbWUiLCJuZXdBZG1pbiIsImdldEFsbEFkbWlucyIsImFkbWlucyIsImZpbmQiLCJ1cGRhdGVBZG1pbiIsInBhcmFtcyIsInVwZGF0ZURhdGEiLCJzYWx0IiwiYmNyeXB0IiwiZ2VuU2FsdCIsImhhc2giLCJmaW5kQnlJZEFuZFVwZGF0ZSIsIm5ldyIsImRlbGV0ZUFkbWluIiwiZmluZEJ5SWRBbmREZWxldGUiLCJnZXRBZG1pbkJ5SWQiLCJ1cGRhdGVSb2xlUGVybWlzc2lvbnMiLCJyb2xlS2V5IiwiQXJyYXkiLCJpc0FycmF5IiwicmVzdWx0IiwidXBkYXRlTWFueSIsIiRzZXQiLCJjb25zb2xlIiwibG9nIiwibW9kaWZpZWRDb3VudCIsInN1Y2Nlc3MiXSwic291cmNlcyI6WyIuLi8uLi8uLi9zcmMvQ29udHJvbGxlci9hZG1pbkNvbnRyb2xsZXIuanMiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gRmlsZTogYWRtaW5BdXRoQ29udHJvbGxlci5qc1xuaW1wb3J0IEFkbWluIGZyb20gXCIuLi9Nb2RlbC9hZG1pbk1vZGVsLmpzXCI7XG5pbXBvcnQgand0IGZyb20gXCJqc29ud2VidG9rZW5cIjtcbmltcG9ydCBiY3J5cHQgZnJvbSBcImJjcnlwdGpzXCI7XG5cbmV4cG9ydCBjb25zdCBhZG1pbkxvZ2luID0gYXN5bmMgKHJlcSwgcmVzKSA9PiB7XG4gIHRyeSB7XG4gICAgY29uc3QgeyB1c2VyTmFtZSwgcGFzc3dvcmQgfSA9IHJlcS5ib2R5O1xuXG4gICAgLy8gS2nhu4NtIHRyYSBhZG1pbiB04buTbiB04bqhaVxuICAgIGNvbnN0IGFkbWluID0gYXdhaXQgQWRtaW4uZmluZE9uZSh7IHVzZXJOYW1lIH0pO1xuICAgIGlmICghYWRtaW4pIHtcbiAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwNCkuanNvbih7IG1lc3NhZ2U6IFwiVMOgaSBraG/huqNuIGtow7RuZyB04buTbiB04bqhaVwiIH0pO1xuICAgIH1cblxuICAgIC8vIEtp4buDbSB0cmEgbeG6rXQga2jhuql1XG4gICAgY29uc3QgaXNNYXRjaCA9IGF3YWl0IGFkbWluLmNvbXBhcmVQYXNzd29yZChwYXNzd29yZCk7XG4gICAgaWYgKCFpc01hdGNoKSB7XG4gICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDApLmpzb24oeyBtZXNzYWdlOiBcIk3huq10IGto4bqpdSBraMO0bmcgY2jDrW5oIHjDoWNcIiB9KTtcbiAgICB9XG5cbiAgICAvLyBLaeG7g20gdHJhIHTDoGkga2hv4bqjbiBjw7MgYWN0aXZlIGtow7RuZ1xuICAgIGlmICghYWRtaW4uaXNBY3RpdmUpIHtcbiAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwMykuanNvbih7IG1lc3NhZ2U6IFwiVMOgaSBraG/huqNuIMSRw6MgYuG7iyB2w7QgaGnhu4d1IGjDs2FcIiB9KTtcbiAgICB9XG5cbiAgICAvLyBU4bqhbyB0b2tlblxuICAgIGNvbnN0IGFjY2Vzc1Rva2VuID0gand0LnNpZ24oXG4gICAgICB7XG4gICAgICAgIGlkOiBhZG1pbi5faWQsXG4gICAgICAgIHJvbGU6IGFkbWluLnJvbGUsXG4gICAgICAgIHBlcm1pc3Npb25zOiBhZG1pbi5wZXJtaXNzaW9ucyxcbiAgICAgIH0sXG4gICAgICBwcm9jZXNzLmVudi5KV1RfU0VDUkVULFxuICAgICAgeyBleHBpcmVzSW46IFwiMWhcIiB9XG4gICAgKTtcblxuICAgIGNvbnN0IHJlZnJlc2hUb2tlbiA9IGp3dC5zaWduKFxuICAgICAgeyBpZDogYWRtaW4uX2lkIH0sXG4gICAgICBwcm9jZXNzLmVudi5KV1RfUkVGUkVTSF9TRUNSRVQsXG4gICAgICB7IGV4cGlyZXNJbjogXCI3ZFwiIH1cbiAgICApO1xuXG4gICAgLy8gQ+G6rXAgbmjhuq10IGxhc3QgbG9naW5cbiAgICBhZG1pbi5sYXN0TG9naW4gPSBuZXcgRGF0ZSgpO1xuICAgIGF3YWl0IGFkbWluLnNhdmUoKTtcblxuICAgIHJlcy5zdGF0dXMoMjAwKS5qc29uKHtcbiAgICAgIGFjY2Vzc1Rva2VuLFxuICAgICAgcmVmcmVzaFRva2VuLFxuICAgICAgdXNlcklkOiBhZG1pbi5faWQsXG4gICAgICByb2xlOiBhZG1pbi5yb2xlLFxuICAgICAgcGVybWlzc2lvbnM6IGFkbWluLnBlcm1pc3Npb25zLFxuICAgICAgZnVsbE5hbWU6IGFkbWluLmZ1bGxOYW1lLFxuICAgIH0pO1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIHJlcy5zdGF0dXMoNTAwKS5qc29uKHsgbWVzc2FnZTogZXJyb3IubWVzc2FnZSB9KTtcbiAgfVxufTtcblxuZXhwb3J0IGNvbnN0IGdldEFkbWluUHJvZmlsZSA9IGFzeW5jIChyZXEsIHJlcykgPT4ge1xuICB0cnkge1xuICAgIGNvbnN0IGFkbWluID0gYXdhaXQgQWRtaW4uZmluZEJ5SWQocmVxLnVzZXIuaWQpLnNlbGVjdChcIi1wYXNzd29yZFwiKTtcbiAgICBpZiAoIWFkbWluKSB7XG4gICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDQpLmpzb24oeyBtZXNzYWdlOiBcIkFkbWluIGtow7RuZyB04buTbiB04bqhaVwiIH0pO1xuICAgIH1cbiAgICByZXMuc3RhdHVzKDIwMCkuanNvbihhZG1pbik7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgcmVzLnN0YXR1cyg1MDApLmpzb24oeyBtZXNzYWdlOiBlcnJvci5tZXNzYWdlIH0pO1xuICB9XG59O1xuXG4vLyBIw6BtIGhlbHBlciDEkeG7gyBs4bqleSBxdXnhu4FuIG3hurdjIMSR4buLbmggdGhlbyByb2xlXG5jb25zdCBnZXREZWZhdWx0UGVybWlzc2lvbnMgPSAocm9sZSkgPT4ge1xuICAgIHN3aXRjaCAocm9sZSkge1xuICAgICAgICBjYXNlIFwiYWRtaW5cIjpcbiAgICAgICAgICAgIHJldHVybiBbXG4gICAgICAgICAgICAgICAgXCJUaMOqbVwiLFxuICAgICAgICAgICAgICAgIFwiWGVtXCIsXG4gICAgICAgICAgICAgICAgXCJT4butYVwiLFxuICAgICAgICAgICAgICAgIFwiWMOzYVwiLFxuICAgICAgICAgICAgICAgIFwiUXXhuqNuIGzDvSBuZ8aw4budaSBkw7luZ1wiLFxuICAgICAgICAgICAgICAgIFwiUXXhuqNuIGzDvSBz4bqjbiBwaOG6qW1cIixcbiAgICAgICAgICAgICAgICBcIlF14bqjbiBsw70gxJHGoW4gaMOgbmdcIixcbiAgICAgICAgICAgICAgICBcIlF14bqjbiBsw70gZGFuaCBt4bulY1wiLFxuICAgICAgICAgICAgICAgIFwiUXXhuqNuIGzDvSBjw6BpIMSR4bq3dFwiXG4gICAgICAgICAgICBdO1xuICAgICAgICBjYXNlIFwibWFuYWdlclwiOlxuICAgICAgICAgICAgcmV0dXJuIFtcbiAgICAgICAgICAgICAgICBcIlRow6ptXCIsXG4gICAgICAgICAgICAgICAgXCJYZW1cIixcbiAgICAgICAgICAgICAgICBcIlPhu61hXCIsXG4gICAgICAgICAgICAgICAgXCJRdeG6o24gbMO9IHPhuqNuIHBo4bqpbVwiLFxuICAgICAgICAgICAgICAgIFwiUXXhuqNuIGzDvSDEkcahbiBow6BuZ1wiLFxuICAgICAgICAgICAgICAgIFwiUXXhuqNuIGzDvSBkYW5oIG3hu6VjXCJcbiAgICAgICAgICAgIF07XG4gICAgICAgIGNhc2UgXCJzdGFmZlwiOlxuICAgICAgICAgICAgcmV0dXJuIFtcbiAgICAgICAgICAgICAgICBcIlhlbVwiLFxuICAgICAgICAgICAgICAgIFwiVGjDqm1cIixcbiAgICAgICAgICAgICAgICBcIlPhu61hXCIsXG4gICAgICAgICAgICAgICAgXCJRdeG6o24gbMO9IHPhuqNuIHBo4bqpbVwiXG4gICAgICAgICAgICBdO1xuICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgcmV0dXJuIFtcIlhlbVwiXTtcbiAgICB9XG59O1xuXG5leHBvcnQgY29uc3QgY3JlYXRlQWRtaW4gPSBhc3luYyAocmVxLCByZXMpID0+IHtcbiAgICB0cnkge1xuICAgICAgICBjb25zdCB7IHVzZXJOYW1lLCBwYXNzd29yZCwgZnVsbE5hbWUsIGVtYWlsLCBwaG9uZSwgYmlydGhkYXksIHJvbGUgfSA9IHJlcS5ib2R5O1xuICAgICAgICBcbiAgICAgICAgLy8gS2nhu4NtIHRyYSBlbWFpbCDEkcOjIHThu5NuIHThuqFpXG4gICAgICAgIGNvbnN0IGV4aXN0aW5nRW1haWwgPSBhd2FpdCBBZG1pbi5maW5kT25lKHsgZW1haWwgfSk7XG4gICAgICAgIGlmIChleGlzdGluZ0VtYWlsKSB7XG4gICAgICAgICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDApLmpzb24oeyBtZXNzYWdlOiBcIkVtYWlsIMSRw6MgxJHGsOG7o2Mgc+G7rSBk4bulbmdcIiB9KTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIEtp4buDbSB0cmEgdXNlcm5hbWUgxJHDoyB04buTbiB04bqhaVxuICAgICAgICBjb25zdCBleGlzdGluZ1VzZXJuYW1lID0gYXdhaXQgQWRtaW4uZmluZE9uZSh7IHVzZXJOYW1lIH0pO1xuICAgICAgICBpZiAoZXhpc3RpbmdVc2VybmFtZSkge1xuICAgICAgICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAwKS5qc29uKHsgbWVzc2FnZTogXCJUw6puIMSRxINuZyBuaOG6rXAgxJHDoyDEkcaw4bujYyBz4butIGThu6VuZ1wiIH0pO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gVOG6oW8gYWRtaW4gbeG7m2lcbiAgICAgICAgY29uc3QgbmV3QWRtaW4gPSBuZXcgQWRtaW4oe1xuICAgICAgICAgICAgdXNlck5hbWUsXG4gICAgICAgICAgICBwYXNzd29yZCxcbiAgICAgICAgICAgIGZ1bGxOYW1lLFxuICAgICAgICAgICAgZW1haWwsXG4gICAgICAgICAgICBwaG9uZSxcbiAgICAgICAgICAgIGJpcnRoZGF5LFxuICAgICAgICAgICAgcm9sZSxcbiAgICAgICAgICAgIHBlcm1pc3Npb25zOiBnZXREZWZhdWx0UGVybWlzc2lvbnMocm9sZSlcbiAgICAgICAgfSk7XG5cbiAgICAgICAgY29uc3QgYWRtaW4gPSBhd2FpdCBuZXdBZG1pbi5zYXZlKCk7XG4gICAgICAgIHJlcy5zdGF0dXMoMjAxKS5qc29uKGFkbWluKTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICByZXMuc3RhdHVzKDUwMCkuanNvbih7IG1lc3NhZ2U6IGVycm9yLm1lc3NhZ2UgfSk7XG4gICAgfVxufTtcblxuZXhwb3J0IGNvbnN0IGdldEFsbEFkbWlucyA9IGFzeW5jIChyZXEsIHJlcykgPT4ge1xuICAgIHRyeSB7XG4gICAgICAgIGNvbnN0IGFkbWlucyA9IGF3YWl0IEFkbWluLmZpbmQoKS5zZWxlY3QoJy1wYXNzd29yZCcpO1xuICAgICAgICByZXMuc3RhdHVzKDIwMCkuanNvbihhZG1pbnMpO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgIHJlcy5zdGF0dXMoNTAwKS5qc29uKHsgbWVzc2FnZTogZXJyb3IubWVzc2FnZSB9KTtcbiAgICB9XG59O1xuXG5leHBvcnQgY29uc3QgdXBkYXRlQWRtaW4gPSBhc3luYyAocmVxLCByZXMpID0+IHtcbiAgICB0cnkge1xuICAgICAgICBjb25zdCB7IGlkIH0gPSByZXEucGFyYW1zO1xuICAgICAgICBjb25zdCB1cGRhdGVEYXRhID0geyAuLi5yZXEuYm9keSB9O1xuICAgICAgICBcbiAgICAgICAgLy8gTuG6v3UgY8OzIHRoYXkgxJHhu5VpIG3huq10IGto4bqpdSwgaGFzaCBt4bqtdCBraOG6qXUgbeG7m2lcbiAgICAgICAgaWYgKHVwZGF0ZURhdGEucGFzc3dvcmQpIHtcbiAgICAgICAgICAgIGNvbnN0IHNhbHQgPSBhd2FpdCBiY3J5cHQuZ2VuU2FsdCgxMCk7XG4gICAgICAgICAgICB1cGRhdGVEYXRhLnBhc3N3b3JkID0gYXdhaXQgYmNyeXB0Lmhhc2godXBkYXRlRGF0YS5wYXNzd29yZCwgc2FsdCk7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBD4bqtcCBuaOG6rXQgcXV54buBbiBu4bq/dSB0aGF5IMSR4buVaSByb2xlXG4gICAgICAgIGlmICh1cGRhdGVEYXRhLnJvbGUpIHtcbiAgICAgICAgICAgIHVwZGF0ZURhdGEucGVybWlzc2lvbnMgPSBnZXREZWZhdWx0UGVybWlzc2lvbnModXBkYXRlRGF0YS5yb2xlKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IGFkbWluID0gYXdhaXQgQWRtaW4uZmluZEJ5SWRBbmRVcGRhdGUoXG4gICAgICAgICAgICBpZCxcbiAgICAgICAgICAgIHVwZGF0ZURhdGEsXG4gICAgICAgICAgICB7IG5ldzogdHJ1ZSB9XG4gICAgICAgICkuc2VsZWN0KCctcGFzc3dvcmQnKTtcblxuICAgICAgICBpZiAoIWFkbWluKSB7XG4gICAgICAgICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDQpLmpzb24oeyBtZXNzYWdlOiBcIktow7RuZyB0w6xtIHRo4bqleSBhZG1pblwiIH0pO1xuICAgICAgICB9XG5cbiAgICAgICAgcmVzLnN0YXR1cygyMDApLmpzb24oYWRtaW4pO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgIHJlcy5zdGF0dXMoNTAwKS5qc29uKHsgbWVzc2FnZTogZXJyb3IubWVzc2FnZSB9KTtcbiAgICB9XG59O1xuXG5leHBvcnQgY29uc3QgZGVsZXRlQWRtaW4gPSBhc3luYyAocmVxLCByZXMpID0+IHtcbiAgICB0cnkge1xuICAgICAgICBjb25zdCB7IGlkIH0gPSByZXEucGFyYW1zO1xuICAgICAgICBjb25zdCBhZG1pbiA9IGF3YWl0IEFkbWluLmZpbmRCeUlkQW5kRGVsZXRlKGlkKTtcbiAgICAgICAgXG4gICAgICAgIGlmICghYWRtaW4pIHtcbiAgICAgICAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwNCkuanNvbih7IG1lc3NhZ2U6IFwiS2jDtG5nIHTDrG0gdGjhuqV5IGFkbWluXCIgfSk7XG4gICAgICAgIH1cblxuICAgICAgICByZXMuc3RhdHVzKDIwMCkuanNvbih7IG1lc3NhZ2U6IFwiWMOzYSBhZG1pbiB0aMOgbmggY8O0bmdcIiB9KTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICByZXMuc3RhdHVzKDUwMCkuanNvbih7IG1lc3NhZ2U6IGVycm9yLm1lc3NhZ2UgfSk7XG4gICAgfVxufTtcblxuZXhwb3J0IGNvbnN0IGdldEFkbWluQnlJZCA9IGFzeW5jIChyZXEsIHJlcykgPT4ge1xuICAgIHRyeSB7XG4gICAgICAgIGNvbnN0IHsgaWQgfSA9IHJlcS5wYXJhbXM7XG4gICAgICAgIGNvbnN0IGFkbWluID0gYXdhaXQgQWRtaW4uZmluZEJ5SWQoaWQpLnNlbGVjdCgnLXBhc3N3b3JkJyk7XG4gICAgICAgIFxuICAgICAgICBpZiAoIWFkbWluKSB7XG4gICAgICAgICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDQpLmpzb24oeyBtZXNzYWdlOiBcIktow7RuZyB0w6xtIHRo4bqleSBhZG1pblwiIH0pO1xuICAgICAgICB9XG5cbiAgICAgICAgcmVzLnN0YXR1cygyMDApLmpzb24oYWRtaW4pO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgIHJlcy5zdGF0dXMoNTAwKS5qc29uKHsgbWVzc2FnZTogZXJyb3IubWVzc2FnZSB9KTtcbiAgICB9XG59O1xuXG5leHBvcnQgY29uc3QgdXBkYXRlUm9sZVBlcm1pc3Npb25zID0gYXN5bmMgKHJlcSwgcmVzKSA9PiB7XG4gIHRyeSB7XG4gICAgY29uc3QgeyByb2xlS2V5IH0gPSByZXEucGFyYW1zO1xuICAgIGNvbnN0IHsgcGVybWlzc2lvbnMgfSA9IHJlcS5ib2R5O1xuXG4gICAgLy8gS2nhu4NtIHRyYSB4ZW0gbeG6o25nIHBlcm1pc3Npb25zIGPDsyBo4bujcCBs4buHIGtow7RuZ1xuICAgIGlmICghQXJyYXkuaXNBcnJheShwZXJtaXNzaW9ucykpIHtcbiAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwMCkuanNvbih7IG1lc3NhZ2U6IFwiUGVybWlzc2lvbnMgcGjhuqNpIGzDoCBt4buZdCBt4bqjbmdcIiB9KTtcbiAgICB9XG5cbiAgICAvLyBUw6xtIHThuqV0IGPhuqMgYWRtaW4vbWFuYWdlci9lbXBsb3llZSB24bubaSByb2xlS2V5IHbDoCBj4bqtcCBuaOG6rXQgcXV54buBblxuICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IEFkbWluLnVwZGF0ZU1hbnkoXG4gICAgICB7IHJvbGU6IHJvbGVLZXkgfSxcbiAgICAgIHsgJHNldDogeyBwZXJtaXNzaW9uczogcGVybWlzc2lvbnMgfSB9XG4gICAgKTtcblxuICAgIC8vIE9wdGlvbmFsOiBMb2cgc+G7kSBsxrDhu6NuZyBkb2N1bWVudHMgxJHDoyDEkcaw4bujYyBj4bqtcCBuaOG6rXRcbiAgICBjb25zb2xlLmxvZyhgVXBkYXRlZCBwZXJtaXNzaW9ucyBmb3IgJHtyZXN1bHQubW9kaWZpZWRDb3VudH0gdXNlcnMgd2l0aCByb2xlICR7cm9sZUtleX1gKTtcblxuICAgIHJlcy5zdGF0dXMoMjAwKS5qc29uKHtcbiAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICBtZXNzYWdlOiBgQ+G6rXAgbmjhuq10IHF1eeG7gW4gY2hvIHZhaSB0csOyICR7cm9sZUtleX0gdGjDoG5oIGPDtG5nLmAsIC8vIE1lc3NhZ2UgdGnhur9uZyBWaeG7h3RcbiAgICAgIG1vZGlmaWVkQ291bnQ6IHJlc3VsdC5tb2RpZmllZENvdW50LFxuICAgIH0pO1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoXCJFcnJvciB1cGRhdGluZyByb2xlIHBlcm1pc3Npb25zOlwiLCBlcnJvcik7XG4gICAgcmVzLnN0YXR1cyg1MDApLmpzb24oeyBtZXNzYWdlOiBcIkzhu5dpIHNlcnZlciBraGkgY+G6rXAgbmjhuq10IHF1eeG7gW4gdmFpIHRyw7JcIiB9KTtcbiAgfVxufTsiXSwibWFwcGluZ3MiOiI7QUFDQSxJQUFBQSxXQUFBLEdBQUFDLHNCQUFBLENBQUFDLE9BQUE7QUFDQSxJQUFBQyxhQUFBLEdBQUFGLHNCQUFBLENBQUFDLE9BQUE7QUFDQSxJQUFBRSxTQUFBLEdBQUFILHNCQUFBLENBQUFDLE9BQUEsY0FBOEIsU0FBQUQsdUJBQUFJLENBQUEsVUFBQUEsQ0FBQSxJQUFBQSxDQUFBLENBQUFDLFVBQUEsR0FBQUQsQ0FBQSxLQUFBRSxPQUFBLEVBQUFGLENBQUEsS0FIOUI7O0FBS08sTUFBTUcsVUFBVSxHQUFHLE1BQUFBLENBQU9DLEdBQUcsRUFBRUMsR0FBRyxLQUFLO0VBQzVDLElBQUk7SUFDRixNQUFNLEVBQUVDLFFBQVEsRUFBRUMsUUFBUSxDQUFDLENBQUMsR0FBR0gsR0FBRyxDQUFDSSxJQUFJOztJQUV2QztJQUNBLE1BQU1DLEtBQUssR0FBRyxNQUFNQyxtQkFBSyxDQUFDQyxPQUFPLENBQUMsRUFBRUwsUUFBUSxDQUFDLENBQUMsQ0FBQztJQUMvQyxJQUFJLENBQUNHLEtBQUssRUFBRTtNQUNWLE9BQU9KLEdBQUcsQ0FBQ08sTUFBTSxDQUFDLEdBQUcsQ0FBQyxDQUFDQyxJQUFJLENBQUMsRUFBRUMsT0FBTyxFQUFFLHlCQUF5QixDQUFDLENBQUMsQ0FB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