"use strict";Object.defineProperty(exports, "__esModule", { value: true });exports.getBestSellingProducts = void 0;var _BestSellingProduct = _interopRequireDefault(require("../Model/BestSellingProduct.js"));function _interopRequireDefault(e) {return e && e.__esModule ? e : { default: e };}

// Get best selling products
const getBestSellingProducts = async (req, res) => {
  try {
    const limit = parseInt(req.query.limit) || 4;
    const period = req.query.period || 'month'; // Default to monthly best sellers

    // Get best selling products
    const bestSellers = await _BestSellingProduct.default.getBestSellers(limit, period);

    // Map to ensure we have the complete product data
    const products = bestSellers.map((item) => {
      if (item.productId) {
        return {
          _id: item.productId._id,
          productName: item.productId.productName,
          productPrice: item.productId.productPrice,
          productStatus: item.productId.productStatus,
          productImages: item.productId.productImages,
          productCategory: item.productCategory,
          productDiscount: item.productId.productDiscount || 0,
          soldCount: item.soldCount
        };
      }
      return null;
    }).filter(Boolean); // Remove any null entries

    return res.status(200).json(products);
  } catch (error) {
    console.error("Error retrieving best selling products:", error);
    return res.status(500).json({ message: "Internal server error" });
  }
};exports.getBestSellingProducts = getBestSellingProducts;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfQmVzdFNlbGxpbmdQcm9kdWN0IiwiX2ludGVyb3BSZXF1aXJlRGVmYXVsdCIsInJlcXVpcmUiLCJlIiwiX19lc01vZHVsZSIsImRlZmF1bHQiLCJnZXRCZXN0U2VsbGluZ1Byb2R1Y3RzIiwicmVxIiwicmVzIiwibGltaXQiLCJwYXJzZUludCIsInF1ZXJ5IiwicGVyaW9kIiwiYmVzdFNlbGxlcnMiLCJCZXN0U2VsbGluZ1Byb2R1Y3QiLCJnZXRCZXN0U2VsbGVycyIsInByb2R1Y3RzIiwibWFwIiwiaXRlbSIsInByb2R1Y3RJZCIsIl9pZCIsInByb2R1Y3ROYW1lIiwicHJvZHVjdFByaWNlIiwicHJvZHVjdFN0YXR1cyIsInByb2R1Y3RJbWFnZXMiLCJwcm9kdWN0Q2F0ZWdvcnkiLCJwcm9kdWN0RGlzY291bnQiLCJzb2xkQ291bnQiLCJmaWx0ZXIiLCJCb29sZWFuIiwic3RhdHVzIiwianNvbiIsImVycm9yIiwiY29uc29sZSIsIm1lc3NhZ2UiLCJleHBvcnRzIl0sInNvdXJjZXMiOlsiLi4vLi4vLi4vc3JjL0NvbnRyb2xsZXIvUHJvZHVjdENvbnRyb2xsZXIuanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IEJlc3RTZWxsaW5nUHJvZHVjdCBmcm9tIFwiLi4vTW9kZWwvQmVzdFNlbGxpbmdQcm9kdWN0LmpzXCI7XG5cbi8vIEdldCBiZXN0IHNlbGxpbmcgcHJvZHVjdHNcbmV4cG9ydCBjb25zdCBnZXRCZXN0U2VsbGluZ1Byb2R1Y3RzID0gYXN5bmMgKHJlcSwgcmVzKSA9PiB7XG4gIHRyeSB7XG4gICAgY29uc3QgbGltaXQgPSBwYXJzZUludChyZXEucXVlcnkubGltaXQpIHx8IDQ7XG4gICAgY29uc3QgcGVyaW9kID0gcmVxLnF1ZXJ5LnBlcmlvZCB8fCAnbW9udGgnOyAvLyBEZWZhdWx0IHRvIG1vbnRobHkgYmVzdCBzZWxsZXJzXG4gICAgXG4gICAgLy8gR2V0IGJlc3Qgc2VsbGluZyBwcm9kdWN0c1xuICAgIGNvbnN0IGJlc3RTZWxsZXJzID0gYXdhaXQgQmVzdFNlbGxpbmdQcm9kdWN0LmdldEJlc3RTZWxsZXJzKGxpbWl0LCBwZXJpb2QpO1xuICAgIFxuICAgIC8vIE1hcCB0byBlbnN1cmUgd2UgaGF2ZSB0aGUgY29tcGxldGUgcHJvZHVjdCBkYXRhXG4gICAgY29uc3QgcHJvZHVjdHMgPSBiZXN0U2VsbGVycy5tYXAoaXRlbSA9PiB7XG4gICAgICBpZiAoaXRlbS5wcm9kdWN0SWQpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICBfaWQ6IGl0ZW0ucHJvZHVjdElkLl9pZCxcbiAgICAgICAgICBwcm9kdWN0TmFtZTogaXRlbS5wcm9kdWN0SWQucHJvZHVjdE5hbWUsXG4gICAgICAgICAgcHJvZHVjdFByaWNlOiBpdGVtLnByb2R1Y3RJZC5wcm9kdWN0UHJpY2UsXG4gICAgICAgICAgcHJvZHVjdFN0YXR1czogaXRlbS5wcm9kdWN0SWQucHJvZHVjdFN0YXR1cyxcbiAgICAgICAgICBwcm9kdWN0SW1hZ2VzOiBpdGVtLnByb2R1Y3RJZC5wcm9kdWN0SW1hZ2VzLFxuICAgICAgICAgIHByb2R1Y3RDYXRlZ29yeTogaXRlbS5wcm9kdWN0Q2F0ZWdvcnksXG4gICAgICAgICAgcHJvZHVjdERpc2NvdW50OiBpdGVtLnByb2R1Y3RJZC5wcm9kdWN0RGlzY291bnQgfHwgMCxcbiAgICAgICAgICBzb2xkQ291bnQ6IGl0ZW0uc29sZENvdW50XG4gICAgICAgIH07XG4gICAgICB9XG4gICAgICByZXR1cm4gbnVsbDtcbiAgICB9KS5maWx0ZXIoQm9vbGVhbik7IC8vIFJlbW92ZSBhbnkgbnVsbCBlbnRyaWVzXG4gICAgXG4gICAgcmV0dXJuIHJlcy5zdGF0dXMoMjAwKS5qc29uKHByb2R1Y3RzKTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKFwiRXJyb3IgcmV0cmlldmluZyBiZXN0IHNlbGxpbmcgcHJvZHVjdHM6XCIsIGVycm9yKTtcbiAgICByZXR1cm4gcmVzLnN0YXR1cyg1MDApLmpzb24oeyBtZXNzYWdlOiBcIkludGVybmFsIHNlcnZlciBlcnJvclwiIH0pO1xuICB9XG59OyAiXSwibWFwcGluZ3MiOiJtSEFBQSxJQUFBQSxtQkFBQSxHQUFBQyxzQkFBQSxDQUFBQyxPQUFBLG9DQUFnRSxTQUFBRCx1QkFBQUUsQ0FBQSxVQUFBQSxDQUFBLElBQUFBLENBQUEsQ0FBQUMsVUFBQSxHQUFBRCxDQUFBLEtBQUFFLE9BQUEsRUFBQUYsQ0FBQTs7QUFFaEU7QUFDTyxNQUFNRyxzQkFBc0IsR0FBRyxNQUFBQSxDQUFPQyxHQUFHLEVBQUVDLEdBQUcsS0FBSztFQUN4RCxJQUFJO0lBQ0YsTUFBTUMsS0FBSyxHQUFHQyxRQUFRLENBQUNILEdBQUcsQ0FBQ0ksS0FBSyxDQUFDRixLQUFLLENBQUMsSUFBSSxDQUFDO0lBQzVDLE1BQU1HLE1BQU0sR0FBR0wsR0FBRyxDQUFDSSxLQUFLLENBQUNDLE1BQU0sSUFBSSxPQUFPLENBQUMsQ0FBQzs7SUFFNUM7SUFDQSxNQUFNQyxXQUFXLEdBQUcsTUFBTUMsMkJBQWtCLENBQUNDLGNBQWMsQ0FBQ04sS0FBSyxFQUFFRyxNQUFNLENBQUM7O0lBRTFFO0lBQ0EsTUFBTUksUUFBUSxHQUFHSCxXQUFXLENBQUNJLEdBQUcsQ0FBQyxDQUFBQyxJQUFJLEtBQUk7TUFDdkMsSUFBSUEsSUFBSSxDQUFDQyxTQUFTLEVBQUU7UUFDbEIsT0FBTztVQUNMQyxHQUFHLEVBQUVGLElBQUksQ0FBQ0MsU0FBUyxDQUFDQyxHQUFHO1VBQ3ZCQyxXQUFXLEVBQUVILElBQUksQ0FBQ0MsU0FBUyxDQUFDRSxXQUFXO1VBQ3ZDQyxZQUFZLEVBQUVKLElBQUksQ0FBQ0MsU0FBUyxDQUFDRyxZQUFZO1VBQ3pDQyxhQUFhLEVBQUVMLElBQUksQ0FBQ0MsU0FBUyxDQUFDSSxhQUFhO1VBQzNDQyxhQUFhLEVBQUVOLElBQUksQ0FBQ0MsU0FBUyxDQUFDSyxhQUFhO1VBQzNDQyxlQUFlLEVBQUVQLElBQUksQ0FBQ08sZUFBZTtVQUNyQ0MsZUFBZSxFQUFFUixJQUFJLENBQUNDLFNBQVMsQ0FBQ08sZUFBZSxJQUFJLENBQUM7VUFDcERDLFNBQVMsRUFBRVQsSUFBSSxDQUFDUztRQUNsQixDQUFDO01BQ0g7TUFDQSxPQUFPLElBQUk7SUFDYixDQUFDLENBQUMsQ0FBQ0MsTUFBTSxDQUFDQyxPQUFPLENBQUMsQ0FBQyxDQUFDOztJQUVwQixPQUFPckIsR0FBRyxDQUFDc0IsTUFBTSxDQUFDLEdBQUcsQ0FBQyxDQUFDQyxJQUFJLENBQUNmLFFBQVEsQ0FBQztFQUN2QyxDQUFDLENBQUMsT0FBT2dCLEtBQUssRUFBRTtJQUNkQyxPQUFPLENBQUNELEtBQUssQ0FBQyx5Q0FBeUMsRUFBRUEsS0FBSyxDQUFDO0lBQy9ELE9BQU94QixHQUFHLENBQUNzQixNQUFNLENBQUMsR0FBRyxDQUFDLENBQUNDLElBQUksQ0FBQyxFQUFFRyxPQUFPLEVBQUUsdUJBQXVCLENBQUMsQ0FBQyxDQUFDO0VBQ25FO0FBQ0YsQ0FBQyxDQUFDQyxPQUFBLENBQUE3QixzQkFBQSxHQUFBQSxzQkFBQSIsImlnbm9yZUxpc3QiOltdfQ==