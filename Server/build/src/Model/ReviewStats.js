"use strict";Object.defineProperty(exports, "__esModule", { value: true });exports.default = void 0;var _mongoose = _interopRequireDefault(require("mongoose"));function _interopRequireDefault(e) {return e && e.__esModule ? e : { default: e };}

const ReviewStatsSchema = new _mongoose.default.Schema(
  {
    productId: {
      type: _mongoose.default.Schema.Types.ObjectId,
      ref: "Product",
      required: true,
      unique: true
    },
    averageRating: {
      type: Number,
      default: 0,
      min: 0,
      max: 5
    },
    ratingDistribution: {
      1: { type: Number, default: 0 }, // 1 star count
      2: { type: Number, default: 0 }, // 2 star count
      3: { type: Number, default: 0 }, // 3 star count
      4: { type: Number, default: 0 }, // 4 star count
      5: { type: Number, default: 0 } // 5 star count
    },
    totalReviews: {
      type: Number,
      default: 0
    },
    verifiedReviews: {
      type: Number,
      default: 0
    },
    lastUpdated: {
      type: Date,
      default: Date.now
    }
  },
  { timestamps: true }
);

// Tạo index cho việc tìm kiếm nhanh hơn
ReviewStatsSchema.index({ productId: 1 });
ReviewStatsSchema.index({ averageRating: -1 });
ReviewStatsSchema.index({ totalReviews: -1 });

// Static method để cập nhật thống kê đánh giá cho một sản phẩm
ReviewStatsSchema.statics.updateReviewStats = async function (productId) {
  try {
    // Lấy thông tin từ model Review
    const Review = _mongoose.default.model("Review");

    // Tìm tất cả đánh giá đã công khai cho sản phẩm này
    const reviews = await Review.find({
      productId: productId,
      isPublished: true
    });

    // Nếu không có đánh giá nào, xóa thống kê nếu tồn tại
    if (!reviews || reviews.length === 0) {
      await this.findOneAndDelete({ productId });
      // Cập nhật Product với averageRating = 0
      await _mongoose.default.model("Product").findByIdAndUpdate(productId, {
        averageRating: 0,
        numOfReviews: 0
      });
      return;
    }

    // Tính toán thống kê
    const totalReviews = reviews.length;
    const ratingSum = reviews.reduce((sum, review) => sum + review.rating, 0);
    const averageRating = ratingSum / totalReviews;
    const verifiedReviews = reviews.filter((review) => review.isVerified).length;

    // Tạo phân phối đánh giá
    const ratingDistribution = {
      1: 0, 2: 0, 3: 0, 4: 0, 5: 0
    };

    reviews.forEach((review) => {
      if (review.rating >= 1 && review.rating <= 5) {
        ratingDistribution[Math.floor(review.rating)]++;
      }
    });

    // Cập nhật hoặc tạo mới thống kê
    const stats = await this.findOneAndUpdate(
      { productId },
      {
        averageRating,
        ratingDistribution,
        totalReviews,
        verifiedReviews,
        lastUpdated: new Date()
      },
      { new: true, upsert: true }
    );

    // Cập nhật trực tiếp vào model Product
    await _mongoose.default.model("Product").findByIdAndUpdate(productId, {
      averageRating: averageRating,
      numOfReviews: totalReviews
    });

    return stats;
  } catch (error) {
    console.error("Lỗi khi cập nhật thống kê đánh giá:", error);
    throw error;
  }
};

// Tính toán thống kê theo thang điểm 5 sao
ReviewStatsSchema.methods.getStarPercentages = function () {
  const total = this.totalReviews || 1; // Tránh chia cho 0

  return {
    oneStar: Math.round(this.ratingDistribution[1] / total * 100),
    twoStar: Math.round(this.ratingDistribution[2] / total * 100),
    threeStar: Math.round(this.ratingDistribution[3] / total * 100),
    fourStar: Math.round(this.ratingDistribution[4] / total * 100),
    fiveStar: Math.round(this.ratingDistribution[5] / total * 100)
  };
};

// Middleware để tính toán đánh giá khi có sự thay đổi trong Review
ReviewStatsSchema.statics.recalculateStats = async function (productId) {
  return await this.updateReviewStats(productId);
};

const ReviewStats = _mongoose.default.model("ReviewStats", ReviewStatsSchema);var _default = exports.default =

ReviewStats;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfbW9uZ29vc2UiLCJfaW50ZXJvcFJlcXVpcmVEZWZhdWx0IiwicmVxdWlyZSIsImUiLCJfX2VzTW9kdWxlIiwiZGVmYXVsdCIsIlJldmlld1N0YXRzU2NoZW1hIiwibW9uZ29vc2UiLCJTY2hlbWEiLCJwcm9kdWN0SWQiLCJ0eXBlIiwiVHlwZXMiLCJPYmplY3RJZCIsInJlZiIsInJlcXVpcmVkIiwidW5pcXVlIiwiYXZlcmFnZVJhdGluZyIsIk51bWJlciIsIm1pbiIsIm1heCIsInJhdGluZ0Rpc3RyaWJ1dGlvbiIsInRvdGFsUmV2aWV3cyIsInZlcmlmaWVkUmV2aWV3cyIsImxhc3RVcGRhdGVkIiwiRGF0ZSIsIm5vdyIsInRpbWVzdGFtcHMiLCJpbmRleCIsInN0YXRpY3MiLCJ1cGRhdGVSZXZpZXdTdGF0cyIsIlJldmlldyIsIm1vZGVsIiwicmV2aWV3cyIsImZpbmQiLCJpc1B1Ymxpc2hlZCIsImxlbmd0aCIsImZpbmRPbmVBbmREZWxldGUiLCJmaW5kQnlJZEFuZFVwZGF0ZSIsIm51bU9mUmV2aWV3cyIsInJhdGluZ1N1bSIsInJlZHVjZSIsInN1bSIsInJldmlldyIsInJhdGluZyIsImZpbHRlciIsImlzVmVyaWZpZWQiLCJmb3JFYWNoIiwiTWF0aCIsImZsb29yIiwic3RhdHMiLCJmaW5kT25lQW5kVXBkYXRlIiwibmV3IiwidXBzZXJ0IiwiZXJyb3IiLCJjb25zb2xlIiwibWV0aG9kcyIsImdldFN0YXJQZXJjZW50YWdlcyIsInRvdGFsIiwib25lU3RhciIsInJvdW5kIiwidHdvU3RhciIsInRocmVlU3RhciIsImZvdXJTdGFyIiwiZml2ZVN0YXIiLCJyZWNhbGN1bGF0ZVN0YXRzIiwiUmV2aWV3U3RhdHMiLCJfZGVmYXVsdCIsImV4cG9ydHMiXSwic291cmNlcyI6WyIuLi8uLi8uLi9zcmMvTW9kZWwvUmV2aWV3U3RhdHMuanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IG1vbmdvb3NlIGZyb20gXCJtb25nb29zZVwiO1xyXG5cclxuY29uc3QgUmV2aWV3U3RhdHNTY2hlbWEgPSBuZXcgbW9uZ29vc2UuU2NoZW1hKFxyXG4gIHtcclxuICAgIHByb2R1Y3RJZDoge1xyXG4gICAgICB0eXBlOiBtb25nb29zZS5TY2hlbWEuVHlwZXMuT2JqZWN0SWQsXHJcbiAgICAgIHJlZjogXCJQcm9kdWN0XCIsXHJcbiAgICAgIHJlcXVpcmVkOiB0cnVlLFxyXG4gICAgICB1bmlxdWU6IHRydWVcclxuICAgIH0sXHJcbiAgICBhdmVyYWdlUmF0aW5nOiB7XHJcbiAgICAgIHR5cGU6IE51bWJlcixcclxuICAgICAgZGVmYXVsdDogMCxcclxuICAgICAgbWluOiAwLFxyXG4gICAgICBtYXg6IDVcclxuICAgIH0sXHJcbiAgICByYXRpbmdEaXN0cmlidXRpb246IHtcclxuICAgICAgMTogeyB0eXBlOiBOdW1iZXIsIGRlZmF1bHQ6IDAgfSwgLy8gMSBzdGFyIGNvdW50XHJcbiAgICAgIDI6IHsgdHlwZTogTnVtYmVyLCBkZWZhdWx0OiAwIH0sIC8vIDIgc3RhciBjb3VudFxyXG4gICAgICAzOiB7IHR5cGU6IE51bWJlciwgZGVmYXVsdDogMCB9LCAvLyAzIHN0YXIgY291bnRcclxuICAgICAgNDogeyB0eXBlOiBOdW1iZXIsIGRlZmF1bHQ6IDAgfSwgLy8gNCBzdGFyIGNvdW50XHJcbiAgICAgIDU6IHsgdHlwZTogTnVtYmVyLCBkZWZhdWx0OiAwIH0gIC8vIDUgc3RhciBjb3VudFxyXG4gICAgfSxcclxuICAgIHRvdGFsUmV2aWV3czoge1xyXG4gICAgICB0eXBlOiBOdW1iZXIsXHJcbiAgICAgIGRlZmF1bHQ6IDBcclxuICAgIH0sXHJcbiAgICB2ZXJpZmllZFJldmlld3M6IHtcclxuICAgICAgdHlwZTogTnVtYmVyLFxyXG4gICAgICBkZWZhdWx0OiAwXHJcbiAgICB9LFxyXG4gICAgbGFzdFVwZGF0ZWQ6IHtcclxuICAgICAgdHlwZTogRGF0ZSxcclxuICAgICAgZGVmYXVsdDogRGF0ZS5ub3dcclxuICAgIH1cclxuICB9LFxyXG4gIHsgdGltZXN0YW1wczogdHJ1ZSB9XHJcbik7XHJcblxyXG4vLyBU4bqhbyBpbmRleCBjaG8gdmnhu4djIHTDrG0ga2nhur9tIG5oYW5oIGjGoW5cclxuUmV2aWV3U3RhdHNTY2hlbWEuaW5kZXgoeyBwcm9kdWN0SWQ6IDEgfSk7XHJcblJldmlld1N0YXRzU2NoZW1hLmluZGV4KHsgYXZlcmFnZVJhdGluZzogLTEgfSk7XHJcblJldmlld1N0YXRzU2NoZW1hLmluZGV4KHsgdG90YWxSZXZpZXdzOiAtMSB9KTtcclxuXHJcbi8vIFN0YXRpYyBtZXRob2QgxJHhu4MgY+G6rXAgbmjhuq10IHRo4buRbmcga8OqIMSRw6FuaCBnacOhIGNobyBt4buZdCBz4bqjbiBwaOG6qW1cclxuUmV2aWV3U3RhdHNTY2hlbWEuc3RhdGljcy51cGRhdGVSZXZpZXdTdGF0cyA9IGFzeW5jIGZ1bmN0aW9uKHByb2R1Y3RJZCkge1xyXG4gIHRyeSB7XHJcbiAgICAvLyBM4bqleSB0aMO0bmcgdGluIHThu6sgbW9kZWwgUmV2aWV3XHJcbiAgICBjb25zdCBSZXZpZXcgPSBtb25nb29zZS5tb2RlbChcIlJldmlld1wiKTtcclxuICAgIFxyXG4gICAgLy8gVMOsbSB04bqldCBj4bqjIMSRw6FuaCBnacOhIMSRw6MgY8O0bmcga2hhaSBjaG8gc+G6o24gcGjhuqltIG7DoHlcclxuICAgIGNvbnN0IHJldmlld3MgPSBhd2FpdCBSZXZpZXcuZmluZCh7XHJcbiAgICAgIHByb2R1Y3RJZDogcHJvZHVjdElkLFxyXG4gICAgICBpc1B1Ymxpc2hlZDogdHJ1ZVxyXG4gICAgfSk7XHJcbiAgICBcclxuICAgIC8vIE7hur91IGtow7RuZyBjw7MgxJHDoW5oIGdpw6EgbsOgbywgeMOzYSB0aOG7kW5nIGvDqiBu4bq/dSB04buTbiB04bqhaVxyXG4gICAgaWYgKCFyZXZpZXdzIHx8IHJldmlld3MubGVuZ3RoID09PSAwKSB7XHJcbiAgICAgIGF3YWl0IHRoaXMuZmluZE9uZUFuZERlbGV0ZSh7IHByb2R1Y3RJZCB9KTtcclxuICAgICAgLy8gQ+G6rXAgbmjhuq10IFByb2R1Y3QgduG7m2kgYXZlcmFnZVJhdGluZyA9IDBcclxuICAgICAgYXdhaXQgbW9uZ29vc2UubW9kZWwoXCJQcm9kdWN0XCIpLmZpbmRCeUlkQW5kVXBkYXRlKHByb2R1Y3RJZCwge1xyXG4gICAgICAgIGF2ZXJhZ2VSYXRpbmc6IDAsXHJcbiAgICAgICAgbnVtT2ZSZXZpZXdzOiAwXHJcbiAgICAgIH0pO1xyXG4gICAgICByZXR1cm47XHJcbiAgICB9XHJcbiAgICBcclxuICAgIC8vIFTDrW5oIHRvw6FuIHRo4buRbmcga8OqXHJcbiAgICBjb25zdCB0b3RhbFJldmlld3MgPSByZXZpZXdzLmxlbmd0aDtcclxuICAgIGNvbnN0IHJhdGluZ1N1bSA9IHJldmlld3MucmVkdWNlKChzdW0sIHJldmlldykgPT4gc3VtICsgcmV2aWV3LnJhdGluZywgMCk7XHJcbiAgICBjb25zdCBhdmVyYWdlUmF0aW5nID0gcmF0aW5nU3VtIC8gdG90YWxSZXZpZXdzO1xyXG4gICAgY29uc3QgdmVyaWZpZWRSZXZpZXdzID0gcmV2aWV3cy5maWx0ZXIocmV2aWV3ID0+IHJldmlldy5pc1ZlcmlmaWVkKS5sZW5ndGg7XHJcbiAgICBcclxuICAgIC8vIFThuqFvIHBow6JuIHBo4buRaSDEkcOhbmggZ2nDoVxyXG4gICAgY29uc3QgcmF0aW5nRGlzdHJpYnV0aW9uID0ge1xyXG4gICAgICAxOiAwLCAyOiAwLCAzOiAwLCA0OiAwLCA1OiAwXHJcbiAgICB9O1xyXG4gICAgXHJcbiAgICByZXZpZXdzLmZvckVhY2gocmV2aWV3ID0+IHtcclxuICAgICAgaWYgKHJldmlldy5yYXRpbmcgPj0gMSAmJiByZXZpZXcucmF0aW5nIDw9IDUpIHtcclxuICAgICAgICByYXRpbmdEaXN0cmlidXRpb25bTWF0aC5mbG9vcihyZXZpZXcucmF0aW5nKV0rKztcclxuICAgICAgfVxyXG4gICAgfSk7XHJcbiAgICBcclxuICAgIC8vIEPhuq1wIG5o4bqtdCBob+G6t2MgdOG6oW8gbeG7m2kgdGjhu5FuZyBrw6pcclxuICAgIGNvbnN0IHN0YXRzID0gYXdhaXQgdGhpcy5maW5kT25lQW5kVXBkYXRlKFxyXG4gICAgICB7IHByb2R1Y3RJZCB9LFxyXG4gICAgICB7XHJcbiAgICAgICAgYXZlcmFnZVJhdGluZyxcclxuICAgICAgICByYXRpbmdEaXN0cmlidXRpb24sXHJcbiAgICAgICAgdG90YWxSZXZpZXdzLFxyXG4gICAgICAgIHZlcmlmaWVkUmV2aWV3cyxcclxuICAgICAgICBsYXN0VXBkYXRlZDogbmV3IERhdGUoKVxyXG4gICAgICB9LFxyXG4gICAgICB7IG5ldzogdHJ1ZSwgdXBzZXJ0OiB0cnVlIH1cclxuICAgICk7XHJcbiAgICBcclxuICAgIC8vIEPhuq1wIG5o4bqtdCB0cuG7sWMgdGnhur9wIHbDoG8gbW9kZWwgUHJvZHVjdFxyXG4gICAgYXdhaXQgbW9uZ29vc2UubW9kZWwoXCJQcm9kdWN0XCIpLmZpbmRCeUlkQW5kVXBkYXRlKHByb2R1Y3RJZCwge1xyXG4gICAgICBhdmVyYWdlUmF0aW5nOiBhdmVyYWdlUmF0aW5nLFxyXG4gICAgICBudW1PZlJldmlld3M6IHRvdGFsUmV2aWV3c1xyXG4gICAgfSk7XHJcbiAgICBcclxuICAgIHJldHVybiBzdGF0cztcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcihcIkzhu5dpIGtoaSBj4bqtcCBuaOG6rXQgdGjhu5FuZyBrw6ogxJHDoW5oIGdpw6E6XCIsIGVycm9yKTtcclxuICAgIHRocm93IGVycm9yO1xyXG4gIH1cclxufTtcclxuXHJcbi8vIFTDrW5oIHRvw6FuIHRo4buRbmcga8OqIHRoZW8gdGhhbmcgxJFp4buDbSA1IHNhb1xyXG5SZXZpZXdTdGF0c1NjaGVtYS5tZXRob2RzLmdldFN0YXJQZXJjZW50YWdlcyA9IGZ1bmN0aW9uKCkge1xyXG4gIGNvbnN0IHRvdGFsID0gdGhpcy50b3RhbFJldmlld3MgfHwgMTsgLy8gVHLDoW5oIGNoaWEgY2hvIDBcclxuICBcclxuICByZXR1cm4ge1xyXG4gICAgb25lU3RhcjogTWF0aC5yb3VuZCgodGhpcy5yYXRpbmdEaXN0cmlidXRpb25bMV0gLyB0b3RhbCkgKiAxMDApLFxyXG4gICAgdHdvU3RhcjogTWF0aC5yb3VuZCgodGhpcy5yYXRpbmdEaXN0cmlidXRpb25bMl0gLyB0b3RhbCkgKiAxMDApLFxyXG4gICAgdGhyZWVTdGFyOiBNYXRoLnJvdW5kKCh0aGlzLnJhdGluZ0Rpc3RyaWJ1dGlvblszXSAvIHRvdGFsKSAqIDEwMCksXHJcbiAgICBmb3VyU3RhcjogTWF0aC5yb3VuZCgodGhpcy5yYXRpbmdEaXN0cmlidXRpb25bNF0gLyB0b3RhbCkgKiAxMDApLFxyXG4gICAgZml2ZVN0YXI6IE1hdGgucm91bmQoKHRoaXMucmF0aW5nRGlzdHJpYnV0aW9uWzVdIC8gdG90YWwpICogMTAwKVxyXG4gIH07XHJcbn07XHJcblxyXG4vLyBNaWRkbGV3YXJlIMSR4buDIHTDrW5oIHRvw6FuIMSRw6FuaCBnacOhIGtoaSBjw7Mgc+G7sSB0aGF5IMSR4buVaSB0cm9uZyBSZXZpZXdcclxuUmV2aWV3U3RhdHNTY2hlbWEuc3RhdGljcy5yZWNhbGN1bGF0ZVN0YXRzID0gYXN5bmMgZnVuY3Rpb24ocHJvZHVjdElkKSB7XHJcbiAgcmV0dXJuIGF3YWl0IHRoaXMudXBkYXRlUmV2aWV3U3RhdHMocHJvZHVjdElkKTtcclxufTtcclxuXHJcbmNvbnN0IFJldmlld1N0YXRzID0gbW9uZ29vc2UubW9kZWwoXCJSZXZpZXdTdGF0c1wiLCBSZXZpZXdTdGF0c1NjaGVtYSk7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBSZXZpZXdTdGF0czsgIl0sIm1hcHBpbmdzIjoib0dBQUEsSUFBQUEsU0FBQSxHQUFBQyxzQkFBQSxDQUFBQyxPQUFBLGNBQWdDLFNBQUFELHVCQUFBRSxDQUFBLFVBQUFBLENBQUEsSUFBQUEsQ0FBQSxDQUFBQyxVQUFBLEdBQUFELENBQUEsS0FBQUUsT0FBQSxFQUFBRixDQUFBOztBQUVoQyxNQUFNRyxpQkFBaUIsR0FBRyxJQUFJQyxpQkFBUSxDQUFDQyxNQUFNO0VBQzNDO0lBQ0VDLFNBQVMsRUFBRTtN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