"use strict";Object.defineProperty(exports, "__esModule", { value: true });exports.default = void 0;var _mongoose = _interopRequireDefault(require("mongoose"));function _interopRequireDefault(e) {return e && e.__esModule ? e : { default: e };}

const notificationSchema = new _mongoose.default.Schema(
  {
    userId: {
      type: _mongoose.default.Schema.Types.ObjectId,
      ref: 'User',
      required: true,
      index: true
    },
    title: {
      type: String,
      required: true
    },
    body: {
      type: String,
      required: true
    },
    data: {
      type: Object,
      default: {}
    },
    isRead: {
      type: Boolean,
      default: false
    },
    status: {
      type: String,
      enum: ['pending', 'sent', 'failed', 'pending_view', 'viewed'],
      default: 'pending'
    },
    error: {
      type: String,
      default: null
    }
  },
  { timestamps: true }
);

// Tạo index cho truy vấn nhanh hơn
notificationSchema.index({ userId: 1, createdAt: -1 });
notificationSchema.index({ status: 1 });
notificationSchema.index({ isRead: 1 });

// Tự động xóa thông báo cũ sau 30 ngày
notificationSchema.index({ createdAt: 1 }, { expireAfterSeconds: 2592000 });

const Notification = _mongoose.default.model('Notification', notificationSchema);var _default = exports.default =

Notification;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfbW9uZ29vc2UiLCJfaW50ZXJvcFJlcXVpcmVEZWZhdWx0IiwicmVxdWlyZSIsImUiLCJfX2VzTW9kdWxlIiwiZGVmYXVsdCIsIm5vdGlmaWNhdGlvblNjaGVtYSIsIm1vbmdvb3NlIiwiU2NoZW1hIiwidXNlcklkIiwidHlwZSIsIlR5cGVzIiwiT2JqZWN0SWQiLCJyZWYiLCJyZXF1aXJlZCIsImluZGV4IiwidGl0bGUiLCJTdHJpbmciLCJib2R5IiwiZGF0YSIsIk9iamVjdCIsImlzUmVhZCIsIkJvb2xlYW4iLCJzdGF0dXMiLCJlbnVtIiwiZXJyb3IiLCJ0aW1lc3RhbXBzIiwiY3JlYXRlZEF0IiwiZXhwaXJlQWZ0ZXJTZWNvbmRzIiwiTm90aWZpY2F0aW9uIiwibW9kZWwiLCJfZGVmYXVsdCIsImV4cG9ydHMiXSwic291cmNlcyI6WyIuLi8uLi8uLi9zcmMvTW9kZWwvbm90aWZpY2F0aW9uTW9kZWwuanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IG1vbmdvb3NlIGZyb20gJ21vbmdvb3NlJztcclxuXHJcbmNvbnN0IG5vdGlmaWNhdGlvblNjaGVtYSA9IG5ldyBtb25nb29zZS5TY2hlbWEoXHJcbiAge1xyXG4gICAgdXNlcklkOiB7XHJcbiAgICAgIHR5cGU6IG1vbmdvb3NlLlNjaGVtYS5UeXBlcy5PYmplY3RJZCxcclxuICAgICAgcmVmOiAnVXNlcicsXHJcbiAgICAgIHJlcXVpcmVkOiB0cnVlLFxyXG4gICAgICBpbmRleDogdHJ1ZVxyXG4gICAgfSxcclxuICAgIHRpdGxlOiB7XHJcbiAgICAgIHR5cGU6IFN0cmluZyxcclxuICAgICAgcmVxdWlyZWQ6IHRydWVcclxuICAgIH0sXHJcbiAgICBib2R5OiB7XHJcbiAgICAgIHR5cGU6IFN0cmluZyxcclxuICAgICAgcmVxdWlyZWQ6IHRydWVcclxuICAgIH0sXHJcbiAgICBkYXRhOiB7XHJcbiAgICAgIHR5cGU6IE9iamVjdCxcclxuICAgICAgZGVmYXVsdDoge31cclxuICAgIH0sXHJcbiAgICBpc1JlYWQ6IHtcclxuICAgICAgdHlwZTogQm9vbGVhbixcclxuICAgICAgZGVmYXVsdDogZmFsc2VcclxuICAgIH0sXHJcbiAgICBzdGF0dXM6IHtcclxuICAgICAgdHlwZTogU3RyaW5nLFxyXG4gICAgICBlbnVtOiBbJ3BlbmRpbmcnLCAnc2VudCcsICdmYWlsZWQnLCAncGVuZGluZ192aWV3JywgJ3ZpZXdlZCddLFxyXG4gICAgICBkZWZhdWx0OiAncGVuZGluZydcclxuICAgIH0sXHJcbiAgICBlcnJvcjoge1xyXG4gICAgICB0eXBlOiBTdHJpbmcsXHJcbiAgICAgIGRlZmF1bHQ6IG51bGxcclxuICAgIH1cclxuICB9LFxyXG4gIHsgdGltZXN0YW1wczogdHJ1ZSB9XHJcbik7XHJcblxyXG4vLyBU4bqhbyBpbmRleCBjaG8gdHJ1eSB24bqlbiBuaGFuaCBoxqFuXHJcbm5vdGlmaWNhdGlvblNjaGVtYS5pbmRleCh7IHVzZXJJZDogMSwgY3JlYXRlZEF0OiAtMSB9KTtcclxubm90aWZpY2F0aW9uU2NoZW1hLmluZGV4KHsgc3RhdHVzOiAxIH0pO1xyXG5ub3RpZmljYXRpb25TY2hlbWEuaW5kZXgoeyBpc1JlYWQ6IDEgfSk7XHJcblxyXG4vLyBU4buxIMSR4buZbmcgeMOzYSB0aMO0bmcgYsOhbyBjxakgc2F1IDMwIG5nw6B5XHJcbm5vdGlmaWNhdGlvblNjaGVtYS5pbmRleCh7IGNyZWF0ZWRBdDogMSB9LCB7IGV4cGlyZUFmdGVyU2Vjb25kczogMjU5MjAwMCB9KTtcclxuXHJcbmNvbnN0IE5vdGlmaWNhdGlvbiA9IG1vbmdvb3NlLm1vZGVsKCdOb3RpZmljYXRpb24nLCBub3RpZmljYXRpb25TY2hlbWEpO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgTm90aWZpY2F0aW9uOyAiXSwibWFwcGluZ3MiOiJvR0FBQSxJQUFBQSxTQUFBLEdBQUFDLHNCQUFBLENBQUFDLE9BQUEsY0FBZ0MsU0FBQUQsdUJBQUFFLENBQUEsVUFBQUEsQ0FBQSxJQUFBQSxDQUFBLENBQUFDLFVBQUEsR0FBQUQsQ0FBQSxLQUFBRSxPQUFBLEVBQUFGLENBQUE7O0FBRWhDLE1BQU1HLGtCQUFrQixHQUFHLElBQUlDLGlCQUFRLENBQUNDLE1BQU07RUFDNUM7SUFDRUMsTUFBTSxFQUFFO01BQ05DLElBQUksRUFBRUgsaUJBQVEsQ0FBQ0MsTUFBTSxDQUFDRyxLQUFLLENBQUNDLFFBQVE7TUFDcENDLEdBQUcsRUFBRSxNQUFNO01BQ1hDLFFBQVEsRUFBRSxJQUFJO01BQ2RDLEtBQUssRUFBRTtJQUNULENBQUM7SUFDREMsS0FBSyxFQUFFO01BQ0xOLElBQUksRUFBRU8sTUFBTTtNQUNaSCxRQUFRLEVBQUU7SUFDWixDQUFDO0lBQ0RJLElBQUksRUFBRTtNQUNKUixJQUFJLEVBQUVPLE1BQU07TUFDWkgsUUFBUSxFQUFFO0lBQ1osQ0FBQztJQUNESyxJQUFJLEVBQUU7TUFDSlQsSUFBSSxFQUFFVSxNQUFNO01BQ1pmLE9BQU8sRUFBRSxDQUFDO0lBQ1osQ0FBQztJQUNEZ0IsTUFBTSxFQUFFO01BQ05YLElBQUksRUFBRVksT0FBTztNQUNiakIsT0FBTyxFQUFFO0lBQ1gsQ0FBQztJQUNEa0IsTUFBTSxFQUFFO01BQ05iLElBQUksRUFBRU8sTUFBTTtNQUNaTyxJQUFJLEVBQUUsQ0FBQyxTQUFTLEVBQUUsTUFBTSxFQUFFLFFBQVEsRUFBRSxjQUFjLEVBQUUsUUFBUSxDQUFDO01BQzdEbkIsT0FBTyxFQUFFO0lBQ1gsQ0FBQztJQUNEb0IsS0FBSyxFQUFFO01BQ0xmLElBQUksRUFBRU8sTUFBTTtNQUNaWixPQUFPLEVBQUU7SUFDWDtFQUNGLENBQUM7RUFDRCxFQUFFcUIsVUFBVSxFQUFFLElBQUksQ0FBQztBQUNyQixDQUFDOztBQUVEO0FBQ0FwQixrQkFBa0IsQ0FBQ1MsS0FBSyxDQUFDLEVBQUVOLE1BQU0sRUFBRSxDQUFDLEVBQUVrQixTQUFTLEVBQUUsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDO0FBQ3REckIsa0JBQWtCLENBQUNTLEtBQUssQ0FBQyxFQUFFUSxNQUFNLEVBQUUsQ0FBQyxDQUFDLENBQUMsQ0FBQztBQUN2Q2pCLGtCQUFrQixDQUFDUyxLQUFLLENBQUMsRUFBRU0sTUFBTSxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUM7O0FBRXZDO0FBQ0FmLGtCQUFrQixDQUFDUyxLQUFLLENBQUMsRUFBRVksU0FBUyxFQUFFLENBQUMsQ0FBQyxDQUFDLEVBQUUsRUFBRUMsa0JBQWtCLEVBQUUsT0FBTyxDQUFDLENBQUMsQ0FBQzs7QUFFM0UsTUFBTUMsWUFBWSxHQUFHdEIsaUJBQVEsQ0FBQ3VCLEtBQUssQ0FBQyxjQUFjLEVBQUV4QixrQkFBa0IsQ0FBQyxDQUFDLElBQUF5QixRQUFBLEdBQUFDLE9BQUEsQ0FBQTNCLE9BQUE7O0FBRXpEd0IsWUFBWSIsImlnbm9yZUxpc3QiOltdfQ==