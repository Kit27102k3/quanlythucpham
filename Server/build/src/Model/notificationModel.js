"use strict";var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(exports, "__esModule", { value: true });exports.default = void 0;var _mongoose = _interopRequireDefault(require("mongoose"));

const notificationSchema = new _mongoose.default.Schema(
  {
    userId: {
      type: _mongoose.default.Schema.Types.ObjectId,
      ref: 'User',
      required: true,
      index: true
    },
    title: {
      type: String,
      required: true
    },
    body: {
      type: String,
      required: true
    },
    data: {
      type: Object,
      default: {}
    },
    isRead: {
      type: Boolean,
      default: false
    },
    status: {
      type: String,
      enum: ['pending', 'sent', 'failed', 'pending_view', 'viewed'],
      default: 'pending'
    },
    error: {
      type: String,
      default: null
    }
  },
  { timestamps: true }
);

// Tạo index cho truy vấn nhanh hơn
notificationSchema.index({ userId: 1, createdAt: -1 });
notificationSchema.index({ status: 1 });
notificationSchema.index({ isRead: 1 });

// Tự động xóa thông báo cũ sau 30 ngày
notificationSchema.index({ createdAt: 1 }, { expireAfterSeconds: 2592000 });

const Notification = _mongoose.default.model('Notification', notificationSchema);var _default = exports.default =

Notification;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfbW9uZ29vc2UiLCJfaW50ZXJvcFJlcXVpcmVEZWZhdWx0IiwicmVxdWlyZSIsIm5vdGlmaWNhdGlvblNjaGVtYSIsIm1vbmdvb3NlIiwiU2NoZW1hIiwidXNlcklkIiwidHlwZSIsIlR5cGVzIiwiT2JqZWN0SWQiLCJyZWYiLCJyZXF1aXJlZCIsImluZGV4IiwidGl0bGUiLCJTdHJpbmciLCJib2R5IiwiZGF0YSIsIk9iamVjdCIsImRlZmF1bHQiLCJpc1JlYWQiLCJCb29sZWFuIiwic3RhdHVzIiwiZW51bSIsImVycm9yIiwidGltZXN0YW1wcyIsImNyZWF0ZWRBdCIsImV4cGlyZUFmdGVyU2Vjb25kcyIsIk5vdGlmaWNhdGlvbiIsIm1vZGVsIiwiX2RlZmF1bHQiLCJleHBvcnRzIl0sInNvdXJjZXMiOlsiLi4vLi4vLi4vc3JjL01vZGVsL25vdGlmaWNhdGlvbk1vZGVsLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBtb25nb29zZSBmcm9tICdtb25nb29zZSc7XHJcblxyXG5jb25zdCBub3RpZmljYXRpb25TY2hlbWEgPSBuZXcgbW9uZ29vc2UuU2NoZW1hKFxyXG4gIHtcclxuICAgIHVzZXJJZDoge1xyXG4gICAgICB0eXBlOiBtb25nb29zZS5TY2hlbWEuVHlwZXMuT2JqZWN0SWQsXHJcbiAgICAgIHJlZjogJ1VzZXInLFxyXG4gICAgICByZXF1aXJlZDogdHJ1ZSxcclxuICAgICAgaW5kZXg6IHRydWVcclxuICAgIH0sXHJcbiAgICB0aXRsZToge1xyXG4gICAgICB0eXBlOiBTdHJpbmcsXHJcbiAgICAgIHJlcXVpcmVkOiB0cnVlXHJcbiAgICB9LFxyXG4gICAgYm9keToge1xyXG4gICAgICB0eXBlOiBTdHJpbmcsXHJcbiAgICAgIHJlcXVpcmVkOiB0cnVlXHJcbiAgICB9LFxyXG4gICAgZGF0YToge1xyXG4gICAgICB0eXBlOiBPYmplY3QsXHJcbiAgICAgIGRlZmF1bHQ6IHt9XHJcbiAgICB9LFxyXG4gICAgaXNSZWFkOiB7XHJcbiAgICAgIHR5cGU6IEJvb2xlYW4sXHJcbiAgICAgIGRlZmF1bHQ6IGZhbHNlXHJcbiAgICB9LFxyXG4gICAgc3RhdHVzOiB7XHJcbiAgICAgIHR5cGU6IFN0cmluZyxcclxuICAgICAgZW51bTogWydwZW5kaW5nJywgJ3NlbnQnLCAnZmFpbGVkJywgJ3BlbmRpbmdfdmlldycsICd2aWV3ZWQnXSxcclxuICAgICAgZGVmYXVsdDogJ3BlbmRpbmcnXHJcbiAgICB9LFxyXG4gICAgZXJyb3I6IHtcclxuICAgICAgdHlwZTogU3RyaW5nLFxyXG4gICAgICBkZWZhdWx0OiBudWxsXHJcbiAgICB9XHJcbiAgfSxcclxuICB7IHRpbWVzdGFtcHM6IHRydWUgfVxyXG4pO1xyXG5cclxuLy8gVOG6oW8gaW5kZXggY2hvIHRydXkgduG6pW4gbmhhbmggaMahblxyXG5ub3RpZmljYXRpb25TY2hlbWEuaW5kZXgoeyB1c2VySWQ6IDEsIGNyZWF0ZWRBdDogLTEgfSk7XHJcbm5vdGlmaWNhdGlvblNjaGVtYS5pbmRleCh7IHN0YXR1czogMSB9KTtcclxubm90aWZpY2F0aW9uU2NoZW1hLmluZGV4KHsgaXNSZWFkOiAxIH0pO1xyXG5cclxuLy8gVOG7sSDEkeG7mW5nIHjDs2EgdGjDtG5nIGLDoW8gY8WpIHNhdSAzMCBuZ8OgeVxyXG5ub3RpZmljYXRpb25TY2hlbWEuaW5kZXgoeyBjcmVhdGVkQXQ6IDEgfSwgeyBleHBpcmVBZnRlclNlY29uZHM6IDI1OTIwMDAgfSk7XHJcblxyXG5jb25zdCBOb3RpZmljYXRpb24gPSBtb25nb29zZS5tb2RlbCgnTm90aWZpY2F0aW9uJywgbm90aWZpY2F0aW9uU2NoZW1hKTtcclxuXHJcbmV4cG9ydCBkZWZhdWx0IE5vdGlmaWNhdGlvbjsgIl0sIm1hcHBpbmdzIjoieUxBQUEsSUFBQUEsU0FBQSxHQUFBQyxzQkFBQSxDQUFBQyxPQUFBOztBQUVBLE1BQU1DLGtCQUFrQixHQUFHLElBQUlDLGlCQUFRLENBQUNDLE1BQU07RUFDNUM7SUFDRUMsTUFBTSxFQUFFO01BQ05DLElBQUksRUFBRUgsaUJBQVEsQ0FBQ0MsTUFBTSxDQUFDRyxLQUFLLENBQUNDLFFBQVE7TUFDcENDLEdBQUcsRUFBRSxNQUFNO01BQ1hDLFFBQVEsRUFBRSxJQUFJO01BQ2RDLEtBQUssRUFBRTtJQUNULENBQUM7SUFDREMsS0FBSyxFQUFFO01BQ0xOLElBQUksRUFBRU8sTUFBTTtNQUNaSCxRQUFRLEVBQUU7SUFDWixDQUFDO0lBQ0RJLElBQUksRUFBRTtNQUNKUixJQUFJLEVBQUVPLE1BQU07TUFDWkgsUUFBUSxFQUFFO0lBQ1osQ0FBQztJQUNESyxJQUFJLEVBQUU7TUFDSlQsSUFBSSxFQUFFVSxNQUFNO01BQ1pDLE9BQU8sRUFBRSxDQUFDO0lBQ1osQ0FBQztJQUNEQyxNQUFNLEVBQUU7TUFDTlosSUFBSSxFQUFFYSxPQUFPO01BQ2JGLE9BQU8sRUFBRTtJQUNYLENBQUM7SUFDREcsTUFBTSxFQUFFO01BQ05kLElBQUksRUFBRU8sTUFBTTtNQUNaUSxJQUFJLEVBQUUsQ0FBQyxTQUFTLEVBQUUsTUFBTSxFQUFFLFFBQVEsRUFBRSxjQUFjLEVBQUUsUUFBUSxDQUFDO01BQzdESixPQUFPLEVBQUU7SUFDWCxDQUFDO0lBQ0RLLEtBQUssRUFBRTtNQUNMaEIsSUFBSSxFQUFFTyxNQUFNO01BQ1pJLE9BQU8sRUFBRTtJQUNYO0VBQ0YsQ0FBQztFQUNELEVBQUVNLFVBQVUsRUFBRSxJQUFJLENBQUM7QUFDckIsQ0FBQzs7QUFFRDtBQUNBckIsa0JBQWtCLENBQUNTLEtBQUssQ0FBQyxFQUFFTixNQUFNLEVBQUUsQ0FBQyxFQUFFbUIsU0FBUyxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztBQUN0RHRCLGtCQUFrQixDQUFDUyxLQUFLLENBQUMsRUFBRVMsTUFBTSxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUM7QUFDdkNsQixrQkFBa0IsQ0FBQ1MsS0FBSyxDQUFDLEVBQUVPLE1BQU0sRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDOztBQUV2QztBQUNBaEIsa0JBQWtCLENBQUNTLEtBQUssQ0FBQyxFQUFFYSxTQUFTLEVBQUUsQ0FBQyxDQUFDLENBQUMsRUFBRSxFQUFFQyxrQkFBa0IsRUFBRSxPQUFPLENBQUMsQ0FBQyxDQUFDOztBQUUzRSxNQUFNQyxZQUFZLEdBQUd2QixpQkFBUSxDQUFDd0IsS0FBSyxDQUFDLGNBQWMsRUFBRXpCLGtCQUFrQixDQUFDLENBQUMsSUFBQTBCLFFBQUEsR0FBQUMsT0FBQSxDQUFBWixPQUFBOztBQUV6RFMsWUFBWSIsImlnbm9yZUxpc3QiOltdfQ==