"use strict";Object.defineProperty(exports, "__esModule", { value: true });exports.default = void 0;
var _mongoose = _interopRequireDefault(require("mongoose"));
var _bcryptjs = require("bcryptjs");function _interopRequireDefault(e) {return e && e.__esModule ? e : { default: e };} /* eslint-disable no-useless-escape */

const AdminSchema = new _mongoose.default.Schema(
  {
    userName: {
      type: String,
      required: [true, "Tên đăng nhập là bắt buộc"],
      unique: true,
      trim: true,
      minlength: [4, "Tên đăng nhập phải có ít nhất 4 ký tự"],
      maxlength: [20, "Tên đăng nhập không quá 20 ký tự"]
    },
    password: {
      type: String,
      required: [true, "Mật khẩu là bắt buộc"],
      minlength: [6, "Mật khẩu phải có ít nhất 6 ký tự"]
    },
    fullName: {
      type: String,
      required: [true, "Họ tên là bắt buộc"],
      trim: true
    },
    phone: {
      type: String,
      required: [true, "Số điện thoại là bắt buộc"],
      match: [/^[0-9]{10,11}$/, "Số điện thoại không hợp lệ"]
    },
    email: {
      type: String,
      required: [true, "Email là bắt buộc"],
      unique: true,
      lowercase: true,
      match: [
      /^\w+([\.-]?\w+)*@\w+([\.-]?\w+)*(\.\w{2,3})+$/,
      "Email không hợp lệ"]

    },
    birthday: {
      type: Date,
      validate: {
        validator: function (value) {
          return value < new Date();
        },
        message: "Ngày sinh không hợp lệ"
      }
    },
    role: {
      type: String,
      enum: ["superadmin", "manager", "admin", "user"],
      required: true
    },
    permissions: {
      type: [String],
      enum: [
      "Thêm",
      "Xem",
      "Sửa",
      "Xóa",
      "Quản lý người dùng",
      "Quản lý sản phẩm",
      "Quản lý đơn hàng",
      "Quản lý danh mục",
      "Quản lý cài đặt",
      "reviews",
      "contacts",
      "messages",
      "orders",
      "employees",
      "customers",
      "dashboard",
      "products",
      "categories",
      "coupons",
      "tips",
      "reports",
      "settings"],

      default: ["Xem"]
    },
    isActive: {
      type: Boolean,
      default: true
    },
    lastLogin: Date,
    createdAt: {
      type: Date,
      default: Date.now
    }
  },
  {
    timestamps: true
  }
);

AdminSchema.pre("save", async function (next) {
  if (!this.isModified("password")) return next();

  try {
    const salt = await (0, _bcryptjs.genSalt)(10);
    this.password = await (0, _bcryptjs.hash)(this.password, salt);
    next();
  } catch (err) {
    next(err);
  }
});

AdminSchema.methods.comparePassword = async function (candidatePassword) {
  return await (0, _bcryptjs.compare)(candidatePassword, this.password);
};

AdminSchema.methods.toJSON = function () {
  const admin = this.toObject();
  delete admin.password;
  delete admin.__v;
  return admin;
};var _default = exports.default =

_mongoose.default.model("Admin", AdminSchema);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfbW9uZ29vc2UiLCJfaW50ZXJvcFJlcXVpcmVEZWZhdWx0IiwicmVxdWlyZSIsIl9iY3J5cHRqcyIsImUiLCJfX2VzTW9kdWxlIiwiZGVmYXVsdCIsIkFkbWluU2NoZW1hIiwibW9uZ29vc2UiLCJTY2hlbWEiLCJ1c2VyTmFtZSIsInR5cGUiLCJTdHJpbmciLCJyZXF1aXJlZCIsInVuaXF1ZSIsInRyaW0iLCJtaW5sZW5ndGgiLCJtYXhsZW5ndGgiLCJwYXNzd29yZCIsImZ1bGxOYW1lIiwicGhvbmUiLCJtYXRjaCIsImVtYWlsIiwibG93ZXJjYXNlIiwiYmlydGhkYXkiLCJEYXRlIiwidmFsaWRhdGUiLCJ2YWxpZGF0b3IiLCJ2YWx1ZSIsIm1lc3NhZ2UiLCJyb2xlIiwiZW51bSIsInBlcm1pc3Npb25zIiwiaXNBY3RpdmUiLCJCb29sZWFuIiwibGFzdExvZ2luIiwiY3JlYXRlZEF0Iiwibm93IiwidGltZXN0YW1wcyIsInByZSIsIm5leHQiLCJpc01vZGlmaWVkIiwic2FsdCIsImdlblNhbHQiLCJoYXNoIiwiZXJyIiwibWV0aG9kcyIsImNvbXBhcmVQYXNzd29yZCIsImNhbmRpZGF0ZVBhc3N3b3JkIiwiY29tcGFyZSIsInRvSlNPTiIsImFkbWluIiwidG9PYmplY3QiLCJfX3YiLCJfZGVmYXVsdCIsImV4cG9ydHMiLCJtb2RlbCJdLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NyYy9Nb2RlbC9hZG1pbk1vZGVsLmpzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qIGVzbGludC1kaXNhYmxlIG5vLXVzZWxlc3MtZXNjYXBlICovXHJcbmltcG9ydCBtb25nb29zZSBmcm9tIFwibW9uZ29vc2VcIjtcclxuaW1wb3J0IHsgZ2VuU2FsdCwgaGFzaCwgY29tcGFyZSB9IGZyb20gXCJiY3J5cHRqc1wiO1xyXG5cclxuY29uc3QgQWRtaW5TY2hlbWEgPSBuZXcgbW9uZ29vc2UuU2NoZW1hKFxyXG4gIHtcclxuICAgIHVzZXJOYW1lOiB7XHJcbiAgICAgIHR5cGU6IFN0cmluZyxcclxuICAgICAgcmVxdWlyZWQ6IFt0cnVlLCBcIlTDqm4gxJHEg25nIG5o4bqtcCBsw6AgYuG6r3QgYnXhu5ljXCJdLFxyXG4gICAgICB1bmlxdWU6IHRydWUsXHJcbiAgICAgIHRyaW06IHRydWUsXHJcbiAgICAgIG1pbmxlbmd0aDogWzQsIFwiVMOqbiDEkcSDbmcgbmjhuq1wIHBo4bqjaSBjw7Mgw610IG5o4bqldCA0IGvDvSB04buxXCJdLFxyXG4gICAgICBtYXhsZW5ndGg6IFsyMCwgXCJUw6puIMSRxINuZyBuaOG6rXAga2jDtG5nIHF1w6EgMjAga8O9IHThu7FcIl0sXHJcbiAgICB9LFxyXG4gICAgcGFzc3dvcmQ6IHtcclxuICAgICAgdHlwZTogU3RyaW5nLFxyXG4gICAgICByZXF1aXJlZDogW3RydWUsIFwiTeG6rXQga2jhuql1IGzDoCBi4bqvdCBideG7mWNcIl0sXHJcbiAgICAgIG1pbmxlbmd0aDogWzYsIFwiTeG6rXQga2jhuql1IHBo4bqjaSBjw7Mgw610IG5o4bqldCA2IGvDvSB04buxXCJdLFxyXG4gICAgfSxcclxuICAgIGZ1bGxOYW1lOiB7XHJcbiAgICAgIHR5cGU6IFN0cmluZyxcclxuICAgICAgcmVxdWlyZWQ6IFt0cnVlLCBcIkjhu40gdMOqbiBsw6AgYuG6r3QgYnXhu5ljXCJdLFxyXG4gICAgICB0cmltOiB0cnVlLFxyXG4gICAgfSxcclxuICAgIHBob25lOiB7XHJcbiAgICAgIHR5cGU6IFN0cmluZyxcclxuICAgICAgcmVxdWlyZWQ6IFt0cnVlLCBcIlPhu5EgxJFp4buHbiB0aG/huqFpIGzDoCBi4bqvdCBideG7mWNcIl0sXHJcbiAgICAgIG1hdGNoOiBbL15bMC05XXsxMCwxMX0kLywgXCJT4buRIMSRaeG7h24gdGhv4bqhaSBraMO0bmcgaOG7o3AgbOG7h1wiXSxcclxuICAgIH0sXHJcbiAgICBlbWFpbDoge1xyXG4gICAgICB0eXBlOiBTdHJpbmcsXHJcbiAgICAgIHJlcXVpcmVkOiBbdHJ1ZSwgXCJFbWFpbCBsw6AgYuG6r3QgYnXhu5ljXCJdLFxyXG4gICAgICB1bmlxdWU6IHRydWUsXHJcbiAgICAgIGxvd2VyY2FzZTogdHJ1ZSxcclxuICAgICAgbWF0Y2g6IFtcclxuICAgICAgICAvXlxcdysoW1xcLi1dP1xcdyspKkBcXHcrKFtcXC4tXT9cXHcrKSooXFwuXFx3ezIsM30pKyQvLFxyXG4gICAgICAgIFwiRW1haWwga2jDtG5nIGjhu6NwIGzhu4dcIixcclxuICAgICAgXSxcclxuICAgIH0sXHJcbiAgICBiaXJ0aGRheToge1xyXG4gICAgICB0eXBlOiBEYXRlLFxyXG4gICAgICB2YWxpZGF0ZToge1xyXG4gICAgICAgIHZhbGlkYXRvcjogZnVuY3Rpb24gKHZhbHVlKSB7XHJcbiAgICAgICAgICByZXR1cm4gdmFsdWUgPCBuZXcgRGF0ZSgpO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgbWVzc2FnZTogXCJOZ8OgeSBzaW5oIGtow7RuZyBo4bujcCBs4buHXCIsXHJcbiAgICAgIH0sXHJcbiAgICB9LFxyXG4gICAgcm9sZToge1xyXG4gICAgICB0eXBlOiBTdHJpbmcsXHJcbiAgICAgIGVudW06IFtcInN1cGVyYWRtaW5cIiwgXCJtYW5hZ2VyXCIsIFwiYWRtaW5cIiwgXCJ1c2VyXCJdLFxyXG4gICAgICByZXF1aXJlZDogdHJ1ZSxcclxuICAgIH0sXHJcbiAgICBwZXJtaXNzaW9uczoge1xyXG4gICAgICB0eXBlOiBbU3RyaW5nXSxcclxuICAgICAgZW51bTogW1xyXG4gICAgICAgIFwiVGjDqm1cIixcclxuICAgICAgICBcIlhlbVwiLFxyXG4gICAgICAgIFwiU+G7rWFcIixcclxuICAgICAgICBcIljDs2FcIixcclxuICAgICAgICBcIlF14bqjbiBsw70gbmfGsOG7nWkgZMO5bmdcIixcclxuICAgICAgICBcIlF14bqjbiBsw70gc+G6o24gcGjhuqltXCIsXHJcbiAgICAgICAgXCJRdeG6o24gbMO9IMSRxqFuIGjDoG5nXCIsXHJcbiAgICAgICAgXCJRdeG6o24gbMO9IGRhbmggbeG7pWNcIixcclxuICAgICAgICBcIlF14bqjbiBsw70gY8OgaSDEkeG6t3RcIixcclxuICAgICAgICBcInJldmlld3NcIixcclxuICAgICAgICBcImNvbnRhY3RzXCIsXHJcbiAgICAgICAgXCJtZXNzYWdlc1wiLFxyXG4gICAgICAgIFwib3JkZXJzXCIsXHJcbiAgICAgICAgXCJlbXBsb3llZXNcIixcclxuICAgICAgICBcImN1c3RvbWVyc1wiLFxyXG4gICAgICAgIFwiZGFzaGJvYXJkXCIsXHJcbiAgICAgICAgXCJwcm9kdWN0c1wiLFxyXG4gICAgICAgIFwiY2F0ZWdvcmllc1wiLFxyXG4gICAgICAgIFwiY291cG9uc1wiLFxyXG4gICAgICAgIFwidGlwc1wiLFxyXG4gICAgICAgIFwicmVwb3J0c1wiLFxyXG4gICAgICAgIFwic2V0dGluZ3NcIixcclxuICAgICAgXSxcclxuICAgICAgZGVmYXVsdDogW1wiWGVtXCJdLFxyXG4gICAgfSxcclxuICAgIGlzQWN0aXZlOiB7XHJcbiAgICAgIHR5cGU6IEJvb2xlYW4sXHJcbiAgICAgIGRlZmF1bHQ6IHRydWUsXHJcbiAgICB9LFxyXG4gICAgbGFzdExvZ2luOiBEYXRlLFxyXG4gICAgY3JlYXRlZEF0OiB7XHJcbiAgICAgIHR5cGU6IERhdGUsXHJcbiAgICAgIGRlZmF1bHQ6IERhdGUubm93LFxyXG4gICAgfSxcclxuICB9LFxyXG4gIHtcclxuICAgIHRpbWVzdGFtcHM6IHRydWUsXHJcbiAgfVxyXG4pO1xyXG5cclxuQWRtaW5TY2hlbWEucHJlKFwic2F2ZVwiLCBhc3luYyBmdW5jdGlvbiAobmV4dCkge1xyXG4gIGlmICghdGhpcy5pc01vZGlmaWVkKFwicGFzc3dvcmRcIikpIHJldHVybiBuZXh0KCk7XHJcblxyXG4gIHRyeSB7XHJcbiAgICBjb25zdCBzYWx0ID0gYXdhaXQgZ2VuU2FsdCgxMCk7XHJcbiAgICB0aGlzLnBhc3N3b3JkID0gYXdhaXQgaGFzaCh0aGlzLnBhc3N3b3JkLCBzYWx0KTtcclxuICAgIG5leHQoKTtcclxuICB9IGNhdGNoIChlcnIpIHtcclxuICAgIG5leHQoZXJyKTtcclxuICB9XHJcbn0pO1xyXG5cclxuQWRtaW5TY2hlbWEubWV0aG9kcy5jb21wYXJlUGFzc3dvcmQgPSBhc3luYyBmdW5jdGlvbiAoY2FuZGlkYXRlUGFzc3dvcmQpIHtcclxuICByZXR1cm4gYXdhaXQgY29tcGFyZShjYW5kaWRhdGVQYXNzd29yZCwgdGhpcy5wYXNzd29yZCk7XHJcbn07XHJcblxyXG5BZG1pblNjaGVtYS5tZXRob2RzLnRvSlNPTiA9IGZ1bmN0aW9uICgpIHtcclxuICBjb25zdCBhZG1pbiA9IHRoaXMudG9PYmplY3QoKTtcclxuICBkZWxldGUgYWRtaW4ucGFzc3dvcmQ7XHJcbiAgZGVsZXRlIGFkbWluLl9fdjtcclxuICByZXR1cm4gYWRtaW47XHJcbn07XHJcblxyXG5leHBvcnQgZGVmYXVsdCBtb25nb29zZS5tb2RlbChcIkFkbWluXCIsIEFkbWluU2NoZW1hKTtcclxuIl0sIm1hcHBpbmdzIjoiO0FBQ0EsSUFBQUEsU0FBQSxHQUFBQyxzQkFBQSxDQUFBQyxPQUFBO0FBQ0EsSUFBQUMsU0FBQSxHQUFBRCxPQUFBLGFBQWtELFNBQUFELHVCQUFBRyxDQUFBLFVBQUFBLENBQUEsSUFBQUEsQ0FBQSxDQUFBQyxVQUFBLEdBQUFELENBQUEsS0FBQUUsT0FBQSxFQUFBRixDQUFBLEtBRmxEOztBQUlBLE1BQU1HLFdBQVcsR0FBRyxJQUFJQyxpQkFBUSxDQUFDQyxNQUFNO0VBQ3JDO0lBQ0VDLFFBQVEsRUFBRTtNQUNSQyxJQUFJLEVBQUVDLE1BQU07TUFDWkMsUUFBUSxFQUFFLENBQUMsSUFBSSxFQUFFLDJCQUEyQixDQUFDO01BQzdDQyxNQUFNLEVBQUUsSUFBSTtNQUNaQyxJQUFJLEVBQUUsSUFBSTtNQUNWQyxTQUFTLEVBQUUsQ0FBQyxDQUFDLEVBQUUsdUNBQXVDLENBQUM7TUFDdkRDLFNBQVMsRUFBRSxDQUFDLEVBQUUsRUFBRSxrQ0FBa0M7SUFDcEQsQ0FBQztJQUNEQyxRQUFRLEVBQUU7TUFDUlAsSUFBSSxFQUFFQyxNQUFNO01BQ1pDLFFBQVEsRUFBRSxDQUFDLElBQUksRUFBRSxz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