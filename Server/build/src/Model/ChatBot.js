"use strict";var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(exports, "__esModule", { value: true });exports.default = void 0;var _mongoose = _interopRequireDefault(require("mongoose"));

// Định nghĩa schema cho tin nhắn
const messageSchema = new _mongoose.default.Schema({
  sender: {
    type: String,
    enum: ["user", "bot"],
    required: true
  },
  message: {
    type: String,
    required: true
  },
  timestamp: {
    type: Date,
    default: Date.now
  },
  productId: {
    type: _mongoose.default.Schema.Types.ObjectId,
    ref: "Product"
  },
  type: {
    type: String,
    enum: ["text", "image", "file"],
    default: "text"
  }
});

const chatSchema = new _mongoose.default.Schema({
  userId: {
    type: _mongoose.default.Schema.Types.ObjectId,
    ref: "User",
    required: true
  },
  userInfo: {
    name: String,
    email: String,
    phone: String
  },
  messages: [messageSchema],
  status: {
    type: String,
    enum: ["active", "closed"],
    default: "active"
  },
  rating: {
    type: Number,
    min: 1,
    max: 5
  },
  createAt: {
    type: Date,
    default: Date.now
  },
  updateAt: {
    type: Date,
    default: Date.now
  }
});

chatSchema.pre("save", function (next) {
  this.updateAt = Date.now();
  next();
});

// Tạo model từ schema
const Chat = _mongoose.default.model("Chat", chatSchema);var _default = exports.default =

Chat;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfbW9uZ29vc2UiLCJfaW50ZXJvcFJlcXVpcmVEZWZhdWx0IiwicmVxdWlyZSIsIm1lc3NhZ2VTY2hlbWEiLCJtb25nb29zZSIsIlNjaGVtYSIsInNlbmRlciIsInR5cGUiLCJTdHJpbmciLCJlbnVtIiwicmVxdWlyZWQiLCJtZXNzYWdlIiwidGltZXN0YW1wIiwiRGF0ZSIsImRlZmF1bHQiLCJub3ciLCJwcm9kdWN0SWQiLCJUeXBlcyIsIk9iamVjdElkIiwicmVmIiwiY2hhdFNjaGVtYSIsInVzZXJJZCIsInVzZXJJbmZvIiwibmFtZSIsImVtYWlsIiwicGhvbmUiLCJtZXNzYWdlcyIsInN0YXR1cyIsInJhdGluZyIsIk51bWJlciIsIm1pbiIsIm1heCIsImNyZWF0ZUF0IiwidXBkYXRlQXQiLCJwcmUiLCJuZXh0IiwiQ2hhdCIsIm1vZGVsIiwiX2RlZmF1bHQiLCJleHBvcnRzIl0sInNvdXJjZXMiOlsiLi4vLi4vLi4vc3JjL01vZGVsL0NoYXRCb3QuanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IG1vbmdvb3NlIGZyb20gXCJtb25nb29zZVwiO1xyXG5cclxuLy8gxJDhu4tuaCBuZ2jEqWEgc2NoZW1hIGNobyB0aW4gbmjhuq9uXHJcbmNvbnN0IG1lc3NhZ2VTY2hlbWEgPSBuZXcgbW9uZ29vc2UuU2NoZW1hKHtcclxuICBzZW5kZXI6IHtcclxuICAgIHR5cGU6IFN0cmluZyxcclxuICAgIGVudW06IFtcInVzZXJcIiwgXCJib3RcIl0sXHJcbiAgICByZXF1aXJlZDogdHJ1ZSxcclxuICB9LFxyXG4gIG1lc3NhZ2U6IHtcclxuICAgIHR5cGU6IFN0cmluZyxcclxuICAgIHJlcXVpcmVkOiB0cnVlLFxyXG4gIH0sXHJcbiAgdGltZXN0YW1wOiB7XHJcbiAgICB0eXBlOiBEYXRlLFxyXG4gICAgZGVmYXVsdDogRGF0ZS5ub3csXHJcbiAgfSxcclxuICBwcm9kdWN0SWQ6IHtcclxuICAgIHR5cGU6IG1vbmdvb3NlLlNjaGVtYS5UeXBlcy5PYmplY3RJZCxcclxuICAgIHJlZjogXCJQcm9kdWN0XCIsXHJcbiAgfSxcclxuICB0eXBlOiB7XHJcbiAgICB0eXBlOiBTdHJpbmcsXHJcbiAgICBlbnVtOiBbXCJ0ZXh0XCIsIFwiaW1hZ2VcIiwgXCJmaWxlXCJdLFxyXG4gICAgZGVmYXVsdDogXCJ0ZXh0XCIsXHJcbiAgfSxcclxufSk7XHJcblxyXG5jb25zdCBjaGF0U2NoZW1hID0gbmV3IG1vbmdvb3NlLlNjaGVtYSh7XHJcbiAgdXNlcklkOiB7XHJcbiAgICB0eXBlOiBtb25nb29zZS5TY2hlbWEuVHlwZXMuT2JqZWN0SWQsXHJcbiAgICByZWY6IFwiVXNlclwiLFxyXG4gICAgcmVxdWlyZWQ6IHRydWUsXHJcbiAgfSxcclxuICB1c2VySW5mbzoge1xyXG4gICAgbmFtZTogU3RyaW5nLFxyXG4gICAgZW1haWw6IFN0cmluZyxcclxuICAgIHBob25lOiBTdHJpbmcsXHJcbiAgfSxcclxuICBtZXNzYWdlczogW21lc3NhZ2VTY2hlbWFdLFxyXG4gIHN0YXR1czoge1xyXG4gICAgdHlwZTogU3RyaW5nLFxyXG4gICAgZW51bTogW1wiYWN0aXZlXCIsIFwiY2xvc2VkXCJdLFxyXG4gICAgZGVmYXVsdDogXCJhY3RpdmVcIixcclxuICB9LFxyXG4gIHJhdGluZzoge1xyXG4gICAgdHlwZTogTnVtYmVyLFxyXG4gICAgbWluOiAxLFxyXG4gICAgbWF4OiA1LFxyXG4gIH0sXHJcbiAgY3JlYXRlQXQ6IHtcclxuICAgIHR5cGU6IERhdGUsXHJcbiAgICBkZWZhdWx0OiBEYXRlLm5vdyxcclxuICB9LFxyXG4gIHVwZGF0ZUF0OiB7XHJcbiAgICB0eXBlOiBEYXRlLFxyXG4gICAgZGVmYXVsdDogRGF0ZS5ub3csXHJcbiAgfSxcclxufSk7XHJcblxyXG5jaGF0U2NoZW1hLnByZShcInNhdmVcIiwgZnVuY3Rpb24gKG5leHQpIHtcclxuICB0aGlzLnVwZGF0ZUF0ID0gRGF0ZS5ub3coKTtcclxuICBuZXh0KCk7XHJcbn0pO1xyXG5cclxuLy8gVOG6oW8gbW9kZWwgdOG7qyBzY2hlbWFcclxuY29uc3QgQ2hhdCA9IG1vbmdvb3NlLm1vZGVsKFwiQ2hhdFwiLCBjaGF0U2NoZW1hKTtcclxuXHJcbmV4cG9ydCBkZWZhdWx0IENoYXQ7XHJcbiJdLCJtYXBwaW5ncyI6InlMQUFBLElBQUFBLFNBQUEsR0FBQUMsc0JBQUEsQ0FBQUMsT0FBQTs7QUFFQTtBQUNBLE1BQU1DLGFBQWEsR0FBRyxJQUFJQyxpQkFBUSxDQUFDQyxNQUFNLENBQUM7RUFDeENDLE1BQU0sRUFBRTtJQUNOQyxJQUFJLEVBQUVDLE1BQU07SUFDWkMsSUFBSSxFQUFFLENBQUMsTUFBTSxFQUFFLEtBQUssQ0FBQztJQUNyQkMsUUFBUSxFQUFFO0VBQ1osQ0FBQztFQUNEQyxPQUFPLEVBQUU7SUFDUEosSUFBSSxFQUFFQyxNQUFNO0lBQ1pFLFFBQVEsRUFBRTtFQUNaLENBQUM7RUFDREUsU0FBUyxFQUFFO0lBQ1RMLElBQUksRUFBRU0sSUFBSTtJQUNWQyxPQUFPLEVBQUVELElBQUksQ0FBQ0U7RUFDaEIsQ0FBQztFQUNEQyxTQUFTLEVBQUU7SUFDVFQsSUFBSSxFQUFFSCxpQkFBUSxDQUFDQyxNQUFNLENBQUNZLEtBQUssQ0FBQ0MsUUFBUTtJQUNwQ0MsR0FBRyxFQUFFO0VBQ1AsQ0FBQztFQUNEWixJQUFJLEVBQUU7SUFDSkEsSUFBSSxFQUFFQyxNQUFNO0lBQ1pDLElBQUksRUFBRSxDQUFDLE1BQU0sRUFBRSxPQUFPLEVBQUUsTUFBTSxDQUFDO0lBQy9CSyxPQUFPLEVBQUU7RUFDWDtBQUNGLENBQUMsQ0FBQzs7QUFFRixNQUFNTSxVQUFVLEdBQUcsSUFBSWhCLGlCQUFRLENBQUNDLE1BQU0sQ0FBQztFQUNyQ2dCLE1BQU0sRUFBRTtJQUNOZCxJQUFJLEVBQUVILGlCQUFRLENBQUNDLE1BQU0sQ0FBQ1ksS0FBSyxDQUFDQyxRQUFRO0lBQ3BDQyxHQUFHLEVBQUUsTUFBTTtJQUNYVCxRQUFRLEVBQUU7RUFDWixDQUFDO0VBQ0RZLFFBQVEsRUFBRTtJQUNSQyxJQUFJLEVBQUVmLE1BQU07SUFDWmdCLEtBQUssRUFBRWhCLE1BQU07SUFDYmlCLEtBQUssRUFBRWpCO0VBQ1QsQ0FBQztFQUNEa0IsUUFBUSxFQUFFLENBQUN2QixhQUFhLENBQUM7RUFDekJ3QixNQUFNLEVBQUU7SUFDTnBCLElBQUksRUFBRUMsTUFBTTtJQUNaQyxJQUFJLEVBQUUsQ0FBQyxRQUFRLEVBQUUsUUFBUSxDQUFDO0lBQzFCSyxPQUFPLEVBQUU7RUFDWCxDQUFDO0VBQ0RjLE1BQU0sRUFBRTtJQUNOckIsSUFBSSxFQUFFc0IsTUFBTTtJQUNaQyxHQUFHLEVBQUUsQ0FBQztJQUNOQyxHQUFHLEVBQUU7RUFDUCxDQUFDO0VBQ0RDLFFBQVEsRUFBRTtJQUNSekIsSUFBSSxFQUFFTSxJQUFJO0lBQ1ZDLE9BQU8sRUFBRUQsSUFBSSxDQUFDRTtFQUNoQixDQUFDO0VBQ0RrQixRQUFRLEVBQUU7SUFDUjFCLElBQUksRUFBRU0sSUFBSTtJQUNWQyxPQUFPLEVBQUVELElBQUksQ0FBQ0U7RUFDaEI7QUFDRixDQUFDLENBQUM7O0FBRUZLLFVBQVUsQ0FBQ2MsR0FBRyxDQUFDLE1BQU0sRUFBRSxVQUFVQyxJQUFJLEVBQUU7RUFDckMsSUFBSSxDQUFDRixRQUFRLEdBQUdwQixJQUFJLENBQUNFLEdBQUcsQ0FBQyxDQUFDO0VBQzFCb0IsSUFBSSxDQUFDLENBQUM7QUFDUixDQUFDLENBQUM7O0FBRUY7QUFDQSxNQUFNQyxJQUFJLEdBQUdoQyxpQkFBUSxDQUFDaUMsS0FBSyxDQUFDLE1BQU0sRUFBRWpCLFVBQVUsQ0FBQyxDQUFDLElBQUFrQixRQUFBLEdBQUFDLE9BQUEsQ0FBQXpCLE9BQUE7O0FBRWpDc0IsSUFBSSIsImlnbm9yZUxpc3QiOltdfQ==