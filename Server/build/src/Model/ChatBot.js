"use strict";Object.defineProperty(exports, "__esModule", { value: true });exports.default = void 0;var _mongoose = _interopRequireDefault(require("mongoose"));function _interopRequireDefault(e) {return e && e.__esModule ? e : { default: e };}

// Định nghĩa schema cho tin nhắn
const messageSchema = new _mongoose.default.Schema({
  sender: {
    type: String,
    enum: ["user", "bot"],
    required: true
  },
  message: {
    type: String,
    required: true
  },
  timestamp: {
    type: Date,
    default: Date.now
  },
  productId: {
    type: _mongoose.default.Schema.Types.ObjectId,
    ref: "Product"
  },
  type: {
    type: String,
    enum: ["text", "image", "file"],
    default: "text"
  }
});

const chatSchema = new _mongoose.default.Schema({
  userId: {
    type: _mongoose.default.Schema.Types.ObjectId,
    ref: "User",
    required: true
  },
  userInfo: {
    name: String,
    email: String,
    phone: String
  },
  messages: [messageSchema],
  status: {
    type: String,
    enum: ["active", "closed"],
    default: "active"
  },
  rating: {
    type: Number,
    min: 1,
    max: 5
  },
  createAt: {
    type: Date,
    default: Date.now
  },
  updateAt: {
    type: Date,
    default: Date.now
  }
});

chatSchema.pre("save", function (next) {
  this.updateAt = Date.now();
  next();
});

// Tạo model từ schema
const Chat = _mongoose.default.model("Chat", chatSchema);var _default = exports.default =

Chat;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfbW9uZ29vc2UiLCJfaW50ZXJvcFJlcXVpcmVEZWZhdWx0IiwicmVxdWlyZSIsImUiLCJfX2VzTW9kdWxlIiwiZGVmYXVsdCIsIm1lc3NhZ2VTY2hlbWEiLCJtb25nb29zZSIsIlNjaGVtYSIsInNlbmRlciIsInR5cGUiLCJTdHJpbmciLCJlbnVtIiwicmVxdWlyZWQiLCJtZXNzYWdlIiwidGltZXN0YW1wIiwiRGF0ZSIsIm5vdyIsInByb2R1Y3RJZCIsIlR5cGVzIiwiT2JqZWN0SWQiLCJyZWYiLCJjaGF0U2NoZW1hIiwidXNlcklkIiwidXNlckluZm8iLCJuYW1lIiwiZW1haWwiLCJwaG9uZSIsIm1lc3NhZ2VzIiwic3RhdHVzIiwicmF0aW5nIiwiTnVtYmVyIiwibWluIiwibWF4IiwiY3JlYXRlQXQiLCJ1cGRhdGVBdCIsInByZSIsIm5leHQiLCJDaGF0IiwibW9kZWwiLCJfZGVmYXVsdCIsImV4cG9ydHMiXSwic291cmNlcyI6WyIuLi8uLi8uLi9zcmMvTW9kZWwvQ2hhdEJvdC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgbW9uZ29vc2UgZnJvbSBcIm1vbmdvb3NlXCI7XHJcblxyXG4vLyDEkOG7i25oIG5naMSpYSBzY2hlbWEgY2hvIHRpbiBuaOG6r25cclxuY29uc3QgbWVzc2FnZVNjaGVtYSA9IG5ldyBtb25nb29zZS5TY2hlbWEoe1xyXG4gIHNlbmRlcjoge1xyXG4gICAgdHlwZTogU3RyaW5nLFxyXG4gICAgZW51bTogW1widXNlclwiLCBcImJvdFwiXSxcclxuICAgIHJlcXVpcmVkOiB0cnVlLFxyXG4gIH0sXHJcbiAgbWVzc2FnZToge1xyXG4gICAgdHlwZTogU3RyaW5nLFxyXG4gICAgcmVxdWlyZWQ6IHRydWUsXHJcbiAgfSxcclxuICB0aW1lc3RhbXA6IHtcclxuICAgIHR5cGU6IERhdGUsXHJcbiAgICBkZWZhdWx0OiBEYXRlLm5vdyxcclxuICB9LFxyXG4gIHByb2R1Y3RJZDoge1xyXG4gICAgdHlwZTogbW9uZ29vc2UuU2NoZW1hLlR5cGVzLk9iamVjdElkLFxyXG4gICAgcmVmOiBcIlByb2R1Y3RcIixcclxuICB9LFxyXG4gIHR5cGU6IHtcclxuICAgIHR5cGU6IFN0cmluZyxcclxuICAgIGVudW06IFtcInRleHRcIiwgXCJpbWFnZVwiLCBcImZpbGVcIl0sXHJcbiAgICBkZWZhdWx0OiBcInRleHRcIixcclxuICB9LFxyXG59KTtcclxuXHJcbmNvbnN0IGNoYXRTY2hlbWEgPSBuZXcgbW9uZ29vc2UuU2NoZW1hKHtcclxuICB1c2VySWQ6IHtcclxuICAgIHR5cGU6IG1vbmdvb3NlLlNjaGVtYS5UeXBlcy5PYmplY3RJZCxcclxuICAgIHJlZjogXCJVc2VyXCIsXHJcbiAgICByZXF1aXJlZDogdHJ1ZSxcclxuICB9LFxyXG4gIHVzZXJJbmZvOiB7XHJcbiAgICBuYW1lOiBTdHJpbmcsXHJcbiAgICBlbWFpbDogU3RyaW5nLFxyXG4gICAgcGhvbmU6IFN0cmluZyxcclxuICB9LFxyXG4gIG1lc3NhZ2VzOiBbbWVzc2FnZVNjaGVtYV0sXHJcbiAgc3RhdHVzOiB7XHJcbiAgICB0eXBlOiBTdHJpbmcsXHJcbiAgICBlbnVtOiBbXCJhY3RpdmVcIiwgXCJjbG9zZWRcIl0sXHJcbiAgICBkZWZhdWx0OiBcImFjdGl2ZVwiLFxyXG4gIH0sXHJcbiAgcmF0aW5nOiB7XHJcbiAgICB0eXBlOiBOdW1iZXIsXHJcbiAgICBtaW46IDEsXHJcbiAgICBtYXg6IDUsXHJcbiAgfSxcclxuICBjcmVhdGVBdDoge1xyXG4gICAgdHlwZTogRGF0ZSxcclxuICAgIGRlZmF1bHQ6IERhdGUubm93LFxyXG4gIH0sXHJcbiAgdXBkYXRlQXQ6IHtcclxuICAgIHR5cGU6IERhdGUsXHJcbiAgICBkZWZhdWx0OiBEYXRlLm5vdyxcclxuICB9LFxyXG59KTtcclxuXHJcbmNoYXRTY2hlbWEucHJlKFwic2F2ZVwiLCBmdW5jdGlvbiAobmV4dCkge1xyXG4gIHRoaXMudXBkYXRlQXQgPSBEYXRlLm5vdygpO1xyXG4gIG5leHQoKTtcclxufSk7XHJcblxyXG4vLyBU4bqhbyBtb2RlbCB04burIHNjaGVtYVxyXG5jb25zdCBDaGF0ID0gbW9uZ29vc2UubW9kZWwoXCJDaGF0XCIsIGNoYXRTY2hlbWEpO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgQ2hhdDtcclxuIl0sIm1hcHBpbmdzIjoib0dBQUEsSUFBQUEsU0FBQSxHQUFBQyxzQkFBQSxDQUFBQyxPQUFBLGNBQWdDLFNBQUFELHVCQUFBRSxDQUFBLFVBQUFBLENBQUEsSUFBQUEsQ0FBQSxDQUFBQyxVQUFBLEdBQUFELENBQUEsS0FBQUUsT0FBQSxFQUFBRixDQUFBOztBQUVoQztBQUNBLE1BQU1HLGFBQWEsR0FBRyxJQUFJQyxpQkFBUSxDQUFDQyxNQUFNLENBQUM7RUFDeENDLE1BQU0sRUFBRTtJQUNOQyxJQUFJLEVBQUVDLE1BQU07SUFDWkMsSUFBSSxFQUFFLENBQUMsTUFBTSxFQUFFLEtBQUssQ0FBQztJQUNyQkMsUUFBUSxFQUFFO0VBQ1osQ0FBQztFQUNEQyxPQUFPLEVBQUU7SUFDUEosSUFBSSxFQUFFQyxNQUFNO0lBQ1pFLFFBQVEsRUFBRTtFQUNaLENBQUM7RUFDREUsU0FBUyxFQUFFO0lBQ1RMLElBQUksRUFBRU0sSUFBSTtJQUNWWCxPQUFPLEVBQUVXLElBQUksQ0FBQ0M7RUFDaEIsQ0FBQztFQUNEQyxTQUFTLEVBQUU7SUFDVFIsSUFBSSxFQUFFSCxpQkFBUSxDQUFDQyxNQUFNLENBQUNXLEtBQUssQ0FBQ0MsUUFBUTtJQUNwQ0MsR0FBRyxFQUFFO0VBQ1AsQ0FBQztFQUNEWCxJQUFJLEVBQUU7SUFDSkEsSUFBSSxFQUFFQyxNQUFNO0lBQ1pDLElBQUksRUFBRSxDQUFDLE1BQU0sRUFBRSxPQUFPLEVBQUUsTUFBTSxDQUFDO0lBQy9CUCxPQUFPLEVBQUU7RUFDWDtBQUNGLENBQUMsQ0FBQzs7QUFFRixNQUFNaUIsVUFBVSxHQUFHLElBQUlmLGlCQUFRLENBQUNDLE1BQU0sQ0FBQztFQUNyQ2UsTUFBTSxFQUFFO0lBQ05iLElBQUksRUFBRUgsaUJBQVEsQ0FBQ0MsTUFBTSxDQUFDVyxLQUFLLENBQUNDLFFBQVE7SUFDcENDLEdBQUcsRUFBRSxNQUFNO0lBQ1hSLFFBQVEsRUFBRTtFQUNaLENBQUM7RUFDRFcsUUFBUSxFQUFFO0lBQ1JDLElBQUksRUFBRWQsTUFBTTtJQUNaZSxLQUFLLEVBQUVmLE1BQU07SUFDYmdCLEtBQUssRUFBRWhCO0VBQ1QsQ0FBQztFQUNEaUIsUUFBUSxFQUFFLENBQUN0QixhQUFhLENBQUM7RUFDekJ1QixNQUFNLEVBQUU7SUFDTm5CLElBQUksRUFBRUMsTUFBTTtJQUNaQyxJQUFJLEVBQUUsQ0FBQyxRQUFRLEVBQUUsUUFBUSxDQUFDO0lBQzFCUCxPQUFPLEVBQUU7RUFDWCxDQUFDO0VBQ0R5QixNQUFNLEVBQUU7SUFDTnBCLElBQUksRUFBRXFCLE1BQU07SUFDWkMsR0FBRyxFQUFFLENBQUM7SUFDTkMsR0FBRyxFQUFFO0VBQ1AsQ0FBQztFQUNEQyxRQUFRLEVBQUU7SUFDUnhCLElBQUksRUFBRU0sSUFBSTtJQUNWWCxPQUFPLEVBQUVXLElBQUksQ0FBQ0M7RUFDaEIsQ0FBQztFQUNEa0IsUUFBUSxFQUFFO0lBQ1J6QixJQUFJLEVBQUVNLElBQUk7SUFDVlgsT0FBTyxFQUFFVyxJQUFJLENBQUNDO0VBQ2hCO0FBQ0YsQ0FBQyxDQUFDOztBQUVGSyxVQUFVLENBQUNjLEdBQUcsQ0FBQyxNQUFNLEVBQUUsVUFBVUMsSUFBSSxFQUFFO0VBQ3JDLElBQUksQ0FBQ0YsUUFBUSxHQUFHbkIsSUFBSSxDQUFDQyxHQUFHLENBQUMsQ0FBQztFQUMxQm9CLElBQUksQ0FBQyxDQUFDO0FBQ1IsQ0FBQyxDQUFDOztBQUVGO0FBQ0EsTUFBTUMsSUFBSSxHQUFHL0IsaUJBQVEsQ0FBQ2dDLEtBQUssQ0FBQyxNQUFNLEVBQUVqQixVQUFVLENBQUMsQ0FBQyxJQUFBa0IsUUFBQSxHQUFBQyxPQUFBLENBQUFwQyxPQUFBOztBQUVqQ2lDLElBQUkiLCJpZ25vcmVMaXN0IjpbXX0=