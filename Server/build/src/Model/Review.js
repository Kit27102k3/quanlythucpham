"use strict";var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(exports, "__esModule", { value: true });exports.default = void 0;var _mongoose = _interopRequireDefault(require("mongoose"));

// Schema cho phản hồi đánh giá
const ReplySchema = new _mongoose.default.Schema({
  userId: {
    type: _mongoose.default.Schema.Types.ObjectId,
    ref: "User",
    required: true
  },
  adminId: {
    type: _mongoose.default.Schema.Types.ObjectId,
    ref: "Admin"
  },
  userName: {
    type: String,
    required: true
  },
  text: {
    type: String,
    required: true,
    trim: true
  },
  isAdmin: {
    type: Boolean,
    default: false
  }
}, { timestamps: true });

const ReviewSchema = new _mongoose.default.Schema(
  {
    userId: {
      type: _mongoose.default.Schema.Types.ObjectId,
      ref: "User",
      required: true
    },
    productId: {
      type: _mongoose.default.Schema.Types.ObjectId,
      ref: "Product",
      required: true
    },
    rating: {
      type: Number,
      required: true,
      min: 1,
      max: 5,
      default: 5
    },
    comment: {
      type: String,
      required: true,
      trim: true
    },
    userName: {
      type: String,
      required: true
    },
    userImage: {
      type: String,
      default: ""
    },
    isVerified: {
      type: Boolean,
      default: false
    }, // Người dùng đã mua sản phẩm chưa
    isPublished: {
      type: Boolean,
      default: true
    }, // Admin có thể ẩn đánh giá không phù hợp
    replies: [ReplySchema] // Mảng các phản hồi cho đánh giá này
  },
  { timestamps: true }
);

// Static method để tính điểm đánh giá trung bình cho một sản phẩm
ReviewSchema.statics.calculateAverageRating = async function (productId) {
  const result = await this.aggregate([
  {
    $match: {
      productId: new _mongoose.default.Types.ObjectId(productId),
      isPublished: true
    }
  },
  {
    $group: {
      _id: "$productId",
      averageRating: { $avg: "$rating" },
      numOfReviews: { $sum: 1 }
    }
  }]
  );

  try {
    if (result.length > 0) {
      await _mongoose.default.model("Product").findByIdAndUpdate(productId, {
        averageRating: result[0].averageRating,
        numOfReviews: result[0].numOfReviews
      });
    } else {
      await _mongoose.default.model("Product").findByIdAndUpdate(productId, {
        averageRating: 0,
        numOfReviews: 0
      });
    }

    // Cập nhật thống kê chi tiết trong ReviewStats
    // Sử dụng setTimeout để đảm bảo mô hình ReviewStats đã được đăng ký
    setTimeout(async () => {
      try {
        const ReviewStats = _mongoose.default.model("ReviewStats");
        await ReviewStats.recalculateStats(productId);
      } catch (err) {
        console.error("Không thể cập nhật ReviewStats:", err.message);
      }
    }, 0);
  } catch (error) {
    console.error("Lỗi khi cập nhật đánh giá trung bình:", error);
  }
};

// Middleware để tự động tính lại điểm đánh giá sau khi lưu review
ReviewSchema.post("save", function () {
  this.constructor.calculateAverageRating(this.productId);
});

// Middleware để tự động tính lại điểm đánh giá sau khi xóa review
ReviewSchema.post("remove", function () {
  this.constructor.calculateAverageRating(this.productId);
});

// Middleware để tự động tính lại điểm đánh giá sau khi cập nhật review
ReviewSchema.post("findOneAndUpdate", async function (doc) {
  if (doc) {
    await _mongoose.default.model("Review").calculateAverageRating(doc.productId);
  }
});

// Middleware để tự động tính lại điểm đánh giá sau khi thay đổi trạng thái public/private
ReviewSchema.pre("updateOne", async function () {
  const docToUpdate = await this.model.findOne(this.getQuery());
  if (docToUpdate) {
    // Lưu lại productId để sử dụng sau khi cập nhật
    this._productId = docToUpdate.productId;
  }
});

ReviewSchema.post("updateOne", async function () {
  if (this._productId) {
    await _mongoose.default.model("Review").calculateAverageRating(this._productId);
  }
});

const Review = _mongoose.default.model("Review", ReviewSchema);var _default = exports.default =

Review;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfbW9uZ29vc2UiLCJfaW50ZXJvcFJlcXVpcmVEZWZhdWx0IiwicmVxdWlyZSIsIlJlcGx5U2NoZW1hIiwibW9uZ29vc2UiLCJTY2hlbWEiLCJ1c2VySWQiLCJ0eXBlIiwiVHlwZXMiLCJPYmplY3RJZCIsInJlZiIsInJlcXVpcmVkIiwiYWRtaW5JZCIsInVzZXJOYW1lIiwiU3RyaW5nIiwidGV4dCIsInRyaW0iLCJpc0FkbWluIiwiQm9vbGVhbiIsImRlZmF1bHQiLCJ0aW1lc3RhbXBzIiwiUmV2aWV3U2NoZW1hIiwicHJvZHVjdElkIiwicmF0aW5nIiwiTnVtYmVyIiwibWluIiwibWF4IiwiY29tbWVudCIsInVzZXJJbWFnZSIsImlzVmVyaWZpZWQiLCJpc1B1Ymxpc2hlZCIsInJlcGxpZXMiLCJzdGF0aWNzIiwiY2FsY3VsYXRlQXZlcmFnZVJhdGluZyIsInJlc3VsdCIsImFnZ3JlZ2F0ZSIsIiRtYXRjaCIsIiRncm91cCIsIl9pZCIsImF2ZXJhZ2VSYXRpbmciLCIkYXZnIiwibnVtT2ZSZXZpZXdzIiwiJHN1bSIsImxlbmd0aCIsIm1vZGVsIiwiZmluZEJ5SWRBbmRVcGRhdGUiLCJzZXRUaW1lb3V0IiwiUmV2aWV3U3RhdHMiLCJyZWNhbGN1bGF0ZVN0YXRzIiwiZXJyIiwiY29uc29sZSIsImVycm9yIiwibWVzc2FnZSIsInBvc3QiLCJjb25zdHJ1Y3RvciIsImRvYyIsInByZSIsImRvY1RvVXBkYXRlIiwiZmluZE9uZSIsImdldFF1ZXJ5IiwiX3Byb2R1Y3RJZCIsIlJldmlldyIsIl9kZWZhdWx0IiwiZXhwb3J0cyJdLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NyYy9Nb2RlbC9SZXZpZXcuanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IG1vbmdvb3NlIGZyb20gXCJtb25nb29zZVwiO1xyXG5cclxuLy8gU2NoZW1hIGNobyBwaOG6o24gaOG7k2kgxJHDoW5oIGdpw6FcclxuY29uc3QgUmVwbHlTY2hlbWEgPSBuZXcgbW9uZ29vc2UuU2NoZW1hKHtcclxuICB1c2VySWQ6IHsgXHJcbiAgICB0eXBlOiBtb25nb29zZS5TY2hlbWEuVHlwZXMuT2JqZWN0SWQsIFxyXG4gICAgcmVmOiBcIlVzZXJcIixcclxuICAgIHJlcXVpcmVkOiB0cnVlXHJcbiAgfSxcclxuICBhZG1pbklkOiB7IFxyXG4gICAgdHlwZTogbW9uZ29vc2UuU2NoZW1hLlR5cGVzLk9iamVjdElkLCBcclxuICAgIHJlZjogXCJBZG1pblwiXHJcbiAgfSxcclxuICB1c2VyTmFtZTogeyBcclxuICAgIHR5cGU6IFN0cmluZywgXHJcbiAgICByZXF1aXJlZDogdHJ1ZSBcclxuICB9LFxyXG4gIHRleHQ6IHsgXHJcbiAgICB0eXBlOiBTdHJpbmcsIFxyXG4gICAgcmVxdWlyZWQ6IHRydWUsXHJcbiAgICB0cmltOiB0cnVlIFxyXG4gIH0sXHJcbiAgaXNBZG1pbjoge1xyXG4gICAgdHlwZTogQm9vbGVhbixcclxuICAgIGRlZmF1bHQ6IGZhbHNlXHJcbiAgfVxyXG59LCB7IHRpbWVzdGFtcHM6IHRydWUgfSk7XHJcblxyXG5jb25zdCBSZXZpZXdTY2hlbWEgPSBuZXcgbW9uZ29vc2UuU2NoZW1hKFxyXG4gIHtcclxuICAgIHVzZXJJZDogeyBcclxuICAgICAgdHlwZTogbW9uZ29vc2UuU2NoZW1hLlR5cGVzLk9iamVjdElkLCBcclxuICAgICAgcmVmOiBcIlVzZXJcIiwgXHJcbiAgICAgIHJlcXVpcmVkOiB0cnVlIFxyXG4gICAgfSxcclxuICAgIHByb2R1Y3RJZDogeyBcclxuICAgICAgdHlwZTogbW9uZ29vc2UuU2NoZW1hLlR5cGVzLk9iamVjdElkLCBcclxuICAgICAgcmVmOiBcIlByb2R1Y3RcIiwgXHJcbiAgICAgIHJlcXVpcmVkOiB0cnVlIFxyXG4gICAgfSxcclxuICAgIHJhdGluZzogeyBcclxuICAgICAgdHlwZTogTnVtYmVyLCBcclxuICAgICAgcmVxdWlyZWQ6IHRydWUsIFxyXG4gICAgICBtaW46IDEsIFxyXG4gICAgICBtYXg6IDUsXHJcbiAgICAgIGRlZmF1bHQ6IDVcclxuICAgIH0sXHJcbiAgICBjb21tZW50OiB7IFxyXG4gICAgICB0eXBlOiBTdHJpbmcsIFxyXG4gICAgICByZXF1aXJlZDogdHJ1ZSxcclxuICAgICAgdHJpbTogdHJ1ZSBcclxuICAgIH0sXHJcbiAgICB1c2VyTmFtZTogeyBcclxuICAgICAgdHlwZTogU3RyaW5nLCBcclxuICAgICAgcmVxdWlyZWQ6IHRydWUgXHJcbiAgICB9LFxyXG4gICAgdXNlckltYWdlOiB7IFxyXG4gICAgICB0eXBlOiBTdHJpbmcsIFxyXG4gICAgICBkZWZhdWx0OiBcIlwiIFxyXG4gICAgfSxcclxuICAgIGlzVmVyaWZpZWQ6IHsgXHJcbiAgICAgIHR5cGU6IEJvb2xlYW4sIFxyXG4gICAgICBkZWZhdWx0OiBmYWxzZSBcclxuICAgIH0sIC8vIE5nxrDhu51pIGTDuW5nIMSRw6MgbXVhIHPhuqNuIHBo4bqpbSBjaMawYVxyXG4gICAgaXNQdWJsaXNoZWQ6IHsgXHJcbiAgICAgIHR5cGU6IEJvb2xlYW4sIFxyXG4gICAgICBkZWZhdWx0OiB0cnVlIFxyXG4gICAgfSwgLy8gQWRtaW4gY8OzIHRo4buDIOG6qW4gxJHDoW5oIGdpw6Ega2jDtG5nIHBow7kgaOG7o3BcclxuICAgIHJlcGxpZXM6IFtSZXBseVNjaGVtYV0sIC8vIE3huqNuZyBjw6FjIHBo4bqjbiBo4buTaSBjaG8gxJHDoW5oIGdpw6EgbsOgeVxyXG4gIH0sXHJcbiAgeyB0aW1lc3RhbXBzOiB0cnVlIH1cclxuKTtcclxuXHJcbi8vIFN0YXRpYyBtZXRob2QgxJHhu4MgdMOtbmggxJFp4buDbSDEkcOhbmggZ2nDoSB0cnVuZyBiw6xuaCBjaG8gbeG7mXQgc+G6o24gcGjhuqltXHJcblJldmlld1NjaGVtYS5zdGF0aWNzLmNhbGN1bGF0ZUF2ZXJhZ2VSYXRpbmcgPSBhc3luYyBmdW5jdGlvbiAocHJvZHVjdElkKSB7XHJcbiAgY29uc3QgcmVzdWx0ID0gYXdhaXQgdGhpcy5hZ2dyZWdhdGUoW1xyXG4gICAge1xyXG4gICAgICAkbWF0Y2g6IHsgXHJcbiAgICAgICAgcHJvZHVjdElkOiBuZXcgbW9uZ29vc2UuVHlwZXMuT2JqZWN0SWQocHJvZHVjdElkKSxcclxuICAgICAgICBpc1B1Ymxpc2hlZDogdHJ1ZVxyXG4gICAgICB9XHJcbiAgICB9LFxyXG4gICAge1xyXG4gICAgICAkZ3JvdXA6IHtcclxuICAgICAgICBfaWQ6IFwiJHByb2R1Y3RJZFwiLFxyXG4gICAgICAgIGF2ZXJhZ2VSYXRpbmc6IHsgJGF2ZzogXCIkcmF0aW5nXCIgfSxcclxuICAgICAgICBudW1PZlJldmlld3M6IHsgJHN1bTogMSB9XHJcbiAgICAgIH1cclxuICAgIH1cclxuICBdKTtcclxuXHJcbiAgdHJ5IHtcclxuICAgIGlmIChyZXN1bHQubGVuZ3RoID4gMCkge1xyXG4gICAgICBhd2FpdCBtb25nb29zZS5tb2RlbChcIlByb2R1Y3RcIikuZmluZEJ5SWRBbmRVcGRhdGUocHJvZHVjdElkLCB7XHJcbiAgICAgICAgYXZlcmFnZVJhdGluZzogcmVzdWx0WzBdLmF2ZXJhZ2VSYXRpbmcsXHJcbiAgICAgICAgbnVtT2ZSZXZpZXdzOiByZXN1bHRbMF0ubnVtT2ZSZXZpZXdzXHJcbiAgICAgIH0pO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgYXdhaXQgbW9uZ29vc2UubW9kZWwoXCJQcm9kdWN0XCIpLmZpbmRCeUlkQW5kVXBkYXRlKHByb2R1Y3RJZCwge1xyXG4gICAgICAgIGF2ZXJhZ2VSYXRpbmc6IDAsXHJcbiAgICAgICAgbnVtT2ZSZXZpZXdzOiAwXHJcbiAgICAgIH0pO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICAvLyBD4bqtcCBuaOG6rXQgdGjhu5FuZyBrw6ogY2hpIHRp4bq/dCB0cm9uZyBSZXZpZXdTdGF0c1xyXG4gICAgLy8gU+G7rSBk4bulbmcgc2V0VGltZW91dCDEkeG7gyDEkeG6o20gYuG6o28gbcO0IGjDrG5oIFJldmlld1N0YXRzIMSRw6MgxJHGsOG7o2MgxJHEg25nIGvDvVxyXG4gICAgc2V0VGltZW91dChhc3luYyAoKSA9PiB7XHJcbiAgICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgUmV2aWV3U3RhdHMgPSBtb25nb29zZS5tb2RlbChcIlJldmlld1N0YXRzXCIpO1xyXG4gICAgICAgIGF3YWl0IFJldmlld1N0YXRzLnJlY2FsY3VsYXRlU3RhdHMocHJvZHVjdElkKTtcclxuICAgICAgfSBjYXRjaCAoZXJyKSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcihcIktow7RuZyB0aOG7gyBj4bqtcCBuaOG6rXQgUmV2aWV3U3RhdHM6XCIsIGVyci5tZXNzYWdlKTtcclxuICAgICAgfVxyXG4gICAgfSwgMCk7XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoXCJM4buXaSBraGkgY+G6rXAgbmjhuq10IMSRw6FuaCBnacOhIHRydW5nIGLDrG5oOlwiLCBlcnJvcik7XHJcbiAgfVxyXG59O1xyXG5cclxuLy8gTWlkZGxld2FyZSDEkeG7gyB04buxIMSR4buZbmcgdMOtbmggbOG6oWkgxJFp4buDbSDEkcOhbmggZ2nDoSBzYXUga2hpIGzGsHUgcmV2aWV3XHJcblJldmlld1NjaGVtYS5wb3N0KFwic2F2ZVwiLCBmdW5jdGlvbigpIHtcclxuICB0aGlzLmNvbnN0cnVjdG9yLmNhbGN1bGF0ZUF2ZXJhZ2VSYXRpbmcodGhpcy5wcm9kdWN0SWQpO1xyXG59KTtcclxuXHJcbi8vIE1pZGRsZXdhcmUgxJHhu4MgdOG7sSDEkeG7mW5nIHTDrW5oIGzhuqFpIMSRaeG7g20gxJHDoW5oIGdpw6Egc2F1IGtoaSB4w7NhIHJldmlld1xyXG5SZXZpZXdTY2hlbWEucG9zdChcInJlbW92ZVwiLCBmdW5jdGlvbigpIHtcclxuICB0aGlzLmNvbnN0cnVjdG9yLmNhbGN1bGF0ZUF2ZXJhZ2VSYXRpbmcodGhpcy5wcm9kdWN0SWQpO1xyXG59KTtcclxuXHJcbi8vIE1pZGRsZXdhcmUgxJHhu4MgdOG7sSDEkeG7mW5nIHTDrW5oIGzhuqFpIMSRaeG7g20gxJHDoW5oIGdpw6Egc2F1IGtoaSBj4bqtcCBuaOG6rXQgcmV2aWV3XHJcblJldmlld1NjaGVtYS5wb3N0KFwiZmluZE9uZUFuZFVwZGF0ZVwiLCBhc3luYyBmdW5jdGlvbihkb2MpIHtcclxuICBpZiAoZG9jKSB7XHJcbiAgICBhd2FpdCBtb25nb29zZS5tb2RlbChcIlJldmlld1wiKS5jYWxjdWxhdGVBdmVyYWdlUmF0aW5nKGRvYy5wcm9kdWN0SWQpO1xyXG4gIH1cclxufSk7XHJcblxyXG4vLyBNaWRkbGV3YXJlIMSR4buDIHThu7EgxJHhu5luZyB0w61uaCBs4bqhaSDEkWnhu4NtIMSRw6FuaCBnacOhIHNhdSBraGkgdGhheSDEkeG7lWkgdHLhuqFuZyB0aMOhaSBwdWJsaWMvcHJpdmF0ZVxyXG5SZXZpZXdTY2hlbWEucHJlKFwidXBkYXRlT25lXCIsIGFzeW5jIGZ1bmN0aW9uKCkge1xyXG4gIGNvbnN0IGRvY1RvVXBkYXRlID0gYXdhaXQgdGhpcy5tb2RlbC5maW5kT25lKHRoaXMuZ2V0UXVlcnkoKSk7XHJcbiAgaWYgKGRvY1RvVXBkYXRlKSB7XHJcbiAgICAvLyBMxrB1IGzhuqFpIHByb2R1Y3RJZCDEkeG7gyBz4butIGThu6VuZyBzYXUga2hpIGPhuq1wIG5o4bqtdFxyXG4gICAgdGhpcy5fcHJvZHVjdElkID0gZG9jVG9VcGRhdGUucHJvZHVjdElkO1xyXG4gIH1cclxufSk7XHJcblxyXG5SZXZpZXdTY2hlbWEucG9zdChcInVwZGF0ZU9uZVwiLCBhc3luYyBmdW5jdGlvbigpIHtcclxuICBpZiAodGhpcy5fcHJvZHVjdElkKSB7XHJcbiAgICBhd2FpdCBtb25nb29zZS5tb2RlbChcIlJldmlld1wiKS5jYWxjdWxhdGVBdmVyYWdlUmF0aW5nKHRoaXMuX3Byb2R1Y3RJZCk7XHJcbiAgfVxyXG59KTtcclxuXHJcbmNvbnN0IFJldmlldyA9IG1vbmdvb3NlLm1vZGVsKFwiUmV2aWV3XCIsIFJldmlld1NjaGVtYSk7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBSZXZpZXc7ICJdLCJtYXBwaW5ncyI6InlMQUFBLElBQUFBLFNBQUEsR0FBQUMsc0JBQUEsQ0FBQUMsT0FBQTs7QUFFQTtBQUNBLE1BQU1D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