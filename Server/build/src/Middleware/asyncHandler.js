"use strict";Object.defineProperty(exports, "__esModule", { value: true });exports.asyncHandler = void 0; /**
 * Middleware để xử lý lỗi không đồng bộ
 * Giúp giảm thiểu việc sử dụng try/catch trong các controller
 * @param {Function} fn - Hàm controller cần wrap
 * @returns {Function} Middleware function
 */
const asyncHandler = (fn) => (req, res, next) => {
  Promise.resolve(fn(req, res, next)).catch((error) => {
    console.error(`[AsyncHandler Error]: ${error.message}`);
    return res.status(error.statusCode || 500).json({
      success: false,
      message: error.message || 'Lỗi máy chủ nội bộ',
      stack: process.env.NODE_ENV === 'production' ? null : error.stack
    });
  });
};exports.asyncHandler = asyncHandler;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJhc3luY0hhbmRsZXIiLCJmbiIsInJlcSIsInJlcyIsIm5leHQiLCJQcm9taXNlIiwicmVzb2x2ZSIsImNhdGNoIiwiZXJyb3IiLCJjb25zb2xlIiwibWVzc2FnZSIsInN0YXR1cyIsInN0YXR1c0NvZGUiLCJqc29uIiwic3VjY2VzcyIsInN0YWNrIiwicHJvY2VzcyIsImVudiIsIk5PREVfRU5WIiwiZXhwb3J0cyJdLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NyYy9NaWRkbGV3YXJlL2FzeW5jSGFuZGxlci5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcclxuICogTWlkZGxld2FyZSDEkeG7gyB44butIGzDvSBs4buXaSBraMO0bmcgxJHhu5NuZyBi4buZXHJcbiAqIEdpw7pwIGdp4bqjbSB0aGnhu4N1IHZp4buHYyBz4butIGThu6VuZyB0cnkvY2F0Y2ggdHJvbmcgY8OhYyBjb250cm9sbGVyXHJcbiAqIEBwYXJhbSB7RnVuY3Rpb259IGZuIC0gSMOgbSBjb250cm9sbGVyIGPhuqduIHdyYXBcclxuICogQHJldHVybnMge0Z1bmN0aW9ufSBNaWRkbGV3YXJlIGZ1bmN0aW9uXHJcbiAqL1xyXG5leHBvcnQgY29uc3QgYXN5bmNIYW5kbGVyID0gKGZuKSA9PiAocmVxLCByZXMsIG5leHQpID0+IHtcclxuICBQcm9taXNlLnJlc29sdmUoZm4ocmVxLCByZXMsIG5leHQpKS5jYXRjaCgoZXJyb3IpID0+IHtcclxuICAgIGNvbnNvbGUuZXJyb3IoYFtBc3luY0hhbmRsZXIgRXJyb3JdOiAke2Vycm9yLm1lc3NhZ2V9YCk7XHJcbiAgICByZXR1cm4gcmVzLnN0YXR1cyhlcnJvci5zdGF0dXNDb2RlIHx8IDUwMCkuanNvbih7XHJcbiAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxyXG4gICAgICBtZXNzYWdlOiBlcnJvci5tZXNzYWdlIHx8ICdM4buXaSBtw6F5IGNo4bunIG7hu5lpIGLhu5knLFxyXG4gICAgICBzdGFjazogcHJvY2Vzcy5lbnYuTk9ERV9FTlYgPT09ICdwcm9kdWN0aW9uJyA/IG51bGwgOiBlcnJvci5zdGFjayxcclxuICAgIH0pO1xyXG4gIH0pO1xyXG59OyAiXSwibWFwcGluZ3MiOiIwR0FBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDTyxNQUFNQSxZQUFZLEdBQUdBLENBQUNDLEVBQUUsS0FBSyxDQUFDQyxHQUFHLEVBQUVDLEdBQUcsRUFBRUMsSUFBSSxLQUFLO0VBQ3REQyxPQUFPLENBQUNDLE9BQU8sQ0FBQ0wsRUFBRSxDQUFDQyxHQUFHLEVBQUVDLEdBQUcsRUFBRUMsSUFBSSxDQUFDLENBQUMsQ0FBQ0csS0FBSyxDQUFDLENBQUNDLEtBQUssS0FBSztJQUNuREMsT0FBTyxDQUFDRCxLQUFLLENBQUMseUJBQXlCQSxLQUFLLENBQUNFLE9BQU8sRUFBRSxDQUFDO0lBQ3ZELE9BQU9QLEdBQUcsQ0FBQ1EsTUFBTSxDQUFDSCxLQUFLLENBQUNJLFVBQVUsSUFBSSxHQUFHLENBQUMsQ0FBQ0MsSUFBSSxDQUFDO01BQzlDQyxPQUFPLEVBQUUsS0FBSztNQUNkSixPQUFPLEVBQUVGLEtBQUssQ0FBQ0UsT0FBTyxJQUFJLG9CQUFvQjtNQUM5Q0ssS0FBSyxFQUFFQyxPQUFPLENBQUNDLEdBQUcsQ0FBQ0MsUUFBUSxLQUFLLFlBQVksR0FBRyxJQUFJLEdBQUdWLEtBQUssQ0FBQ087SUFDOUQsQ0FBQyxDQUFDO0VBQ0osQ0FBQyxDQUFDO0FBQ0osQ0FBQyxDQUFDSSxPQUFBLENBQUFuQixZQUFBLEdBQUFBLFlBQUEiLCJpZ25vcmVMaXN0IjpbXX0=